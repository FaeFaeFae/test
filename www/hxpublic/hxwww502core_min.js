var HXWebJS;if(!HXWebJS){HXWebJS={}}HXWebJS.Core={};HXWebJS.Core.StringBuilder=function(){this._strings_=new Array()};HXWebJS.Core.StringBuilder.prototype.append=function(str){this._strings_.push(str)};HXWebJS.Core.StringBuilder.prototype.toString=function(){return this._strings_.join("")};HXWebJS.Core.StringBuilder.prototype.clear=function(){this._strings_=new Array()};HXWebJS.Core.StringBuilder.prototype.isEmpty=function(){return this._strings_.length==0};var HXWebStringBuilder=HXWebJS.Core.StringBuilder;HXWebJS.Core.Timer=function(){this._interval=500;this._enabled=false;this._uniqueID=null;this._timer=null;this._tickhandler=null};HXWebJS.Core.Timer.prototype={get_uniqueID:function(){return this._uniqueID},set_uniqueID:function(a){this._uniqueID=a},get_enabled:function(){return this._enabled},set_enabled:function(blnNewEnabledStatus){var blnOldEnabledStatus=this._enabled;if(blnOldEnabledStatus!=blnNewEnabledStatus){if(blnOldEnabledStatus==true){this._stopTimer()}this._enabled=blnNewEnabledStatus;if(blnNewEnabledStatus==true){this._startTimer()}}},get_interval:function(){return this._interval},set_interval:function(intInterval){if(this._interval!=intInterval){this._interval=intInterval;if(this._enabled){this._stopTimer();this._startTimer()}}},set_tickhandler:function(f){this._tickhandler=f},_startTimer:function(){this._timer=window.setTimeout(HXWebJS.Core.CreateDelegateFunction(this,this._raisetick),this.get_interval())},_stopTimer:function(){if(this._timer!==null){window.clearTimeout(this._timer);this._timer=null}},_raisetick:function(){this._tickhandler();this._startTimer()}};HXWebJS.Core.Browser={};HXWebJS.Core.Browser._userAgent=navigator.userAgent.toLowerCase();HXWebJS.Core.Browser.IsChrome=/\bchrome\b/.test(HXWebJS.Core.Browser._userAgent);HXWebJS.Core.Browser.IsSafari=/safari/.test(HXWebJS.Core.Browser._userAgent);HXWebJS.Core.Browser.IsOpera=/opera/.test(HXWebJS.Core.Browser._userAgent);HXWebJS.Core.Browser.IsIE=/msie/.test(HXWebJS.Core.Browser._userAgent)&&!/opera/.test(HXWebJS.Core.Browser._userAgent);HXWebJS.Core.Browser.IsMozilla=/mozilla/.test(HXWebJS.Core.Browser._userAgent)&&!/(compatible|webkit)/.test(HXWebJS.Core.Browser._userAgent);HXWebJS.Core.Browser.Version=(HXWebJS.Core.Browser._userAgent.match(/.+(?:rv|it|ra|ie|on|chrome)[\/: ]([\d.]+)/)||[0,"0"])[1];HXWebJS.Core.Browser.IsIE11=!HXWebJS.Core.Browser.IsChrome&&!HXWebJS.Core.Browser.IsSafari&&!HXWebJS.Core.Browser.IsOpera&&/trident/.test(HXWebJS.Core.Browser._userAgent)&&parseFloat(HXWebJS.Core.Browser.Version)>=11;HXWebJS.Core.Browser.IsMobile=/mobile/.test(HXWebJS.Core.Browser._userAgent);HXWebJS.Core.Browser.IsMicroMessenger=/micromessenger/.test(HXWebJS.Core.Browser._userAgent);HXWebJS.Core.WebPageGlobalVariables={};HXWebJS.Core.WebPageGlobalVariables._InternalFunctions={};HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetCurrentPageName=function(){if(typeof(mstrCurrentWebPageName)=="string"){return mstrCurrentWebPageName}else{var i=location.pathname.lastIndexOf("/");return location.pathname.substr(i+1)}};HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetWebRootPath=function(){if(typeof(gstrWebRootPath)!="string"){alert("HXWebJS.Core.WebPageGlobalVariables运行错误： WebRootPath参数值未被登记！请确保页面服务器端Page_Load()事件函数中 hxwww.Utility.RegisterWebPageGlobalJavaScriptVariables()函数被调用。");return null}return gstrWebRootPath};HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetCurrentCultureName=function(){if(typeof(mstrCurrentWebLanguageCulture)!="string"){alert("HXWebJS.Core.WebPageGlobalVariables运行错误： CurrentWebLanguageCulture参数值未被登记！请确保页面服务器端Page_Load()事件函数中 hxwww.Utility.RegisterWebPageGlobalJavaScriptVariables()函数被调用。");return null}return mstrCurrentWebLanguageCulture};HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetHXPageParamUUID=function(){if(typeof(mstrHXPageParamUUID)!="string"){alert("HXWebJS.Core.WebPageGlobalVariables运行错误： HXPageParamUUID参数值未被登记！请确保页面服务器端Page_Load()事件函数中 hxwww.Utility.RegisterWebPageGlobalJavaScriptVariables()函数被调用。");return null}return mstrHXPageParamUUID};HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetPageXmlSvcAssemblyName=function(){if(typeof(mstrPageXmlServiceAssemblyName)!="string"){alert("HXWebJS.Core.WebPageGlobalVariables运行错误： PageXmlServiceAssemblyName参数值未被登记！请确保页面服务器端Page_Load()事件函数中 hxwww.Utility.RegisterWebPageGlobalJavaScriptVariables()函数被调用。");return null}return mstrPageXmlServiceAssemblyName};HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetPageXmlSvcClassName=function(){if(typeof(mstrPageXmlServiceClassName)!="string"){alert("HXWebJS.Core.WebPageGlobalVariables运行错误： PageXmlServiceClassName参数值未被登记！请确保页面服务器端Page_Load()事件函数中 hxwww.Utility.RegisterWebPageGlobalJavaScriptVariables()函数被调用。");return null}return mstrPageXmlServiceClassName};HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetDateDisplayFormatString=function(){if(typeof(mstrCurrentDateDisplayFormatString)!="string"){return"YYYY-MM-DD"}if(mstrCurrentDateDisplayFormatString==null||mstrCurrentDateDisplayFormatString==""){return"YYYY-MM-DD"}if(mstrCurrentDateDisplayFormatString.length!=10){return"YYYY-MM-DD"}return mstrCurrentDateDisplayFormatString};HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetCurrencyDisplayFormatSetting=function(){if(typeof(mstrCurrentCurrencyDisplayFormatSetting)!="string"){return"0;2"}if(mstrCurrentCurrencyDisplayFormatSetting==null||mstrCurrentCurrencyDisplayFormatSetting==""){return"0;2"}if(mstrCurrentCurrencyDisplayFormatSetting.length!=3){return"0;2"}return mstrCurrentCurrencyDisplayFormatSetting};HXWebJS.Core.WebPageGlobalVariables.CurrentPageName=HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetCurrentPageName();HXWebJS.Core.WebPageGlobalVariables.WebRootPath=HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetWebRootPath();HXWebJS.Core.WebPageGlobalVariables.CurrentCultureName=HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetCurrentCultureName();HXWebJS.Core.WebPageGlobalVariables.DateDisplayFormatString=HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetDateDisplayFormatString();HXWebJS.Core.WebPageGlobalVariables.CurrencyDisplayFormatType=parseInt(HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetCurrencyDisplayFormatSetting().substr(0,1));HXWebJS.Core.WebPageGlobalVariables.CurrencyDisplayFormatScale=parseInt(HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetCurrencyDisplayFormatSetting().substr(2,1));var HXWebPageGlobalVariables=HXWebJS.Core.WebPageGlobalVariables;HXWebJS.Core.CreateDelegateFunction=function(objElement,CallbackFunction){var args=[];for(var i=2;i<arguments.length;i++){args.push(arguments[i])}return function(){return CallbackFunction.apply(objElement,args)}};HXWebJS.Core.AlertWithReplaceCrLfString=function(strMsg){if(strMsg==null){return}alert(strMsg.replace(/\\r/g,"\r").replace(/\\n/g,"\n"))};HXWebJS.Core.GetFrameWindow=function(frame){if(frame==null){return null}if(typeof frame=="string"){frame=document.getElementById(frame)}if(frame==null){return null}if(frame.tagName!="IFRAME"&&frame.tagName!="FRAME"){return null}if(frame.contentWindow){return frame.contentWindow}else{return frame}};HXWebJS.Core.SetFrameWindowHref=function(frame,url,strShowInWhenFrameNotExist){if(strShowInWhenFrameNotExist==null||strShowInWhenFrameNotExist==""){strShowInWhenFrameNotExist="exit"}var objFrameWin=HXWebJS.Core.GetFrameWindow(frame);if(objFrameWin==null){if(strShowInWhenFrameNotExist=="exit"){return}window.open(url,strShowInWhenFrameNotExist);return}objFrameWin.open(url,"_self")};HXWebJS.Core.WindowGeometry={};HXWebJS.Core.WindowGeometry.GetViewportWidth=function(objWin){if(objWin==null){objWin=window}if(window.innerWidth!=null){if(objWin.document.documentElement!=null&&objWin.document.documentElement.clientWidth!=null&&objWin.document.documentElement.clientWidth>0){return objWin.document.documentElement.clientWidth}else{return objWin.innerWidth}}if(document.documentElement!=null&&document.documentElement.clientWidth!=null){var intWidth=objWin.document.documentElement.clientWidth;if(intWidth>0){return objWin.document.documentElement.clientWidth}else{intWidth=objWin.document.body.clientWidth;if(intWidth>0){return objWin.document.body.clientWidth}else{return objWin.document.documentElement.offsetWidth}}}return null};HXWebJS.Core.WindowGeometry.GetViewportHeight=function(objWin){if(objWin==null){objWin=window}if(window.innerHeight!=null){return objWin.innerHeight}if(document.documentElement!=null&&document.documentElement.clientHeight!=null){var intHeight=objWin.document.documentElement.clientHeight;if(intHeight>0){return objWin.document.documentElement.clientHeight}else{intHeight=objWin.document.body.clientHeight;if(intHeight>0){return objWin.document.body.clientHeight}else{return objWin.document.documentElement.offsetHeight}}}return null};HXWebJS.Core.WindowGeometry.GetWindowX=function(objWin){if(objWin==null){objWin=window}if(window.screenLeft!=null){return objWin.screenLeft}if(window.screenX!=null){return objWin.screenX}return null};HXWebJS.Core.WindowGeometry.GetWindowY=function(objWin){if(objWin==null){objWin=window}if(window.screenTop!=null){return objWin.screenTop}if(window.screenY!=null){return objWin.screenY}return null};HXWebJS.Core.WindowGeometry.GetScrollLeft=function(objWin){if(objWin==null){objWin=window}if(document.documentElement!=null&&document.documentElement.scrollLeft!=null){var intScrollLeft=objWin.document.documentElement.scrollLeft;if(intScrollLeft>0){return intScrollLeft}else{if(document.body.scrollLeft!=null){return objWin.document.body.scrollLeft}}}if(window.pageXOffset!=null){return objWin.pageXOffset}return null};HXWebJS.Core.WindowGeometry.GetScrollTop=function(objWin){if(objWin==null){objWin=window}if(document.documentElement!=null&&document.documentElement.scrollTop!=null){var intScrollTop=objWin.document.documentElement.scrollTop;if(intScrollTop>0){return intScrollTop}else{if(document.body.scrollTop!=null){return objWin.document.body.scrollTop}}}if(window.pageYOffset!=null){return objWin.pageYOffset}return null};HXWebJS.Core.WindowGeometry.GetDocumentWidth=function(objWin){if(objWin==null){objWin=window}if(document.body.scrollWidth!=null&&document.body.scrollWidth!=0){return objWin.document.body.scrollWidth}if(document.documentElement!=null&&document.documentElement.scrollWidth!=null){return objWin.document.documentElement.scrollWidth}return null};HXWebJS.Core.WindowGeometry.GetDocumentHeight=function(objWin){if(objWin==null){objWin=window}if(document.body.scrollHeight!=null&&document.body.scrollHeight!=0){if(document.documentElement!=null&&document.documentElement.scrollHeight!=null){return(objWin.document.body.scrollHeight>objWin.document.documentElement.scrollHeight?objWin.document.body.scrollHeight:objWin.document.documentElement.scrollHeight)}else{return objWin.document.body.scrollHeight}}if(document.documentElement!=null&&document.documentElement.scrollHeight!=null){return objWin.document.documentElement.scrollHeight}return null};HXWebJS.Core._InternalFunctions={};HXWebJS.Core._Internal={};HXWebJS.Core._InternalFunctions.IsJavascriptFunctionDefined=function(str_js_func_name){if(str_js_func_name==null){return false}if(str_js_func_name==""){return false}try{if(typeof(eval(str_js_func_name))!="function"){return false}}catch(e){return false}return true};HXWebJS.Core._InternalFunctions.GetFunctionName=function(_callee){var _text=_callee.toString();var _scriptArr=document.scripts;for(var i=0;i<_scriptArr.length;i++){var _start=_scriptArr[i].text.indexOf(_text);if(_start!=-1){if(/^function\s*\(.*\).*\r\n/.test(_text)){var _tempArr=_scriptArr[i].text.substr(0,_start).split("\r\n");return _tempArr[_tempArr.length-1].replace(/(var)|(\s*)/g,"").replace(/=/g,"")}else{return _text.match(/^function\s*([^\(]+).*\r\n/)[1]}}}};HXWebJS.Core._InternalFunctions.ShowHideProgressBar=function(blnShowProgressBar){if(blnShowProgressBar==null){blnShowProgressBar=true}var objWin=window.top;try{window.top.document!=null}catch(e){objWin=window}var strHtmlIdForPogressBarArea="hxwebjs_progessbar_area_with_img_and_text";var objPogressBarArea=objWin.document.getElementById(strHtmlIdForPogressBarArea);if(!blnShowProgressBar){HXWebJS.Core._InternalFunctions.DisableMouseInput(false,null,objWin);if(objPogressBarArea!=null){objPogressBarArea.style.visibility="hidden"}return}HXWebJS.Core._InternalFunctions.DisableMouseInput(true,null,objWin);if(objPogressBarArea==null){var strProgressBarWaitingMsg="";if(HXWebPageGlobalVariables.CurrentCultureName=="zh-CN"){strProgressBarWaitingMsg="处理中，请稍等..."}var sb_html=new HXWebStringBuilder();sb_html.append('<div id="'+strHtmlIdForPogressBarArea+'" style="position:absolute;z-index:200000;height:24px;line-height:24px;">');sb_html.append('<img id="hxwebjs_progessbar_img_for_animation"');sb_html.append(' src="'+HXWebJS.Core.WebPageGlobalVariables.WebRootPath+'images/hxpub_waiting_hint_slow.gif" />');sb_html.append('<span id="hxwebjs_progessbar_area__hint_text" style="margin-left:5px;font-size:14px;height:20px;line-height:20px;">');sb_html.append(strProgressBarWaitingMsg);sb_html.append("</span>");sb_html.append("</div>");var _div=objWin.HXWebJS.DOM.CreateElement(sb_html.toString());objWin.document.body.appendChild(_div);objPogressBarArea=_div}var topWindowWidth=HXWebJS.Core.WindowGeometry.GetViewportWidth(objWin);var topWindowHeight=HXWebJS.Core.WindowGeometry.GetViewportHeight(objWin);var intScrollTop=HXWebJS.Core.WindowGeometry.GetScrollTop(objWin);objPogressBarArea.style.left=(topWindowWidth-320)/2+"px";objPogressBarArea.style.top=((topWindowHeight-16)/2+intScrollTop)+"px";objPogressBarArea.style.visibility="visible"};HXWebJS.Core._InternalFunctions.DisableMouseInput=function(blnDisableMouseInput,blnBrightOrDark,objTopWindow){if(objTopWindow==null){objTopWindow=window.top}HXWebJS.Core._InternalFunctions._ShowDisableMouseInputCoverDIV(blnDisableMouseInput,"disable_mouse_input_div_all_window",objTopWindow)};HXWebJS.Core._InternalFunctions.DisableDialogMouseInput=function(blnDisableMouseInput,objTopWindow){if(objTopWindow==null){objTopWindow=window}HXWebJS.Core._InternalFunctions._ShowDisableMouseInputCoverDIV(blnDisableMouseInput,"disable_mouse_input_div_under_dialog",objTopWindow)};HXWebJS.Core._InternalFunctions._ShowDisableMouseInputCoverDIV=function(blnDisableMouseInput,strCoverDIVType,objTopWindow){if(blnDisableMouseInput==null){blnDisableMouseInput=true}var blnForDialogOrWholeWin=(strCoverDIVType=="disable_mouse_input_div_under_dialog"?true:false);var str_div_name=(blnForDialogOrWholeWin?"hxwebjs_progessbar_cover_div_to_disable_mouse_input_under_dialog":"hxwebjs_progessbar_cover_div_to_disable_mouse_input");var blnBrightOrDark=(blnForDialogOrWholeWin?false:true);if(objTopWindow==null){objTopWindow=window.top}try{objTopWindow.document!=null}catch(e){return}var objDivForDisableMouseInput=objTopWindow.document.getElementById(str_div_name);if(blnDisableMouseInput==false){if(objDivForDisableMouseInput!=null){objDivForDisableMouseInput.style.display="none"}return}var intOpacity=85;if(objDivForDisableMouseInput==null){var _div=objTopWindow.document.createElement("div");_div.id=str_div_name;_div.style.position="absolute";_div.style.zIndex=100000+(blnForDialogOrWholeWin?-1000:1000);_div.style.top="0px";_div.style.left="0px";_div.style.backgroundColor=(blnBrightOrDark?"#ffffff":"black");_div.style.opacity=intOpacity/100;_div.style.filter="Alpha(Opacity="+intOpacity+")";var topWindowWidth=HXWebJS.Core.WindowGeometry.GetViewportWidth(objTopWindow);var topWindowHeight=HXWebJS.Core.WindowGeometry.GetViewportHeight(objTopWindow);var topDocumentWidth=HXWebJS.Core.WindowGeometry.GetDocumentWidth(objTopWindow);var topDocumentHeight=HXWebJS.Core.WindowGeometry.GetDocumentHeight(objTopWindow);_div.style.width=topDocumentWidth+"px";_div.style.height=(topWindowHeight>topDocumentHeight?topWindowHeight:topDocumentHeight)+"px";objTopWindow.document.body.appendChild(_div)}else{objDivForDisableMouseInput.style.backgroundColor=(blnBrightOrDark?"#ffffff":"black");objDivForDisableMouseInput.style.opacity=intOpacity/100;objDivForDisableMouseInput.style.filter="Alpha(Opacity="+intOpacity+")";var topWindowWidth=HXWebJS.Core.WindowGeometry.GetViewportWidth(objTopWindow);var topWindowHeight=HXWebJS.Core.WindowGeometry.GetViewportHeight(objTopWindow);var topDocumentWidth=HXWebJS.Core.WindowGeometry.GetDocumentWidth(objTopWindow);var topDocumentHeight=HXWebJS.Core.WindowGeometry.GetDocumentHeight(objTopWindow);objDivForDisableMouseInput.style.width=topDocumentWidth+"px";objDivForDisableMouseInput.style.height=(topWindowHeight>topDocumentHeight?topWindowHeight:topDocumentHeight)+"px";objDivForDisableMouseInput.style.display=""}};HXWebJS.DOM={};HXWebJS.DOM._InternalFunctions={};HXWebJS.DOM.CreateElement=function(strElementHtmlContent){var objContainerDiv=document.createElement("div");objContainerDiv.innerHTML=strElementHtmlContent;return objContainerDiv.firstChild};HXWebJS.DOM.GetElementTopPosition=function(el){var objTopMostContainerElement=null;var et=0,st=0;while(el){if(el.tagName!="BODY"){st+=el.scrollTop}et+=el.offsetTop;if(el.offsetParent==null){objTopMostContainerElement=el}el=el.offsetParent}if(objTopMostContainerElement!=null){var strPosition="";if(window.getComputedStyle!=null){strPosition=window.getComputedStyle(objTopMostContainerElement).position}else{if(objTopMostContainerElement.currentStyle!=null){strPosition=objTopMostContainerElement.currentStyle.position}}if(strPosition=="fixed"){et+=HXWebJS.Core.WindowGeometry.GetScrollTop(window)}}return et-st};HXWebJS.DOM.GetElementLeftPosition=function(el){var et=0,st=0;while(el){if(el.tagName!="BODY"){st+=el.scrollLeft}et+=el.offsetLeft;el=el.offsetParent}return et-st};HXWebJS.DOM.GetElementOuterHTML=function(el){if(el==null){return""}if(HXWebJS.Core.Browser.IsIE){return el.outerHTML}var objContainerDiv=document.createElement("div");objContainerDiv.appendChild(el.cloneNode(true));return objContainerDiv.innerHTML};HXWebJS.DOM.ElementGetInnerText=function(el){if(el==null){return""}if(typeof(el.innerText)!="undefined"){return el.innerText}return el.textContent};HXWebJS.DOM.ElementSetInnerText=function(el,text){if(el==null){return}if(el.tagName.toLowerCase()=="input"){el.value=text;return}if(typeof(el.innerText)!="undefined"){el.innerText=text}else{if(typeof(el.textContent)!="undefined"){el.textContent=text}else{if(typeof(el.value)!="undefined"){el.value=text}}}};HXWebJS.DOM.ElementAttributeGetValue=function(node,strAttributeName){if(node==null||strAttributeName==null){return null}if(strAttributeName=="id"){return node.id}if(strAttributeName=="for"){return node.htmlFor}if(strAttributeName=="class"||strAttributeName=="className"){return node.className}if(node.tagName==null){return null}var strTagName=node.tagName.toLowerCase();if(strTagName=="option"){return null}if(strTagName=="input"&&node.type=="image"&&strAttributeName=="datasrc"){return null}return node.getAttribute(strAttributeName)};HXWebJS.DOM.ElementAttributeIsDefined=function(node,strAttributeName){var attrValue=HXWebJS.DOM.ElementAttributeGetValue(node,strAttributeName);return(attrValue==null?false:true)};HXWebJS.DOM.ElementAttributeSetValue=function(node,strAttributeName,strAttributeValue){if(node==null||strAttributeName==null){return}if(strAttributeName=="for"){node.htmlFor=strAttributeValue;return}if(strAttributeName=="class"||strAttributeName=="className"){node.className=strAttributeValue;return}node.setAttribute(strAttributeName,strAttributeValue)};HXWebJS.DOM.ElementGetBindingRecordNumber=function(element){if(element.recordNumber!=null){return element.recordNumber}if(element.tagName.toUpperCase()=="TBODY"){var strTemp=element.getAttribute("hx_binding_line_no");if(strTemp!=null&&strTemp!=""){return parseInt(strTemp)+1}}var objTBody=HXWebJS.Xml._XmlDataIsland._GetElementBindingLineTBody(element);if(objTBody==null){return null}var strTemp=objTBody.getAttribute("hx_binding_line_no");return parseInt(strTemp)+1};HXWebJS.DOM.IsElementInContainer=function(objContainerElement,objElement){if(objContainerElement==null||objElement==null){return false}if(objContainerElement.contains!=null){return objContainerElement.contains(objElement)}var objTemp=objElement;while(objTemp!=null){if(objTemp===objContainerElement){return true}objTemp=objTemp.parentNode}return false};HXWebJS.DOM.IsPointInElementArea=function(objElement,iCoordX,iCoordY){var intTop=HXWebJS.DOM.GetElementTopPosition(objElement);var intLeft=HXWebJS.DOM.GetElementLeftPosition(objElement);var intWidth=objElement.offsetWidth;var intHeight=objElement.offsetHeight;if(iCoordX>=intLeft&&iCoordX<=(intLeft+intWidth)&&iCoordY>=intTop&&iCoordY<=(intTop+intHeight)){return true}return false};HXWebJS.DOM.GetElementById=function(strElementId){return document.getElementById(strElementId)};HXWebJS.DOM.FindElementsByTagName=function(strTagName,rootNode){if(!rootNode){rootNode=document}return rootNode.getElementsByTagName(strTagName)};HXWebJS.DOM.FindElementsById=function(strIDValue,rootNode,strTagName){return HXWebJS.DOM.FindElementsByAttribute("id",strIDValue,strTagName,rootNode)};HXWebJS.DOM.FindFirstElementById=function(strIDValue,rootNode,strTagName){var objTempCollection=HXWebJS.DOM.FindElementsByAttribute("id",strIDValue,strTagName,rootNode,false,-1,true);if(objTempCollection==null||objTempCollection.length==0){return null}return objTempCollection[0]};HXWebJS.DOM.FindElementsByAttribute=function(strAttributeName,strAttributeValue,strTagName,rootNodeOrCollection,blnFindInDescendant,intDescendantLevelToFind,blnStopAfterFindOne){if(typeof(jQuery)!="undefined"&&$.expr!=null&&$.expr.createPseudo!=null){return HXWebJS.DOM.FindElementsByAttributeViaJQuery(strAttributeName,strAttributeValue,strTagName,rootNodeOrCollection,blnFindInDescendant,intDescendantLevelToFind)}if(intDescendantLevelToFind==null){intDescendantLevelToFind=-1}if(blnStopAfterFindOne==null){blnStopAfterFindOne=false}if(strAttributeValue!=null){strAttributeValue=strAttributeValue.toString().toLowerCase()}if(strTagName!=null){strTagName=strTagName.toLowerCase()}var allMatchedElements=[];if(rootNodeOrCollection==null){return HXWebJS.DOM.FindElementsByAttribute(strAttributeName,strAttributeValue,strTagName,document.body,true,-1,blnStopAfterFindOne)}else{if(rootNodeOrCollection.length==null){if(rootNodeOrCollection.nodeType!=1){return[]}var children=rootNodeOrCollection.childNodes;if(children==null){return[]}return HXWebJS.DOM.FindElementsByAttribute(strAttributeName,strAttributeValue,strTagName,children,true,intDescendantLevelToFind,blnStopAfterFindOne)}}if(blnFindInDescendant==null){blnFindInDescendant=false}var tmpIsMatched;for(var i=0;i<rootNodeOrCollection.length;i++){if(typeof(rootNodeOrCollection[i])=="undefined"){continue}if(typeof(rootNodeOrCollection[i].nodeType)=="undefined"||rootNodeOrCollection[i].nodeType!=1){continue}tmpIsMatched=HXWebJS.DOM._InternalFunctions._IsElementsAttributeValueMatched(strAttributeName,strAttributeValue,strTagName,rootNodeOrCollection[i]);if(tmpIsMatched){allMatchedElements.push(rootNodeOrCollection[i]);if(blnStopAfterFindOne){return allMatchedElements}}if(blnFindInDescendant&&(intDescendantLevelToFind==-1||intDescendantLevelToFind>0)){var tmpResult=HXWebJS.DOM.FindElementsByAttribute(strAttributeName,strAttributeValue,strTagName,rootNodeOrCollection[i],true,(intDescendantLevelToFind==-1?-1:intDescendantLevelToFind-1),blnStopAfterFindOne);if(tmpResult!=null&&tmpResult.length>0){for(var j=0;j<tmpResult.length;j++){allMatchedElements.push(tmpResult[j])}}}}return allMatchedElements};HXWebJS.DOM.FindElementsByAttributeViaJQuery=function(strAttributeName,strAttributeValue,strTagName,rootNodeOrCollection,blnFindInDescendant,intDescendantLevelToFind){if(rootNodeOrCollection==null){rootNodeOrCollection=document;blnFindInDescendant=true;intDescendantLevelToFind=-1}else{if(rootNodeOrCollection.length==null){if(rootNodeOrCollection.nodeType!=1){return[]}var children=rootNodeOrCollection.childNodes;if(children==null){return[]}blnFindInDescendant=true;if(intDescendantLevelToFind==null){intDescendantLevelToFind=-1}}else{if(blnFindInDescendant==null){blnFindInDescendant=false}if(intDescendantLevelToFind==null){intDescendantLevelToFind=-1}}}if(strTagName!=null){strTagName=strTagName.toLowerCase()}var strQuerySelector=(strTagName!=null?strTagName:"*")+"["+strAttributeName+"]";if($.expr[":"].hxAttributeValueCompare==null){$.expr[":"].hxAttributeValueCompare=$.expr.createPseudo(function(filterParam){var arrTemp=filterParam.split(",");var attrName=arrTemp[0];var attrValue=arrTemp[1];return function(element,context,isXml){var v=element.getAttribute(attrName);if(v==null){return false}v=v.toLowerCase();return v==attrValue}})}if(strAttributeValue!=null){strQuerySelector+=":hxAttributeValueCompare("+strAttributeName+","+strAttributeValue.toString().toLowerCase()+")"}if(blnFindInDescendant==false){return $(rootNodeOrCollection).filter(strQuerySelector).toArray()}if(intDescendantLevelToFind==1){return $(rootNodeOrCollection).filter(strQuerySelector).toArray().concat($(rootNodeOrCollection).children(strQuerySelector).toArray())}else{return $(rootNodeOrCollection).filter(strQuerySelector).toArray().concat($(rootNodeOrCollection).find(strQuerySelector).toArray())}};HXWebJS.DOM.FindPreviousInputElement=function(currentElement,blnIgnoreDisabledInputElement){if(currentElement==null){return null}if(blnIgnoreDisabledInputElement==null){blnIgnoreDisabledInputElement=true}var objTargetElement;var objTempElement=currentElement.previousSibling;while(objTempElement!=null){objTargetElement=HXWebJS.DOM._InternalFunctions._GetSiblingInputElement(objTempElement,blnIgnoreDisabledInputElement,-1);if(objTargetElement!=null){return objTargetElement}objTempElement=objTempElement.previousSibling}return HXWebJS.DOM.FindPreviousInputElement(currentElement.parentNode,blnIgnoreDisabledInputElement)};HXWebJS.DOM.FindNextInputElement=function(currentElement,blnIgnoreDisabledInputElement){if(currentElement==null){return null}if(blnIgnoreDisabledInputElement==null){blnIgnoreDisabledInputElement=true}var objTargetElement;var objTempElement=currentElement.nextSibling;while(objTempElement!=null){objTargetElement=HXWebJS.DOM._InternalFunctions._GetSiblingInputElement(objTempElement,blnIgnoreDisabledInputElement,1);if(objTargetElement!=null){return objTargetElement}objTempElement=objTempElement.nextSibling}return HXWebJS.DOM.FindNextInputElement(currentElement.parentNode,blnIgnoreDisabledInputElement)};HXWebJS.DOM._InternalFunctions._GetSiblingInputElement=function(currentElement,blnIgnoreDisabledInputElement,findDirection){if(currentElement.nodeType!=1){return null}var strTagName=currentElement.tagName.toLowerCase();if(strTagName=="input"||strTagName=="select"||strTagName=="textarea"){if(!currentElement.disabled){return currentElement}else{if(blnIgnoreDisabledInputElement){return null}else{return currentElement}}}var childNodesList=currentElement.childNodes;if(childNodesList==null||childNodesList.length==0){return null}var intStartIndex=(findDirection==-1?childNodesList.length-1:0);var intStopIndex=(findDirection==-1?-1:childNodesList.length);var intStepValue=findDirection;var i=intStartIndex;var objTempElement;while(i!=intStopIndex){objTempElement=HXWebJS.DOM._InternalFunctions._GetSiblingInputElement(childNodesList[i],blnIgnoreDisabledInputElement,findDirection);if(objTempElement!=null){return objTempElement}i+=intStepValue}return null};HXWebJS.DOM._InternalFunctions._IsElementsAttributeValueMatched=function(strAttributeName,strAttributeValue,strTagName,element){if(element==null){return false}if(element.nodeType!=1){return false}if(strAttributeValue==null){throw"HXWebJS.DOM.FindElementsByAttribute()函数要求必须指定strAttributeValue参数值。（注：可以为空字符串，但不允许为null）"}var strTempTagName=element.tagName.toLowerCase();var strTempAttrValue=HXWebJS.DOM.ElementAttributeGetValue(element,strAttributeName);var tmpIsMatched=true;if(strTempAttrValue==null||(strTempAttrValue!=null&&strAttributeValue!=strTempAttrValue.toString().toLowerCase())||(strTagName!=null&&strTagName.toLowerCase()!=strTempTagName)){tmpIsMatched=false}return tmpIsMatched};HXWebJS.DOM._InternalFunctions._hightlight_data_row=function(objContainerTable,intCurrentRowNo,intNewRowNo){var objTBody_OldRow=(intCurrentRowNo==null||intCurrentRowNo<0?null:objContainerTable.tBodies[intCurrentRowNo]);var objTBody_NewRow=(intNewRowNo==null||intNewRowNo<0?null:objContainerTable.tBodies[intNewRowNo]);if(objTBody_NewRow!=null){HXWebJS.DOM.ElementAttributeSetValue(objContainerTable,"hx_last_highlight_dataline_row_no",intNewRowNo)}if(HXWebJS.Core._InternalFunctions.IsJavascriptFunctionDefined("hxfn_callback_webdatalist__data_row_highlight_process")){hxfn_callback_webdatalist__data_row_highlight_process(objContainerTable.id,objTBody_OldRow,objTBody_NewRow)}else{if(objTBody_OldRow!=null){var objTRs_OldDataLine=objTBody_OldRow.rows;for(var i=0;i<objTRs_OldDataLine.length;i++){HXWebJS.DOM.CSSClass.RemoveClass(objTRs_OldDataLine[i],"hx_bgcolor_data_row_highlight")}}if(objTBody_NewRow!=null){var objTRs_NewDataLine=objTBody_NewRow.rows;for(var i=0;i<objTRs_NewDataLine.length;i++){HXWebJS.DOM.CSSClass.AddClass(objTRs_NewDataLine[i],"hx_bgcolor_data_row_highlight")}}}};HXWebJS.DOM.CSSAddStyle=function(strCSSContent){var styleElement=document.createElement("style");styleElement.type="text/css";if(HXWebJS.Core.Browser.IsIE){styleElement.styleSheet.cssText=strCSSContent}else{var frag=document.createDocumentFragment();frag.appendChild(document.createTextNode(strCSSContent));styleElement.appendChild(frag)}document.getElementsByTagName("head")[0].appendChild(styleElement)};HXWebJS.DOM.CSSClass={};HXWebJS.DOM.CSSClass.HasClass=function(objElement,strClassName){if(objElement==null||objElement.className==null){return}var classes=objElement.className;if(!classes){return false}if(classes==strClassName){return true}return classes.search("\\b"+strClassName+"\\b")!=-1};HXWebJS.DOM.CSSClass.AddClass=function(objElement,strClassName){if(HXWebJS.DOM.CSSClass.HasClass(objElement,strClassName)){return}if(objElement==null||objElement.className==null){return}if(objElement.className){objElement.className+=" "+strClassName}else{objElement.className=strClassName}};HXWebJS.DOM.CSSClass.RemoveClass=function(objElement,strClassName){if(objElement==null||objElement.className==null){return}objElement.className=objElement.className.replace(new RegExp("\\b"+strClassName+"\\b\\s*","g"),"")};HXWebJS.DOM.CSSClass.ToggleClass=function(objElement,strClassName){if(HXWebJS.DOM.CSSClass.HasClass(objElement,strClassName)){HXWebJS.DOM.CSSClass.RemoveClass(objElement,strClassName)}else{HXWebJS.DOM.CSSClass.AddClass(objElement,strClassName)}};HXWebJS.DOM.Cookies={};HXWebJS.DOM.Cookies.SetCookie=function(name,value){var argv=arguments,argc=arguments.length,expires=(argc>2)?argv[2]:null,path=(argc>3)?argv[3]:"/",domain=(argc>4)?argv[4]:null,secure=(argc>5)?argv[5]:false;var sb_str=new HXWebStringBuilder();sb_str.append(name+"="+escape(value));if(expires!=null){sb_str.append("; expires="+expires.toGMTString())}if(path!=null){sb_str.append("; path="+path)}if(domain!=null){sb_str.append("; domain="+domain)}if(secure==true){sb_str.append("; secure")}document.cookie=sb_str.toString()};HXWebJS.DOM.Cookies.GetCookie=function(name){var arg=name+"=",alen=arg.length,clen=document.cookie.length,i=0,j=0;while(i<clen){j=i+alen;if(document.cookie.substring(i,j)==arg){return HXWebJS.DOM.Cookies._getCookieVal(j)}i=document.cookie.indexOf(" ",i)+1;if(i===0){break}}return null};HXWebJS.DOM.Cookies.RemoveCookie=function(name,path){if(HXWebJS.DOM.Cookies.GetCookie(name)){path=path||"/";document.cookie=name+"=; expires=Thu, 01-Jan-70 00:00:01 GMT; path="+path}};HXWebJS.DOM.Cookies._getCookieVal=function(offset){var endstr=document.cookie.indexOf(";",offset);if(endstr==-1){endstr=document.cookie.length}return unescape(document.cookie.substring(offset,endstr))};HXWebJS.EventManager={};HXWebJS.EventManager._InternalFunctions={};HXWebJS.EventManager.demo__event_object={type:"click",target:null,currentTarget:null,relatedTarget:null,eventPhase:2,clientX:0,clientY:0,screenX:0,screeY:0,altKey:0,ctrlKey:0,shiftKey:0,charCode:0,keyCode:0,stopPropagation:function(){},preventDefault:function(){},dataType:"",data:null};if(document.addEventListener){HXWebJS.EventManager.AddListener=function(el,eventType,handler,useCapture){el.addEventListener(eventType,handler,(useCapture==null?false:useCapture))};HXWebJS.EventManager.RemoveListener=function(el,eventType,handler){el.removeEventListener(eventType,handler,false)};HXWebJS.EventManager.GetCurrentEventData=function(e){return e}}else{if(document.attachEvent){HXWebJS.EventManager.AddListener=function(element,eventType,handler){if(HXWebJS.EventManager._InternalFunctions._Find(element,eventType,handler)!=-1){return}var wrappedHandler=function(e){var objEvent=HXWebJS.EventManager.GetCurrentEventData(e);if(Function.prototype.call){handler.call(element,objEvent)}else{element._currentHandler=handler;element._currentHandler(objEvent);element._currentHandler=null}};element.attachEvent("on"+eventType,wrappedHandler);var h={element:element,eventType:eventType,handler:handler,wrappedHandler:wrappedHandler};var d=element.document||element;var w=d.parentWindow;var id=HXWebJS.EventManager._InternalFunctions._uid();if(!element._HXWebJSHandlers){element._HXWebJSHandlers=[]}element._HXWebJSHandlers.push(id);if(!w._allHXWebJSHandlers){w._allHXWebJSHandlers={}}w._allHXWebJSHandlers[id]=h;if(!w._onunloadHXWebJSHandlerRegistered){w._onunloadHXWebJSHandlerRegistered=true;w.attachEvent("onunload",HXWebJS.EventManager._InternalFunctions._removeAllHandlers)}};HXWebJS.EventManager.GetCurrentEventData=function(e){try{if(!e){e=window.event}else{if(e._event!=null){return e}if(e.preventDefault!=null){return e}}}catch(ex){return null}var objEvent={_event:e,type:e.type,target:e.srcElement,currentTarget:e.fromElement,relatedTarget:e.type=="mouseover"?e.fromElement:(e.type=="mouseout"||e.type=="focusout"?e.toElement:null),eventPhase:2,button:e.button,clientX:e.clientX,clientY:e.clientY,screenX:e.screenX,screenY:e.screenY,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,charCode:e.keyCode,keyCode:e.keyCode,stopPropagation:function(){this._event.cancelBubble=true},preventDefault:function(){this._event.returnValue=false},dataTransfer:e.dataTransfer,dataType:(e.dataType||""),data:(e.data||null)};return objEvent};HXWebJS.EventManager.RemoveListener=function(element,eventType,handler){var i=HXWebJS.EventManager._InternalFunctions._Find(element,eventType,handler);if(i==-1){return}var d=element.document||element;var w=d.parentWindow;var handlerId=element._HXWebJSHandlers[i];var h=w._allHXWebJSHandlers[handlerId];element.detachEvent("on"+eventType,h.wrappedHandler);element._HXWebJSHandlers.splice(i,1);delete w._allHXWebJSHandlers[handlerId]};HXWebJS.EventManager._InternalFunctions._Find=function(element,eventType,handler){if(element==null){return -1}var handlers=element._HXWebJSHandlers;if(!handlers){return -1}var d=element.document||element;var w=d.parentWindow;for(var i=handlers.length-1;i>=0;i--){var handlerId=handlers[i];var h=w._allHXWebJSHandlers[handlerId];if(h.eventType==eventType&&h.handler==handler){return i}}return -1};HXWebJS.EventManager._InternalFunctions._removeAllHandlers=function(){var w=this;for(var i=1;i<HXWebJS.EventManager._InternalFunctions._counter;i++){var id="h"+i;var h=w._allHXWebJSHandlers[id];if(h==null){continue}h.element.detachEvent("on"+h.eventType,h.wrappedHandler);delete w._allHXWebJSHandlers[id]}};HXWebJS.EventManager._InternalFunctions._counter=0;HXWebJS.EventManager._InternalFunctions._uid=function(){return"h"+HXWebJS.EventManager._InternalFunctions._counter++}}}HXWebJS.EventManager.AddListenerForElements=function(elements,eventType,handler){if(elements==null){return}if(elements.length==null){HXWebJS.EventManager.AddListener(elements,eventType,handler);return}for(var i=0;i<elements.length;i++){HXWebJS.EventManager.AddListener(elements[i],eventType,handler)}};HXWebJS.EventManager.FireEvent=function(element,eventType,jsonKeyData){if(document.createEvent){var e=document.createEvent("Events");e.initEvent(eventType,true,false);if(jsonKeyData!=null){e.altKey=!!jsonKeyData.altKey;e.ctrlKey=!!jsonKeyData.ctrlKey;e.shiftKey=!!jsonKeyData.shiftKey;if(jsonKeyData.keyCode!=null){e.keyCode=jsonKeyData.keyCode}e.data=jsonKeyData}element.dispatchEvent(e)}else{if(document.createEventObject){var e=document.createEventObject();if(jsonKeyData!=null){e.altKey=!!jsonKeyData.altKey;e.ctrlKey=!!jsonKeyData.ctrlKey;e.shiftKey=!!jsonKeyData.shiftKey;if(jsonKeyData.keyCode!=null){e.keyCode=jsonKeyData.keyCode}e.data=jsonKeyData}element.fireEvent("on"+eventType,e)}}};HXWebJS.EventManager.FireCustomizedEvent=function(targetElement,dataType,data,fromElement){if(typeof targetElement=="string"){targetElement=document.getElementById(targetElement)}if(document.createEvent){var e=document.createEvent("Events");e.initEvent("dataavailable",true,false)}else{if(document.createEventObject){var e=document.createEventObject()}else{return}}e.dataType=dataType;e.data=data;e.fromElement=fromElement;if(targetElement.dispatchEvent){targetElement.dispatchEvent(e)}else{if(targetElement.fireEvent){targetElement.fireEvent("ondataavailable",e)}}};HXWebJS.EventManager.AddCustomizedEventListener=function(el,handler){HXWebJS.EventManager.AddListener(el,"dataavailable",handler)};HXWebJS.EventManager.RemoveCustomizedEventListener=function(el,handler){HXWebJS.EventManager.RemoveListener(el,"dataavailable",handler)};HXWebJS.EventManager._InternalFunctions._funcsAfterOnLoad=[];HXWebJS.EventManager._InternalFunctions._loadedOK=false;HXWebJS.EventManager._InternalFunctions._RegistedCallbackFunctions={};HXWebJS.EventManager.RegisterCallbackFunction=function(strCallbackType,fn){if(strCallbackType==null||strCallbackType==""){return}if(fn==null){return}var c=HXWebJS.EventManager._InternalFunctions._RegistedCallbackFunctions[strCallbackType];if(c==null){c=[];c.push(fn);HXWebJS.EventManager._InternalFunctions._RegistedCallbackFunctions[strCallbackType]=c}else{for(var i=0;i<c.length;i++){if(c[i]===fn){return}}c.push(fn)}};HXWebJS.EventManager.GetRegistedCallbackFuncList=function(strCallbackType){if(strCallbackType==null||strCallbackType==""){return null}return HXWebJS.EventManager._InternalFunctions._RegistedCallbackFunctions[strCallbackType]};HXWebJS.EventManager.RegisterFuncRunAfterOnLoad=function(f){if(HXWebJS.EventManager._InternalFunctions._loadedOK){f()}else{HXWebJS.EventManager._InternalFunctions._funcsAfterOnLoad.push(f)}};HXWebJS.EventManager.OnDocumentReady=null;HXWebJS.EventManager._InternalFunctions._runAfterOnLoad=function(){if(HXWebJS.EventManager._InternalFunctions._loadedOK){return}if(HXWebJS.Navigation.IsWebPageOpenedInDialog()){HXWebJS.Navigation._InternalFunctions._set_dialog_title_onload()}if(typeof(HXWebEditPageHelper)!="undefined"){HXWebEditPageHelper._InternalFunctions._onloadprocess_before_binding()}HXWebJS.Xml._XmlDataIsland._onload_binding_process();if(typeof(HXWebEditPageHelper)!="undefined"){HXWebEditPageHelper._InternalFunctions._onloadprocess_after_binding()}var fn;for(var i=0;i<HXWebJS.EventManager._InternalFunctions._funcsAfterOnLoad.length;i++){fn=HXWebJS.EventManager._InternalFunctions._funcsAfterOnLoad[i];try{fn()}catch(e){alert("HXWebJS.EventManager执行通过RegisterFuncRunAfterOnLoad()注册的函数时发生错误。\r\n 函数："+fn.toString()+", 错误消息："+e)}}if(HXWebJS.EventManager.OnDocumentReady!=null&&typeof(HXWebJS.EventManager.OnDocumentReady)=="function"){var blnExitDirectly=HXWebJS.EventManager.OnDocumentReady();if(blnExitDirectly){return}}HXWebJS.EventManager._InternalFunctions._loadedOK=true;delete HXWebJS.EventManager._InternalFunctions._funcsAfterOnLoad;delete HXWebJS.EventManager._InternalFunctions._runAfterOnLoad};if(window.addEventListener){window.addEventListener("load",HXWebJS.EventManager._InternalFunctions._runAfterOnLoad,false)}else{if(window.attachEvent){window.attachEvent("onload",HXWebJS.EventManager._InternalFunctions._runAfterOnLoad)}else{window.onload=HXWebJS.EventManager._InternalFunctions._runAfterOnLoad}};var HXWebJS;if(!HXWebJS){HXWebJS={}}HXWebJS.Xml={};HXWebJS.Xml.MarkXMLSpecialChars=function(strText){if(strText==null){return null}if(typeof(strText)!="string"){strText=strText.toString()}var strTemp=strText.replace(/&/g,"&amp;");strTemp=strTemp.replace(/</g,"&lt;");strTemp=strTemp.replace(/>/g,"&gt;");strTemp=strTemp.replace(/"/g,"&quot;");return strTemp};HXWebJS.Xml.BuildAllXmlDatas=function(strDataBlockCode1,strDataBlockContent1,strDataBlockCode2,strDataBlockContent2){var i,numArgs=arguments.length;if(numArgs<4){alert("HXWebJS.Xml.BuildAllXmlDatas()函数的参数数量太少（至少需要4个或者以上）。");return}var sb_all=new HXWebStringBuilder();sb_all.append("<HX_ALL_DATAS>");for(i=0;i<numArgs;i+=2){sb_all.append('<HX_DATA_BLOCK CODE="');sb_all.append(HXWebJS.Xml.MarkXMLSpecialChars(arguments[i].toLowerCase()));sb_all.append('">');sb_all.append(HXWebJS.Xml.MarkXMLSpecialChars(arguments[i+1]));sb_all.append("</HX_DATA_BLOCK>")}sb_all.append("</HX_ALL_DATAS>");return sb_all.toString()};HXWebJS.Xml.RegisterOnBindingValueChangedCallback=function(fn){HXWebJS.EventManager.RegisterCallbackFunction("hxxmldataisland_onbindingvaluechanged",fn)};HXWebJS.Xml._InternalFunctions={};HXWebJS.Xml._InternalFunctions._build_xmlstring_via_element_content=function(docelt,arrAttributeListForLineFeedProcess){var sb=new HXWebJS.Core.StringBuilder();var attr;sb.append("<");sb.append(docelt.nodeName.toUpperCase());var strAttrName,strAttrValue;for(var i=0;i<docelt.attributes.length;i++){attr=docelt.attributes[i];sb.append(" ");strAttrName=attr.nodeName.toUpperCase();sb.append(strAttrName);sb.append('="');strAttrValue=attr.nodeValue;if(typeof ActiveXObject=="undefined"&&!HXWebJS.Core.Browser.IsIE11&&arrAttributeListForLineFeedProcess!=null&&HXWebJS.Utility.StringInArray(arrAttributeListForLineFeedProcess,strAttrName,true)){strAttrValue=strAttrValue.replace(/\n/g,"[!HX XML_LF]")}sb.append(HXWebJS.Xml.MarkXMLSpecialChars(strAttrValue));sb.append('"')}sb.append(">");var childNode;for(var i=0;i<docelt.childNodes.length;i++){childNode=docelt.childNodes[i];if(childNode.nodeType==1){sb.append(HXWebJS.Xml._InternalFunctions._build_xmlstring_via_element_content(childNode,arrAttributeListForLineFeedProcess))}}sb.append("</");sb.append(docelt.nodeName.toUpperCase());sb.append(">");return sb.toString()};HXWebJS.Xml.GetHXXmlDocumentViaXmlString=function(strXml,arrAttributeListForLineFeedProcess){if(strXml==null||strXml==""){return null}var objHXXmlDoc=new HXWebJS.Xml.HXXmlDocument();objHXXmlDoc._xml_data_island_id="";if(typeof ActiveXObject!="undefined"||HXWebJS.Core.Browser.IsIE11){objHXXmlDoc._xmldoc=new ActiveXObject("Microsoft.XMLDOM");objHXXmlDoc._xmldoc.async=false;objHXXmlDoc._xmldoc.loadXML(strXml)}else{if(typeof DOMParser!="undefined"){objHXXmlDoc._xmldoc=(new DOMParser()).parseFromString(strXml,"application/xml");if(arrAttributeListForLineFeedProcess!=null){var strTempAttrName;for(var i=0;i<arrAttributeListForLineFeedProcess.length;i++){strTempAttrName=arrAttributeListForLineFeedProcess[i].toUpperCase();var objHXXmlNodeList=objHXXmlDoc.SelectNodes("//@"+strTempAttrName);for(var j=0;j<objHXXmlNodeList.length;j++){var objHXXmlNode=objHXXmlNodeList[j];objHXXmlNode.SetText(objHXXmlNode.GetText().replace(/\[!HX XML_LF\]/g,String.fromCharCode(10)))}}}}else{throw"HXWebJS.Xml.GetHXXmlDocumentViaXmlString()函数运行错误：当前浏览器不支持该功能！"}}return objHXXmlDoc};HXWebJS.Xml.GetHXXmlDocumentViaURL=function(strURL){if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest()}else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}xmlhttp.open("GET",strURL,false);xmlhttp.send();var _xmlDoc=xmlhttp.responseXML;var objHXXmlDoc=new HXWebJS.Xml.HXXmlDocument(_xmlDoc,"");return objHXXmlDoc};HXWebJS.Xml.GetHXXmlDocumentViaXmlDataIsland=function(id){if(id==null){return null}var xmldoc=document.getElementById(id);if(xmldoc==null){return null}var objHXXmlDoc;if(typeof ActiveXObject!="undefined"&&parseFloat(HXWebJS.Core.Browser.Version)<10){objHXXmlDoc=new HXWebJS.Xml.HXXmlDocument(xmldoc,id);return objHXXmlDoc}if(!HXWebJS.Xml._InternalFunctions._xmldoc_cache_for_xmldataisland){HXWebJS.Xml._InternalFunctions._xmldoc_cache_for_xmldataisland={}}var objHXXmlDoc=HXWebJS.Xml._InternalFunctions._xmldoc_cache_for_xmldataisland[id];if(objHXXmlDoc){return objHXXmlDoc}var docelt=xmldoc.firstChild;while(docelt!=null){if(docelt.nodeType==1){break}docelt=docelt.nextSibling}if(docelt==null){objHXXmlDoc=new HXWebJS.Xml.HXXmlDocument(null,id);return objHXXmlDoc}var arrAttributeListForLineFeedProcess=HXWebJS.Xml._XmlDataIsland._registed_xmlbinding_linefeed_attributes[id];var strXmlData=HXWebJS.Xml._InternalFunctions._build_xmlstring_via_element_content(docelt,arrAttributeListForLineFeedProcess);var objHXXmlDoc=HXWebJS.Xml.GetHXXmlDocumentViaXmlString(strXmlData,arrAttributeListForLineFeedProcess);objHXXmlDoc._xml_data_island_id=id;HXWebJS.Xml._InternalFunctions._xmldoc_cache_for_xmldataisland[id]=objHXXmlDoc;return objHXXmlDoc};HXWebJS.Xml.HXXmlDocument=function(objXmlDoc,strXmlDataIslandId){if(strXmlDataIslandId==null){strXmlDataIslandId=""}this._xml_data_island_id=strXmlDataIslandId;this._xmldoc=objXmlDoc};HXWebJS.Xml.HXXmlDocument.prototype.GetXml=function(){var objXmlDoc=this._xmldoc;if(objXmlDoc==null){return""}if(objXmlDoc.xml!=null){return objXmlDoc.xml}else{if(typeof XMLSerializer!="undefined"){var strXml=(new XMLSerializer()).serializeToString(objXmlDoc);if(strXml.indexOf("<?xml")!=-1){strXml=strXml.substr(21)}return strXml}else{throw"HXWebJS.Xml.HXXmlDocument.GetXml()函数运行错误：无法正确获取XmlDoc对象"+objXmlDoc+"的内容"}}};HXWebJS.Xml.HXXmlDocument.prototype.GetRootXmlNode=function(){if(this._xmldoc==null){return null}var objHXXmlNode=new HXWebJS.Xml.HXXmlNode();objHXXmlNode._xml_data_island_id=this._xml_data_island_id;if(this._xmldoc.documentElement){objHXXmlNode._xmlnode=this._xmldoc.documentElement}else{var docelt=this._xmldoc.firstChild;while(docelt!=null){if(docelt.nodeType==1){break}docelt=docelt.nextSibling}objHXXmlNode._xmlnode=docelt}return objHXXmlNode};HXWebJS.Xml.HXXmlDocument.prototype.SelectSingleNode=function(xpathText){if(this._xmldoc==null){return null}var objHXXmlNode=this.GetRootXmlNode();if(objHXXmlNode==null){return null}return objHXXmlNode.SelectSingleNode(xpathText)};HXWebJS.Xml.HXXmlDocument.prototype.SelectNodes=function(xpathText){if(this._xmldoc==null){return(new Array(0))}var objHXXmlNode=this.GetRootXmlNode();if(objHXXmlNode==null){return(new Array(0))}return objHXXmlNode.SelectNodes(xpathText)};HXWebJS.Xml.HXXmlDocument.prototype.ReloadXML=function(strXmlContent){if(strXmlContent==null){strXmlContent=""}if(typeof ActiveXObject!="undefined"||HXWebJS.Core.Browser.IsIE11){if(this._xmldoc==null){this._xmldoc=new ActiveXObject("Microsoft.XMLDOM")}this._xmldoc.async=false;this._xmldoc.loadXML(strXmlContent);if(this._xml_data_island_id!=""){if(parseFloat(HXWebJS.Core.Browser.Version)<10){HXWebJS.Xml._XmlDataIsland._HideTemplateLineOfEmptyXmlDataIslandAndCallBindingFinishedCallback(this._xml_data_island_id,true)}else{if(HXWebJS.Xml._InternalFunctions._xmldoc_cache_for_xmldataisland[this._xml_data_island_id]==null){HXWebJS.Xml._InternalFunctions._xmldoc_cache_for_xmldataisland[this._xml_data_island_id]=this}HXWebJS.Xml._XmlDataIsland._reload_xml_and_rebinding_process(this._xml_data_island_id)}}return}if(typeof DOMParser!="undefined"){this._xmldoc=(new DOMParser()).parseFromString(strXmlContent,"application/xml");if(this._xml_data_island_id!=null&&this._xml_data_island_id!=""){if(HXWebJS.Xml._InternalFunctions._xmldoc_cache_for_xmldataisland[this._xml_data_island_id]==null){HXWebJS.Xml._InternalFunctions._xmldoc_cache_for_xmldataisland[this._xml_data_island_id]=this}HXWebJS.Xml._XmlDataIsland._reload_xml_and_rebinding_process(this._xml_data_island_id)}}};HXWebJS.Xml.HXXmlDocument.prototype.InsertChild=function(objHXXmlNodeToInsert,insertBefore){return this.GetRootXmlNode().InsertChild(objHXXmlNodeToInsert,insertBefore)};HXWebJS.Xml.HXXmlDocument.prototype.AppendChild=function(objHXXmlNodeToAppend){return this.GetRootXmlNode().InsertChild(objHXXmlNodeToAppend,null)};HXWebJS.Xml.HXXmlDocument.prototype.RemoveChild=function(objHXXmlNodeToRemove){return this.GetRootXmlNode().RemoveChild(objHXXmlNodeToRemove)};HXWebJS.Xml.HXXmlDocument.prototype.ClearAllContents=function(){var objHXXmlNodeList=this.SelectNodes("//RS_ROW");for(var i=objHXXmlNodeList.length-1;i>=0;i--){this.RemoveChild(objHXXmlNodeList[i])}this.ReloadXML("")};HXWebJS.Xml.HXXmlNode=function(){this._xml_data_island_id="";this._xmlnode=null};HXWebJS.Xml.HXXmlNode.prototype.SelectSingleNode=function(xpathText){if(this._xmlnode==null){return null}if(document.createExpression){var _xmldoc=(this._xmlnode.ownerDocument==null?this._xmlnode:this._xmlnode.ownerDocument);var xpathExpr=_xmldoc.createExpression(xpathText,null);var result=xpathExpr.evaluate(this._xmlnode,XPathResult.FIRST_ORDERED_NODE_TYPE,null);if(result.singleNodeValue==null){return null}var objHXXmlNode=new HXWebJS.Xml.HXXmlNode();objHXXmlNode._xml_data_island_id=this._xml_data_island_id;objHXXmlNode._xmlnode=result.singleNodeValue;return objHXXmlNode}else{try{var doc=this._xmlnode.ownerDocument;if(doc==null){doc=this._xmlnode}if(this._xmlnode==doc){this._xmlnode=doc.documentElement}var _tempNode=this._xmlnode.selectSingleNode(xpathText);if(_tempNode==null){return null}var objHXXmlNode=new HXWebJS.Xml.HXXmlNode();objHXXmlNode._xml_data_island_id=this._xml_data_island_id;objHXXmlNode._xmlnode=_tempNode;return objHXXmlNode}catch(e){throw"HXWebJS.Xml.HXXmlNode.SelectSingleNode()运行错误：当前浏览器不支持 XPath."+e}}};HXWebJS.Xml.HXXmlNode.prototype.SelectNodes=function(xpathText){if(this._xmlnode==null){return(new Array(0))}if(document.createExpression){var _xmldoc=(this._xmlnode.ownerDocument==null?this._xmlnode:this._xmlnode.ownerDocument);var xpathExpr=_xmldoc.createExpression(xpathText,function(prefix){return null});var result=xpathExpr.evaluate(this._xmlnode,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);var a=new Array(result.snapshotLength);for(var i=0;i<result.snapshotLength;i++){var objHXXmlNode=new HXWebJS.Xml.HXXmlNode();objHXXmlNode._xml_data_island_id=this._xml_data_island_id;objHXXmlNode._xmlnode=result.snapshotItem(i);a[i]=objHXXmlNode}return a}try{var doc=this._xmlnode.ownerDocument;if(doc==null){doc=this._xmlnode}if(this._xmlnode==doc){this._xmlnode=doc.documentElement}var _tempNodeList=this._xmlnode.selectNodes(xpathText);var a=new Array(_tempNodeList.length);for(var i=0;i<_tempNodeList.length;i++){var objHXXmlNode=new HXWebJS.Xml.HXXmlNode();objHXXmlNode._xml_data_island_id=this._xml_data_island_id;objHXXmlNode._xmlnode=_tempNodeList.item(i);a[i]=objHXXmlNode}return a}catch(e){throw"HXWebJS.Xml.HXXmlNode.SelectNodes()运行错误：当前浏览器不支持 XPath."+e}};HXWebJS.Xml.HXXmlNode.prototype.GetFirstChild=function(){if(this._xmlnode==null){return null}var objTempXmlNode=this._xmlnode.firstChild;if(objTempXmlNode==null){return null}var objHXXmlNode=new HXWebJS.Xml.HXXmlNode();objHXXmlNode._xml_data_island_id=this._xml_data_island_id;objHXXmlNode._xmlnode=objTempXmlNode;return objHXXmlNode};HXWebJS.Xml.HXXmlNode.prototype.GetName=function(){if(this._xmlnode==null){return""}return this._xmlnode.nodeName};HXWebJS.Xml.HXXmlNode.prototype.GetText=function(){if(this._xmlnode==null){return""}if(typeof this._xmlnode.value!="undefined"){return this._xmlnode.value}if(typeof this._xmlnode.textContent!="undefined"){return this._xmlnode.textContent}if(typeof this._xmlnode.text!="undefined"){return this._xmlnode.text}throw"HXWebJS.Xml.HXXmlNode.GetText()运行错误：当前浏览器不支持Xml."};HXWebJS.Xml.HXXmlNode.prototype._SetText=function(str){if(this._xmlnode==null){return}if(typeof this._xmlnode.text!="undefined"){this._xmlnode.text=str;return}if(typeof this._xmlnode.textContent!="undefined"){this._xmlnode.textContent=str;return}if(typeof this._xmlnode.value!="undefined"){this._xmlnode.value=str;return}throw"HXWebJS.Xml.HXXmlNode.SetText()运行错误：当前浏览器不支持Xml."};HXWebJS.Xml.HXXmlNode.prototype.SetText=function(str,blnAutoUpdateBindingElementValue){if(str==null){str=""}this._SetText(str);var blnIsIE9orLess=HXWebJS.Core.Browser.IsIE&&parseFloat(HXWebJS.Core.Browser.Version)<10;if(blnIsIE9orLess){return}if(blnAutoUpdateBindingElementValue==false){return}if(this._xml_data_island_id!=""){if(this._xmlnode.nodeType!=2){return}var strAttributeName=this._xmlnode.nodeName;var objHXXmlNode=new HXWebJS.Xml.HXXmlNode();objHXXmlNode._xml_data_island_id=this._xml_data_island_id;objHXXmlNode._xmlnode=(HXWebJS.Core.Browser.IsIE||HXWebJS.Core.Browser.IsIE11?this._xmlnode.selectSingleNode(".."):this._xmlnode.ownerElement);HXWebJS.Xml._XmlDataIsland._update_binding_elements_value(objHXXmlNode,strAttributeName,str)}};HXWebJS.Xml.HXXmlNode.prototype.SetCDATAText=function(strText){if(this._xmlnode==null){return}if(this._xmlnode.nodeType!=1){return}this._SetText("");var xmldoc=this._xmlnode.ownerDocument;if(xmldoc==null){throw"没有找到当前节点的归属Xml文档对象（可能是孤立节点）！不能创建CDATA段！"}var newnode=xmldoc.createCDATASection(strText);this._xmlnode.appendChild(newnode)};HXWebJS.Xml.HXXmlNode.prototype.GetXml=function(){var objXmlNode=this._xmlnode;if(objXmlNode==null){return""}if(objXmlNode.xml!=null){return objXmlNode.xml}else{if(typeof XMLSerializer!="undefined"){return(new XMLSerializer()).serializeToString(objXmlNode)}else{throw"HXWebJS.Xml.HXXmlNode.GetXml()函数运行错误：无法正确获取XmlNode对象"+objXmlNode+"的内容"}}};HXWebJS.Xml.HXXmlNode.prototype.GetAttributeValue=function(strAttributeName){var objXmlNode=this._xmlnode;if(objXmlNode==null){return null}if(typeof objXmlNode.getAttribute=="function"){return objXmlNode.getAttribute(strAttributeName)}if(objXmlNode.attributes){if(objXmlNode.selectSingleNode("@"+strAttributeName)==null){return null}return objXmlNode.selectSingleNode("@"+strAttributeName).value}return null};HXWebJS.Xml.HXXmlNode.prototype._SetAttributeValueOnly=function(strAttributeName,strAttributeValue,blnCreateIfNotExist){if(this._xmlnode==null){return}if(blnCreateIfNotExist==null){blnCreateIfNotExist=false}if(strAttributeValue==null){strAttributeValue=""}var objXmlNode=this._xmlnode;if(typeof objXmlNode.setAttribute=="function"){objXmlNode.setAttribute(strAttributeName,strAttributeValue)}else{if(objXmlNode.attributes){var objTemp=objXmlNode.selectSingleNode("@"+strAttributeName);if(objTemp!=null){objTemp.text=strAttributeValue}else{if(blnCreateIfNotExist){var objNewAttribute=objXmlNode.ownerDocument.createAttribute(strAttributeName);objNewAttribute.value=strAttributeValue;objXmlNode.attributes.setNamedItem(objNewAttribute)}}}else{throw"HXWebJS.Xml.HXXmlNode._SetAttributeValue()运行错误：当前浏览器不支持 Xml属性处理。"}}};HXWebJS.Xml.HXXmlNode.prototype.SetAttributeValue=function(strAttributeName,strAttributeValue,blnCreateIfNotExist,blnAutoUpdateBindingElementValue){this._SetAttributeValueOnly(strAttributeName,strAttributeValue,blnCreateIfNotExist);var blnIsIE=HXWebJS.Core.Browser.IsIE&&parseFloat(HXWebJS.Core.Browser.Version)<10;if(this._xml_data_island_id!=""&&!blnIsIE){if(blnAutoUpdateBindingElementValue==false){return}HXWebJS.Xml._XmlDataIsland._update_binding_elements_value(this,strAttributeName,strAttributeValue)}};HXWebJS.Xml.HXXmlNode.prototype.RemoveAttribute=function(strAttributeName){if(this._xmlnode==null){return}var objXmlNode=this._xmlnode;if(typeof objXmlNode.removeAttribute=="function"){objXmlNode.removeAttribute(strAttributeName)}else{if(objXmlNode.attributes){var objTemp=objXmlNode.selectSingleNode("@"+strAttributeName);if(objTemp!=null){objXmlNode.attributes.removeNamedItem(strAttributeName)}}else{throw"HXWebJS.Xml.HXXmlNode.RemoveAttribute()运行错误：当前浏览器不支持 Xml属性移除操作。"}}};HXWebJS.Xml.HXXmlNode.prototype.CloneNode=function(){var obj=new HXWebJS.Xml.HXXmlNode();obj._xml_data_island_id="";obj._xmlnode=this._xmlnode.cloneNode(true);return obj};HXWebJS.Xml.HXXmlNode.prototype.InsertChild=function(objHXXmlNodeToInsert,insertBefore){if(this._xmlnode==null){return null}if(objHXXmlNodeToInsert==null){return null}if(objHXXmlNodeToInsert._xmlnode==null){return null}var _ib=null;if(insertBefore!=null&&insertBefore._xmlnode!=null){_ib=insertBefore._xmlnode}objHXXmlNodeToInsert._xml_data_island_id=this._xml_data_island_id;this._xmlnode.insertBefore(objHXXmlNodeToInsert._xmlnode,_ib);if(this._xml_data_island_id!=""){HXWebJS.Xml._XmlDataIsland._insert_new_binding_line_content(objHXXmlNodeToInsert,insertBefore)}return objHXXmlNodeToInsert};HXWebJS.Xml.HXXmlNode.prototype.AppendChild=function(objHXXmlNodeToAppend){return this.InsertChild(objHXXmlNodeToAppend,null)};HXWebJS.Xml.HXXmlNode.prototype.RemoveChild=function(objHXXmlNodeToRemove){if(this._xmlnode==null){return null}if(objHXXmlNodeToRemove==null){return null}if(objHXXmlNodeToRemove._xmlnode==null){return null}var blnIsIE=HXWebJS.Core.Browser.IsIE&&parseFloat(HXWebJS.Core.Browser.Version)<10;if(this._xml_data_island_id!=""&&!blnIsIE){HXWebJS.Xml._XmlDataIsland._remove_binding_line(objHXXmlNodeToRemove)}this._xmlnode.removeChild(objHXXmlNodeToRemove._xmlnode);return objHXXmlNodeToRemove};HXWebJS.Xml.HXXmlNode.prototype.ReplaceChild=function(objOldHXXmlNode,objNewHXXmlNode){if(this._xmlnode==null){return null}if(objOldHXXmlNode==null){return null}if(objOldHXXmlNode._xmlnode==null){return null}if(objNewHXXmlNode==null){return null}if(objNewHXXmlNode._xmlnode==null){return null}this._xmlnode.replaceChild(objNewHXXmlNode._xmlnode,objOldHXXmlNode._xmlnode);if(this._xml_data_island_id!=""){objNewHXXmlNode._xml_data_island_id=this._xml_data_island_id;HXWebJS.Xml._XmlDataIsland._refresh_binding_line_content(objNewHXXmlNode)}return objNewHXXmlNode};HXWebJS.Xml.HXXmlNode.prototype.SwapChild=function(indexA,indexB){var xmlNode1=this._xmlnode.childNodes[indexA];var xmlNode2=this._xmlnode.childNodes[indexB];var xmlNodeTemp=xmlNode1.cloneNode(true);this._xmlnode.replaceChild(xmlNode2.cloneNode(true),xmlNode1);this._xmlnode.replaceChild(xmlNodeTemp,xmlNode2)};HXWebJS.Xml.CreateNode=function(strXml){if(strXml==null||strXml==""){return null}var objHXXmlDoc=HXWebJS.Xml.GetHXXmlDocumentViaXmlString(strXml);if(objHXXmlDoc==null){return null}var objHXXmlNode=objHXXmlDoc.GetRootXmlNode();if(objHXXmlNode==null){return null}return objHXXmlNode.CloneNode()};HXWebJS.Xml.demo__hxxmldocument={GetXml:function(){},GetRootXmlNode:function(){},SelectSingleNode:function(xpathText){},SelectNodes:function(xpathText){},ReloadXML:function(strXmlContent){},InsertChild:function(objHXXmlNodeToInsert,insertBefore){},AppendChild:function(objHXXmlNodeToAppend){},RemoveChild:function(objHXXmlNodeToRemove){}};HXWebJS.Xml.demo__hxxmlnode={SelectSingleNode:function(xpathText){},SelectNodes:function(xpathText){},GetFirstChild:function(){},GetText:function(){},SetText:function(str){},GetXml:function(){},CloneNode:function(){},GetAttributeValue:function(strAttributeName){},SetAttributeValue:function(strAttributeName,strAttributeValue){},InsertChild:function(objHXXmlNodeToInsert,insertBefore){},AppendChild:function(objHXXmlNodeToAppend){},RemoveChild:function(objHXXmlNodeToRemove){},ReplaceChild:function(objOldHXXmlNode,objNewHXXmlNode){}};HXWebJS.Xml.XmlService={};var HXWebXmlService=HXWebJS.Xml.XmlService;HXWebJS.Xml.XmlService._InternalFunctions={};HXWebJS.Xml.XmlService.SayToServer=function(SubsystemID,XMLCmdCode,xmlCmdContent,blnShowErrorMsg){var httpOb;if(typeof ActiveXObject!="undefined"||HXWebJS.Core.Browser.IsIE11){httpOb=new ActiveXObject("Microsoft.XMLHTTP")}else{httpOb=new XMLHttpRequest()}var strRequestFullXmlData=HXWebJS.Xml.XmlService._InternalFunctions._HXBOD205_Build(SubsystemID,XMLCmdCode,xmlCmdContent);var aspFile=gstrWebRootPath+"hxpublic/hxxmlservice.aspx";if(typeof(mstrHXPageServerEnginee)=="string"){if(mstrHXPageServerEnginee=="V6"){aspFile=gstrWebRootPath+"hxpublic_v6/hxxmlservice6.aspx";strRequestFullXmlData=HXWebJS.Xml.MarkXMLSpecialChars(strRequestFullXmlData)}}httpOb.open("POST",aspFile,false);httpOb.setRequestHeader("If-Modified-Since","0");httpOb.send(strRequestFullXmlData);var objHXXmlDoc=new HXWebJS.Xml.HXXmlDocument(httpOb.responseXML);if(objHXXmlDoc==null||objHXXmlDoc.GetXml()==""){var strTempResponseText=httpOb.responseText;var intBeginIndex_FriendMsgString=strTempResponseText.indexOf("trusthx_app_offline_html_page_flag__used_for_hxxmlservice_friend_notice");if(intBeginIndex_FriendMsgString!=-1){intBeginIndex_FriendMsgString=strTempResponseText.indexOf(">",intBeginIndex_FriendMsgString+1);if(intBeginIndex_FriendMsgString==-1){alert(strTempResponseText)}else{var intEndIndex_FriendMsgString=strTempResponseText.indexOf("</span>",intBeginIndex_FriendMsgString+1);var strMsgText=(intEndIndex_FriendMsgString==-1?strTempResponseText.substr(intBeginIndex_FriendMsgString+1):strTempResponseText.substring(intBeginIndex_FriendMsgString+1,intEndIndex_FriendMsgString));strMsgText=strMsgText.replace(/<br \/>/g,"\r\n");alert(strMsgText)}return null}var intTemp=strTempResponseText.indexOf("<BODY");if(intTemp!=-1){strTempResponseText=strTempResponseText.substr(intTemp)}alert("HXWebXmlService收到Web服务器返回的异常消息。服务器返回的信息参考：\r\n"+strTempResponseText);return null}var result=HXWebJS.Xml.XmlService._InternalFunctions._HXBOD205_ErrorHandle(httpOb.responseXML,blnShowErrorMsg);return result};HXWebJS.Xml.XmlService.SayToServerAsync=function(SubsystemID,XMLCmdCode,xmlCmdContent,ResponseFunction,blnShowErrorMsg){var httpOb;if(typeof ActiveXObject!="undefined"||HXWebJS.Core.Browser.IsIE11){httpOb=new ActiveXObject("Microsoft.XMLHTTP")}else{httpOb=new XMLHttpRequest()}httpOb.onreadystatechange=HXWebJS.Xml.XmlService._InternalFunctions._GetResponseProcessHandlerFunction(httpOb,ResponseFunction,blnShowErrorMsg);var strRequestFullXmlData=HXWebJS.Xml.XmlService._InternalFunctions._HXBOD205_Build(SubsystemID,XMLCmdCode,xmlCmdContent);var aspFile=gstrWebRootPath+"hxpublic/hxxmlservice.aspx";if(typeof(mstrHXPageServerEnginee)=="string"){if(mstrHXPageServerEnginee=="V6"){aspFile=gstrWebRootPath+"hxpublic_v6/hxxmlservice6.aspx";strRequestFullXmlData=HXWebJS.Xml.MarkXMLSpecialChars(strRequestFullXmlData)}}httpOb.open("POST",aspFile,true);httpOb.setRequestHeader("If-Modified-Since","0");httpOb.send(strRequestFullXmlData)};HXWebJS.Xml.XmlService.CallPageXmlService=function(PageXmlSvcCode,PageXmlSvcCnt,PageXmlSvcAssemblyName,PageXmlSvcClassName,blnShowErrorMsg,intAssemblyLoadMode,strHXPageName,strExtendWebPartHtmlId){var strAssemblyName=(PageXmlSvcAssemblyName!=null?PageXmlSvcAssemblyName:HXWebPageGlobalVariables._InternalFunctions.GetPageXmlSvcAssemblyName());if(strAssemblyName==null){return null}var strSvcClassName=(PageXmlSvcClassName!=null?PageXmlSvcClassName:HXWebPageGlobalVariables._InternalFunctions.GetPageXmlSvcClassName());if(strSvcClassName==null){return null}if(PageXmlSvcCnt==null){PageXmlSvcCnt=""}var xmlCmdContent=HXWebJS.Xml.XmlService._InternalFunctions._BuildPageXmlSvcXmlCmdContent(PageXmlSvcCode,PageXmlSvcCnt,strAssemblyName,strSvcClassName,intAssemblyLoadMode,strHXPageName,strExtendWebPartHtmlId);var result=HXWebJS.Xml.XmlService.SayToServer("HXSM","HXSM_PAGE_XML_SERVICE",xmlCmdContent,blnShowErrorMsg);return result};HXWebJS.Xml.XmlService.CallPageXmlServiceAsync=function(PageXmlSvcCode,PageXmlSvcCnt,ResponseFunction,PageXmlSvcAssemblyName,PageXmlSvcClassName,blnShowErrorMsg,intAssemblyLoadMode,strHXPageName,strExtendWebPartHtmlId){var strAssemblyName=(PageXmlSvcAssemblyName!=null?PageXmlSvcAssemblyName:HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetPageXmlSvcAssemblyName());if(strAssemblyName==null){return null}var strSvcClassName=(PageXmlSvcClassName!=null?PageXmlSvcClassName:HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetPageXmlSvcClassName());if(strSvcClassName==null){return null}if(PageXmlSvcCnt==null){PageXmlSvcCnt=""}var xmlCmdContent=HXWebJS.Xml.XmlService._InternalFunctions._BuildPageXmlSvcXmlCmdContent(PageXmlSvcCode,PageXmlSvcCnt,strAssemblyName,strSvcClassName,intAssemblyLoadMode,strHXPageName,strExtendWebPartHtmlId);HXWebJS.Xml.XmlService.SayToServerAsync("HXSM","HXSM_PAGE_XML_SERVICE",xmlCmdContent,ResponseFunction,blnShowErrorMsg)};HXWebJS.Xml.XmlService.CallPageXmlServiceAsyncWithProgressBar=function(PageXmlSvcCode,PageXmlSvcCnt,fnResponseCallback,blnFastOrSlow,strAssemblyName,strSvcClassName,blnShowErrorMsg,intAssemblyLoadMode,strHXPageName,strExtendWebPartHtmlId){if(blnFastOrSlow==null){blnFastOrSlow=true}HXWebJS.Core._InternalFunctions.ShowHideProgressBar(true);var fnTemp=function(strXmlResult){HXWebJS.Core._InternalFunctions.ShowHideProgressBar(false);if(fnResponseCallback!=null){fnResponseCallback(strXmlResult)}};HXWebJS.Xml.XmlService.CallPageXmlServiceAsync(PageXmlSvcCode,PageXmlSvcCnt,fnTemp,strAssemblyName,strSvcClassName,blnShowErrorMsg,intAssemblyLoadMode,strHXPageName,strExtendWebPartHtmlId)};HXWebJS.Xml.XmlService.PageXmlService=function(PageXmlSvcCode,PageXmlSvcCnt,fnResponseCallback,options){if(options==null){options={}}var blnIsAysnc=(options.is_async==true||options.is_async==null);var intAssemblyLoadMode=(options.load_assembly_via_file==false?0:1);var blnShowErrorMsg=(options.show_error_msg==true||options.show_error_msg==null);var strAssemblyName=options.assembly_name;var strAssemblyClassName=options.assembly_class_name;var strHXPageName=options.hx_page_name;var strExtendWebPartHtmlId=options.extend_web_part_html_id;if(!blnIsAysnc){return HXWebJS.Xml.XmlService.CallPageXmlService(PageXmlSvcCode,PageXmlSvcCnt,strAssemblyName,strAssemblyClassName,blnShowErrorMsg,intAssemblyLoadMode,strHXPageName,strExtendWebPartHtmlId)}var blnShowProgressBar=(options.show_progress_bar==true||options.show_progress_bar==null);if(blnShowProgressBar){HXWebJS.Xml.XmlService.CallPageXmlServiceAsyncWithProgressBar(PageXmlSvcCode,PageXmlSvcCnt,fnResponseCallback,true,strAssemblyName,strAssemblyClassName,blnShowErrorMsg,intAssemblyLoadMode,strHXPageName,strExtendWebPartHtmlId)}else{HXWebJS.Xml.XmlService.CallPageXmlServiceAsync(PageXmlSvcCode,PageXmlSvcCnt,fnResponseCallback,strAssemblyName,strAssemblyClassName,blnShowErrorMsg,intAssemblyLoadMode,strHXPageName,strExtendWebPartHtmlId)}};HXWebJS.Xml.XmlService.GetUITextOnServer=function(strTextCode){return HXWebJS.Xml.XmlService.SayToServer("HXSM","HXSM_UTILITY_GET_HXEIMS_CORE_UI_TEXT",strTextCode)};HXWebJS.Xml.XmlService.GetObjectUITextOnServer=function(strObjectCode,strTextCode,strTextSource){if(strObjectCode==null){strObjectCode=""}if(strTextSource==null||strTextSource==""){strTextSource="db"}var sb=new HXWebStringBuilder();sb.append("<RS_DATA><RS_ROW");sb.append(' TEXT_TYPE="object_text"');sb.append(' OBJECT_CODE="'+HXWebJS.Xml.MarkXMLSpecialChars(strObjectCode)+'"');sb.append(' TEXT_CODE="'+HXWebJS.Xml.MarkXMLSpecialChars(strTextCode)+'"');sb.append(' TEXT_SOURCE="'+HXWebJS.Xml.MarkXMLSpecialChars(strTextSource)+'"');sb.append(" /></RS_DATA>");return HXWebJS.Xml.XmlService.SayToServer("HXSM","HXSM_UTILITY_GET_UI_TEXT",sb.toString())};HXWebJS.Xml.XmlService.RegisterParameterValueToServer=function(strParamName1,strParamValue1){var numArgs=arguments.length;if(numArgs<2){alert("调用HXWebJS.Xml.XmlService.RegisterParameterValueToServer()函数时参数数量不足！");return""}var sb_AllParamInfo=new HXWebStringBuilder();sb_AllParamInfo.append("<RS_DATA>");for(var i=0;i<numArgs;i+=2){sb_AllParamInfo.append('<RS_ROW PARAM_NAME="');sb_AllParamInfo.append(HXWebJS.Xml.MarkXMLSpecialChars(arguments[i]).toUpperCase());sb_AllParamInfo.append('" PARAM_VALUE="');sb_AllParamInfo.append(arguments[i+1]==null?"":HXWebJS.Xml.MarkXMLSpecialChars(arguments[i+1]));sb_AllParamInfo.append('" />')}sb_AllParamInfo.append("</RS_DATA>");var strReturnValue=HXWebJS.Xml.XmlService._InternalFunctions._RegisterServerSessionValue("HXPARAM",sb_AllParamInfo.toString(),true);if(strReturnValue==null){return""}return strReturnValue};HXWebJS.Xml.XmlService.AppendParameterValueToServer=function(strParamName1,strParamValue1){var strHXPageParamUUID=HXWebJS.Core.WebPageGlobalVariables._InternalFunctions.GetHXPageParamUUID();HXWebJS.Xml.XmlService._InternalFunctions._AppendParameterValueToServer(strHXPageParamUUID,strParamName1,strParamValue1)};HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray=function(arrParamKeyValues){var numArgs=(arrParamKeyValues==null?0:arrParamKeyValues.length);if(numArgs<2){alert("调用HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray()函数时参数数量不足！");return""}var sb_AllParamInfo=new HXWebStringBuilder();sb_AllParamInfo.append("<RS_DATA>");for(var i=0;i<numArgs;i+=2){sb_AllParamInfo.append('<RS_ROW PARAM_NAME="');sb_AllParamInfo.append(HXWebJS.Xml.MarkXMLSpecialChars(arrParamKeyValues[i]).toUpperCase());sb_AllParamInfo.append('" PARAM_VALUE="');sb_AllParamInfo.append(arrParamKeyValues[i+1]==null?"":HXWebJS.Xml.MarkXMLSpecialChars(arrParamKeyValues[i+1]));sb_AllParamInfo.append('" />')}sb_AllParamInfo.append("</RS_DATA>");var strReturnValue=HXWebJS.Xml.XmlService._InternalFunctions._RegisterServerSessionValue("HXPARAM",sb_AllParamInfo.toString(),true);if(strReturnValue==null){return""}return strReturnValue};HXWebJS.Xml.XmlService.CallObjectXmlService=function(strObjectCode,strObjectXmlSvcCode,strObjectXmlSvcCnt,intUseDefaultProcessForBasicOperation,strObjectXmlSvcAssemblyName,strObjectXmlSvcClassName,strObjectViewCode){var strAssemblyName=(strObjectXmlSvcAssemblyName!=null?strObjectXmlSvcAssemblyName:HXWebPageGlobalVariables._InternalFunctions.GetPageXmlSvcAssemblyName());if(strAssemblyName==null){return null}var strSvcClassName=(strObjectXmlSvcClassName!=null?strObjectXmlSvcClassName:HXWebPageGlobalVariables._InternalFunctions.GetPageXmlSvcClassName());if(strSvcClassName==null){return null}var xmlCmdContent=HXWebJS.Xml.XmlService._InternalFunctions._BuildObjectXmlSvcXmlCmdContent(strObjectCode,strObjectXmlSvcCode,strObjectXmlSvcCnt,intUseDefaultProcessForBasicOperation,strAssemblyName,strSvcClassName,strObjectViewCode);return HXWebJS.Xml.XmlService.SayToServer("HXSM","HXSM_OBJECT_XML_SERVICE",xmlCmdContent)};HXWebJS.Xml.XmlService.CallObjectXmlServiceAsync=function(strObjectCode,strObjectXmlSvcCode,strObjectXmlSvcCnt,intUseDefaultProcessForBasicOperation,ResponseFunction,strObjectXmlSvcAssemblyName,strObjectXmlSvcClassName,strObjectViewCode){var strAssemblyName=(strObjectXmlSvcAssemblyName!=null?strObjectXmlSvcAssemblyName:HXWebPageGlobalVariables._InternalFunctions.GetPageXmlSvcAssemblyName());if(strAssemblyName==null){return null}var strSvcClassName=(strObjectXmlSvcClassName!=null?strObjectXmlSvcClassName:HXWebPageGlobalVariables._InternalFunctions.GetPageXmlSvcClassName());if(strSvcClassName==null){return null}var xmlCmdContent=HXWebJS.Xml.XmlService._InternalFunctions._BuildObjectXmlSvcXmlCmdContent(strObjectCode,strObjectXmlSvcCode,strObjectXmlSvcCnt,intUseDefaultProcessForBasicOperation,strAssemblyName,strSvcClassName,strObjectViewCode);HXWebJS.Xml.XmlService.SayToServerAsync("HXSM","HXSM_OBJECT_XML_SERVICE",xmlCmdContent,ResponseFunction)};HXWebJS.Xml.XmlService.CallObjectXmlServiceAsyncWithProgressBar=function(strObjectCode,strObjectXmlSvcCode,strObjectXmlSvcCnt,intUseDefaultProcessForBasicOperation,fnResponseCallback,blnFastOrSlow,strObjectXmlSvcAssemblyName,strObjectXmlSvcClassName,strObjectViewCode){var strAssemblyName=(strObjectXmlSvcAssemblyName!=null?strObjectXmlSvcAssemblyName:HXWebPageGlobalVariables._InternalFunctions.GetPageXmlSvcAssemblyName());if(strAssemblyName==null){return null}var strSvcClassName=(strObjectXmlSvcClassName!=null?strObjectXmlSvcClassName:HXWebPageGlobalVariables._InternalFunctions.GetPageXmlSvcClassName());if(strSvcClassName==null){return null}if(blnFastOrSlow==null){blnFastOrSlow=true}HXWebJS.Core._InternalFunctions.ShowHideProgressBar(true);var fnTemp=function(strXmlResult){HXWebJS.Core._InternalFunctions.ShowHideProgressBar(false);if(fnResponseCallback!=null){fnResponseCallback(strXmlResult)}};HXWebJS.Xml.XmlService.CallObjectXmlServiceAsync(strObjectCode,strObjectXmlSvcCode,strObjectXmlSvcCnt,intUseDefaultProcessForBasicOperation,fnTemp,strAssemblyName,strSvcClassName,strObjectViewCode)};HXWebJS.Xml.XmlService._InternalFunctions._HXBOD205_Build=function(SubsystemID,XMLCmdCode,xmlCmdContent){var sb_xmlcmd_content=new HXWebStringBuilder();sb_xmlcmd_content.append("<HXBOD205><CNTROLAREA><SYSTEM/>");sb_xmlcmd_content.append("<SUBSYSTEM>"+SubsystemID+"</SUBSYSTEM>");sb_xmlcmd_content.append("<TASK>"+XMLCmdCode+"</TASK>");sb_xmlcmd_content.append("<HX_PAGE_NAME>"+HXWebPageGlobalVariables.CurrentPageName+"</HX_PAGE_NAME>");sb_xmlcmd_content.append("</CNTROLAREA><DATAAREA>");sb_xmlcmd_content.append(xmlCmdContent);sb_xmlcmd_content.append("</DATAAREA></HXBOD205>");return sb_xmlcmd_content.toString()};HXWebJS.Xml.XmlService._InternalFunctions._HXBOD205_ErrorHandle=function(xmldoc,blnShowErrorMsg){if(blnShowErrorMsg==null){blnShowErrorMsg=true}var objHXXmlDoc=new HXWebJS.Xml.HXXmlDocument(xmldoc);var status=objHXXmlDoc.SelectSingleNode("/HXBOD205_CONFIRM/STATUSLVL").GetText();var msg=objHXXmlDoc.SelectSingleNode("/HXBOD205_CONFIRM/DESCRIPTN").GetText();var result=objHXXmlDoc.SelectSingleNode("/HXBOD205_CONFIRM/CONFIRM_DATA").GetText();var strExtraData=objHXXmlDoc.SelectSingleNode("/HXBOD205_CONFIRM/ERROR_CODE").GetText();var strExitCategory=objHXXmlDoc.SelectSingleNode("/HXBOD205_CONFIRM/ERROR_SOURCE").GetText();if(status==0){return(result)}if(status==1){if(strExtraData!=null&&strExtraData!=""){var obj=new Object();obj.value=result;obj.message=msg;obj.extra_data=strExtraData;obj.exit_data=result;obj.exit_category=strExitCategory;return obj}else{if(result=="hxwww_warning_msg__xmlservice_no_active_session"){if(typeof(HXWebDynamicPageJSExt)!="undefined"&&HXWebDynamicPageJSExt!=null&&HXWebDynamicPageJSExt.OnXmlServiceNoActiveSession!=null){HXWebDynamicPageJSExt.OnXmlServiceNoActiveSession(msg);return null}result=null}}if(blnShowErrorMsg&&msg!=""){HXWebJS.Core.AlertWithReplaceCrLfString(msg)}return(result)}if(status==2){if(blnShowErrorMsg){HXWebJS.Core.AlertWithReplaceCrLfString(msg)}return(null)}if(status==3){if(blnShowErrorMsg){HXWebJS.Core.AlertWithReplaceCrLfString("error happened. "+msg)}return(null)}};HXWebJS.Xml.XmlService._InternalFunctions._GetResponseProcessHandlerFunction=function(httpOb,ResponseFunction,blnShowErrorMsg){return function(){if(httpOb.readyState!=4){return}if(HXWebJS==null||HXWebJS.Xml==null){return}var objHXXmlDoc=new HXWebJS.Xml.HXXmlDocument(httpOb.responseXML);if(objHXXmlDoc==null||objHXXmlDoc.GetXml()==""){var strTempResponseText=httpOb.responseText;var intBeginIndex_FriendMsgString=strTempResponseText.indexOf("trusthx_app_offline_html_page_flag__used_for_hxxmlservice_friend_notice");if(intBeginIndex_FriendMsgString!=-1){intBeginIndex_FriendMsgString=strTempResponseText.indexOf(">",intBeginIndex_FriendMsgString+1);if(intBeginIndex_FriendMsgString==-1){HXWebJS.Core.AlertWithReplaceCrLfString(strTempResponseText)}else{var intEndIndex_FriendMsgString=strTempResponseText.indexOf("</span>",intBeginIndex_FriendMsgString+1);var strMsgText=(intEndIndex_FriendMsgString==-1?strTempResponseText.substr(intBeginIndex_FriendMsgString+1):strTempResponseText.substring(intBeginIndex_FriendMsgString+1,intEndIndex_FriendMsgString));strMsgText=strMsgText.replace(/<br \/>/g,"\r\n");HXWebJS.Core.AlertWithReplaceCrLfString(strMsgText)}}if(ResponseFunction!=null){ResponseFunction(null)}return}var strReturnValue=HXWebJS.Xml.XmlService._InternalFunctions._HXBOD205_ErrorHandle(httpOb.responseXML,blnShowErrorMsg);if(ResponseFunction!=null){ResponseFunction(strReturnValue)}}};HXWebJS.Xml.XmlService._InternalFunctions._BuildPageXmlSvcXmlCmdContent=function(PageXmlSvcCode,PageXmlSvcCnt,PageXmlSvcAssemblyName,PageXmlSvcClassName,intAssemblyLoadMode,strHXPageName,strExtendWebPartHtmlId){var strHXPageParamUUID="";if(typeof(mstrHXPageParamUUID)=="string"){strHXPageParamUUID=mstrHXPageParamUUID}if(strHXPageName==null){strHXPageName=HXWebPageGlobalVariables.CurrentPageName}if(strExtendWebPartHtmlId==null){strExtendWebPartHtmlId=""}if(PageXmlSvcCnt==null){PageXmlSvcCnt=""}if(intAssemblyLoadMode==null){intAssemblyLoadMode=0}var sb_xmlcmd=new HXWebStringBuilder();sb_xmlcmd.append('<PAGE_XML_SERVICE ASSEMBLY="'+HXWebJS.Xml.MarkXMLSpecialChars(PageXmlSvcAssemblyName)+'"');sb_xmlcmd.append(' CLASS_NAME="'+HXWebJS.Xml.MarkXMLSpecialChars(PageXmlSvcClassName)+'"');sb_xmlcmd.append(' ASSEMBLY_LOAD_MODE="'+intAssemblyLoadMode.toString()+'"');sb_xmlcmd.append(' HX_PAGE_NAME="'+HXWebJS.Xml.MarkXMLSpecialChars(strHXPageName)+'"');sb_xmlcmd.append(' HX_PAGE_PARAM_UUID="'+HXWebJS.Xml.MarkXMLSpecialChars(strHXPageParamUUID)+'"');sb_xmlcmd.append(' PAGE_XML_SERVICE_CODE="'+HXWebJS.Xml.MarkXMLSpecialChars(PageXmlSvcCode)+'"');sb_xmlcmd.append(' EXTEND_WEBPART_HTML_ID="'+HXWebJS.Xml.MarkXMLSpecialChars(strExtendWebPartHtmlId)+'"');sb_xmlcmd.append(" >");sb_xmlcmd.append(HXWebJS.Xml.MarkXMLSpecialChars(PageXmlSvcCnt));sb_xmlcmd.append("</PAGE_XML_SERVICE>");return sb_xmlcmd.toString()};HXWebJS.Xml.XmlService._InternalFunctions._BuildObjectXmlSvcXmlCmdContent=function(ObjectCode,ObjectXmlSvcCode,ObjectXmlSvcCnt,intUseDefaultProcessForBasicOperation,ObjectXmlSvcAssemblyName,ObjectXmlSvcClassName,strObjectViewCode){var strHXPageParamUUID="";if(typeof(mstrHXPageParamUUID)=="string"){strHXPageParamUUID=mstrHXPageParamUUID}var strHXPageName=HXWebPageGlobalVariables.CurrentPageName;if(strObjectViewCode==null){strObjectViewCode=""}if(ObjectXmlSvcCode==null){ObjectXmlSvcCode=""}if(intUseDefaultProcessForBasicOperation==null){intUseDefaultProcessForBasicOperation=1}var sb_xmlcmd=new HXWebStringBuilder();sb_xmlcmd.append('<OBJECT_XML_SERVICE ASSEMBLY="');sb_xmlcmd.append(HXWebJS.Xml.MarkXMLSpecialChars(ObjectXmlSvcAssemblyName));sb_xmlcmd.append('" CLASS_NAME="');sb_xmlcmd.append(HXWebJS.Xml.MarkXMLSpecialChars(ObjectXmlSvcClassName));sb_xmlcmd.append('" HX_PAGE_NAME="');sb_xmlcmd.append(HXWebJS.Xml.MarkXMLSpecialChars(strHXPageName));sb_xmlcmd.append('" HX_PAGE_PARAM_UUID="');sb_xmlcmd.append(HXWebJS.Xml.MarkXMLSpecialChars(strHXPageParamUUID));sb_xmlcmd.append('" OBJECT_CODE="');sb_xmlcmd.append(HXWebJS.Xml.MarkXMLSpecialChars(ObjectCode));sb_xmlcmd.append('" OBJECT_VIEW_CODE="');sb_xmlcmd.append(HXWebJS.Xml.MarkXMLSpecialChars(strObjectViewCode));sb_xmlcmd.append('" OBJECT_XML_SERVICE_CODE="');sb_xmlcmd.append(HXWebJS.Xml.MarkXMLSpecialChars(ObjectXmlSvcCode));sb_xmlcmd.append('" USE_DEFAULT_PROCESS_FOR_BASIC_OPERATION="');sb_xmlcmd.append(HXWebJS.Xml.MarkXMLSpecialChars(intUseDefaultProcessForBasicOperation));sb_xmlcmd.append('" >');sb_xmlcmd.append(HXWebJS.Xml.MarkXMLSpecialChars(ObjectXmlSvcCnt));sb_xmlcmd.append("</OBJECT_XML_SERVICE>");return sb_xmlcmd.toString()};HXWebJS.Xml.XmlService._InternalFunctions._AppendParameterValueToServer=function(strHXPageParamUUID,strParamName1,strParamValue1){var numArgs=arguments.length;if(numArgs<3){alert("调用_AppendParameterValueToServer()函数时传递的参数数量不足！");return""}var sb_AllParamInfo=new HXWebStringBuilder();sb_AllParamInfo.append("<RS_DATA>");for(var i=1;i<numArgs;i+=2){sb_AllParamInfo.append('<RS_ROW PARAM_NAME="');sb_AllParamInfo.append(HXWebJS.Xml.MarkXMLSpecialChars(arguments[i]).toUpperCase());sb_AllParamInfo.append('" PARAM_VALUE="');sb_AllParamInfo.append(arguments[i+1]==null?"":HXWebJS.Xml.MarkXMLSpecialChars(arguments[i+1]));sb_AllParamInfo.append('" />')}sb_AllParamInfo.append("</RS_DATA>");var strAllXmlData=HXWebJS.Xml.BuildAllXmlDatas("hx_page_param_uuid",strHXPageParamUUID,"appended_param_values",sb_AllParamInfo.toString());var strReturnValue=HXWebJS.Xml.XmlService.SayToServer("HXSM","HXSM_UTILITY_APPEND_SERVER_PARAMETER_VALUE",strAllXmlData);if(strReturnValue==null){return""}return strReturnValue};HXWebJS.Xml.XmlService._InternalFunctions._RemoveParameterValueToServer=function(strHXPageParamUUID,strParamName1){var numArgs=arguments.length;if(numArgs<2){alert("调用_RemoveParameterValueToServer()函数时传递的参数数量不足！");return""}var sb_AllParamInfo=new HXWebStringBuilder();sb_AllParamInfo.append("<RS_DATA>");for(var i=1;i<numArgs;i++){sb_AllParamInfo.append('<RS_ROW PARAM_NAME="');sb_AllParamInfo.append(HXWebJS.Xml.MarkXMLSpecialChars(arguments[i]).toUpperCase());sb_AllParamInfo.append('" />')}sb_AllParamInfo.append("</RS_DATA>");var strAllXmlData=HXWebJS.Xml.BuildAllXmlDatas("hx_page_param_uuid",strHXPageParamUUID,"removed_param_name",sb_AllParamInfo.toString());var strReturnValue=HXWebJS.Xml.XmlService.SayToServer("HXSM","HXSM_UTILITY_REMOVE_SERVER_PARAMETER_VALUE",strAllXmlData);if(strReturnValue==null){return""}return strReturnValue};HXWebJS.Xml.XmlService._InternalFunctions._RegisterServerSessionValue=function(strSessionVariableName,strVariableValue,blnIsCreateSuffix){strSessionVariableName=HXWebJS.Xml.MarkXMLSpecialChars(strSessionVariableName);strVariableValue=HXWebJS.Xml.MarkXMLSpecialChars(strVariableValue);var intIsCreateSuffix;if(blnIsCreateSuffix==null||blnIsCreateSuffix!=true){intIsCreateSuffix=0}else{intIsCreateSuffix=1}var sb_Xml=new HXWebStringBuilder();sb_Xml.append('<RS_ROW VARIABLE_NAME="');sb_Xml.append(strSessionVariableName);sb_Xml.append('" VARIABLE_VALUE="');sb_Xml.append(strVariableValue);sb_Xml.append('" IS_CREATE_SUFFIX="');sb_Xml.append(intIsCreateSuffix.toString());sb_Xml.append('" />');var xmlresult=HXWebJS.Xml.XmlService.SayToServer("HXSM","HXSM_UTILITY_REGISTER_SERVER_SESSION_VALUE",sb_Xml.toString());return(xmlresult)};HXWebJS.Xml._XmlDataIsland={};HXWebJS.Xml._XmlDataIsland._gblnDataHasChanged=false;HXWebJS.Xml._XmlDataIsland._onload_binding_process=function(){if(HXWebJS.Xml._XmlDataIsland._onloadprocess_before_binding!=null){HXWebJS.Xml._XmlDataIsland._onloadprocess_before_binding()}var blnIsIE=HXWebJS.Core.Browser.IsIE&&parseFloat(HXWebJS.Core.Browser.Version)<10;if(!blnIsIE){if(HXWebJS.Xml._XmlDataIsland._table_tbody_row_template_cache==null){HXWebJS.Xml._XmlDataIsland._table_tbody_row_template_cache={}}HXWebJS.Xml._XmlDataIsland._onload_binding_process_for_normal_element(document.body);HXWebJS.EventManager.AddListener(document.body,"change",HXWebJS.Xml._XmlDataIsland._binding_element_onchanged_process);HXWebJS.EventManager.AddListener(document.body,"click",HXWebJS.Xml._XmlDataIsland._binding_element_onchanged_process)}else{HXWebJS.Xml._XmlDataIsland._HideTemplateLineOfEmptyXmlDataIslandAndCallBindingFinishedCallback();HXWebJS.EventManager.AddListener(document.body,"afterupdate",HXWebJS.Xml._XmlDataIsland._mark_binding_element_data_has_changed_process)}};HXWebJS.Xml._XmlDataIsland._onload_binding_process_for_normal_element=function(element,strSpecifiedXmlDataIslandName){if(!element){element=document.body}else{if(typeof element=="string"){element=document.getElementById(element)}}strSpecifiedXmlDataIslandName=(strSpecifiedXmlDataIslandName==null?"":strSpecifiedXmlDataIslandName.toLowerCase());var strDataSrcName=element.getAttribute("datasrc");var strDataFldName=element.getAttribute("datafld");var strElementTagName=element.tagName.toLowerCase();var blnElementIsBindingData=false;var strXmlDataIslandName;var objHXXmlDoc,objHXXmlNode;if(strDataSrcName!=null&&strDataSrcName!=""&&strDataSrcName.substr(0,1)=="#"){strXmlDataIslandName=strDataSrcName.substr(1).toLowerCase();if(strSpecifiedXmlDataIslandName!=""&&strSpecifiedXmlDataIslandName!=strXmlDataIslandName){blnElementIsBindingData=false}else{if(document.getElementById(strXmlDataIslandName)==null){objHXXmlDoc=null}else{objHXXmlDoc=HXWebJS.Xml.GetHXXmlDocumentViaXmlDataIsland(strXmlDataIslandName)}if(objHXXmlDoc!=null){if(strElementTagName=="table"){blnElementIsBindingData=true}else{if(strDataFldName!=null&&strDataFldName!=""){objHXXmlNode=objHXXmlDoc.SelectSingleNode("//RS_DATA//RS_ROW/@"+strDataFldName.toUpperCase());if(objHXXmlNode!=null){blnElementIsBindingData=true}}}}}}if(blnElementIsBindingData==true){if(strElementTagName=="table"){HXWebJS.Xml._XmlDataIsland._binding_process_for_table_element(strDataSrcName,objHXXmlDoc.GetRootXmlNode(),element,1,strSpecifiedXmlDataIslandName)}else{var strXmlNodeValue=objHXXmlNode.GetText();if(strXmlNodeValue==null){strXmlNodeValue=""}HXWebJS.Xml._XmlDataIsland._set_bind_value(element,strElementTagName,strXmlNodeValue)}return}var i;if(blnElementIsBindingData==false){var kids=[];for(i=0;i<element.childNodes.length;i++){var c=element.childNodes[i];if(c.nodeType==1){kids.push(element.childNodes[i])}}for(i=0;i<kids.length;i++){HXWebJS.Xml._XmlDataIsland._onload_binding_process_for_normal_element(kids[i],strSpecifiedXmlDataIslandName)}return}};HXWebJS.Xml._XmlDataIsland._binding_table_template_cache_process=function(objTable){if(objTable==null){return null}var strTableElementId=objTable.id;if(strTableElementId==null||strTableElementId==""){return null}var objTemplateElementForTBody=HXWebJS.Xml._XmlDataIsland._table_tbody_row_template_cache[strTableElementId];if(objTemplateElementForTBody!=null){return objTemplateElementForTBody}var tempChildNodesOfTable=objTable.childNodes;if(tempChildNodesOfTable==null){return null}for(var i=0;i<tempChildNodesOfTable.length;i++){var tempChildNode=tempChildNodesOfTable[i];var tempNodeName=tempChildNode.nodeName.toLowerCase();if(tempNodeName=="tbody"){objTemplateElementForTBody=tempChildNode.cloneNode(true);HXWebJS.Xml._XmlDataIsland._table_tbody_row_template_cache[strTableElementId]=objTemplateElementForTBody;return objTemplateElementForTBody}}return null};HXWebJS.Xml._XmlDataIsland._binding_process_for_table_element=function(strDataSrcName,objXmlNodeForTable,element,intBindingLevel,strSpecifiedXmlDataIslandName){var strTableElementId=element.id;if(strTableElementId==null){strTableElementId=""}var objTemplateElementForTBody=HXWebJS.Xml._XmlDataIsland._table_tbody_row_template_cache[strTableElementId];var objTempElementForTBody;var tempChildNodesOfTable=element.childNodes;if(tempChildNodesOfTable==null){return}var i;for(i=tempChildNodesOfTable.length-1;i>=0;i--){var tempChildNode=tempChildNodesOfTable[i];var tempNodeName=tempChildNode.nodeName.toLowerCase();if(tempNodeName=="thead"||tempNodeName=="tfoot"){HXWebJS.Xml._XmlDataIsland._onload_binding_process_for_normal_element(tempChildNode,strSpecifiedXmlDataIslandName)}if(tempNodeName=="tbody"){if(objTemplateElementForTBody==null){objTemplateElementForTBody=tempChildNode.cloneNode(true);if(strTableElementId!=""){HXWebJS.Xml._XmlDataIsland._table_tbody_row_template_cache[strTableElementId]=objTemplateElementForTBody}}element.removeChild(tempChildNode)}}if(objXmlNodeForTable==null){return}if(objTemplateElementForTBody!=null){var objXmlNodesForHtmlRows;var strDataFldName=element.getAttribute("datafld");if(strDataFldName==null||strDataFldName==""){objXmlNodesForHtmlRows=objXmlNodeForTable.SelectNodes("//RS_ROW")}else{objXmlNodesForHtmlRows=objXmlNodeForTable.SelectNodes(".//"+strDataFldName.toUpperCase())}var container=element;element.setAttribute("hx_binding_level",intBindingLevel);for(i=0;i<objXmlNodesForHtmlRows.length;i++){var copy=objTemplateElementForTBody.cloneNode(true);copy.setAttribute("hx_binding_line_no",i);HXWebJS.Xml._XmlDataIsland._expand_single_table_row_process(strDataSrcName,objXmlNodesForHtmlRows[i],copy,i+1,intBindingLevel,strSpecifiedXmlDataIslandName);container.appendChild(copy)}if(intBindingLevel==1){HXWebJS.Xml._XmlDataIsland._call__webdatalist__after_data_row_rebinding_func(element,objXmlNodesForHtmlRows)}}};HXWebJS.Xml._XmlDataIsland._expand_single_table_row_process=function(strDataSrcName,xmlDataNode,element,lineNo,intBindingLevel,strSpecifiedXmlDataIslandName){var strTempDataSrcName,strDataFldName;var strElementTagName;for(var c=element.firstChild;c!=null;c=c.nextSibling){if(c.nodeType!=1){continue}strTempDataSrcName=c.getAttribute("datasrc");strDataFldName=c.getAttribute("datafld");if(strDataFldName==null){strDataFldName=""}strElementTagName=c.tagName.toLowerCase();if(strElementTagName=="table"){if(strTempDataSrcName==null||strTempDataSrcName==""){HXWebJS.Xml._XmlDataIsland._expand_single_table_row_process(strDataSrcName,xmlDataNode,c,lineNo,intBindingLevel,strSpecifiedXmlDataIslandName)}else{if(strTempDataSrcName!=strDataSrcName){HXWebJS.Xml._XmlDataIsland._onload_binding_process_for_normal_element(c)}else{if(strDataFldName==null||strDataFldName==""){HXWebJS.Xml._XmlDataIsland._expand_single_table_row_process(strDataSrcName,xmlDataNode,c,lineNo,intBindingLevel,strSpecifiedXmlDataIslandName)}else{HXWebJS.Xml._XmlDataIsland._binding_process_for_table_element(strDataSrcName,xmlDataNode,c,intBindingLevel+1,strSpecifiedXmlDataIslandName)}}}}else{if(strDataFldName==null||strDataFldName==""){HXWebJS.Xml._XmlDataIsland._expand_single_table_row_process(strDataSrcName,xmlDataNode,c,lineNo,intBindingLevel,strSpecifiedXmlDataIslandName)}else{if(strTempDataSrcName==null||strTempDataSrcName==""||strTempDataSrcName==strDataSrcName){var objXmlNode=xmlDataNode.SelectSingleNode("@"+strDataFldName.toUpperCase());if(objXmlNode==null){continue}var strXmlNodeValue=objXmlNode.GetText();HXWebJS.Xml._XmlDataIsland._set_bind_value(c,strElementTagName,strXmlNodeValue)}else{HXWebJS.Xml._XmlDataIsland._onload_binding_process_for_normal_element(c)}}}}};HXWebJS.Xml._XmlDataIsland._HideTemplateLineOfEmptyXmlDataIslandAndCallBindingFinishedCallback=function(strSpecifiedXmlDataIslandName,blnRebindingTable){strSpecifiedXmlDataIslandName=(strSpecifiedXmlDataIslandName==null?"":strSpecifiedXmlDataIslandName.toLowerCase());if(blnRebindingTable==null){blnRebindingTable=false}var objXmlDataIslandList;if(strSpecifiedXmlDataIslandName!=""){var objTemp=HXWebJS.DOM.GetElementById(strSpecifiedXmlDataIslandName);objXmlDataIslandList=(objTemp==null?[]:[objTemp])}else{objXmlDataIslandList=HXWebJS.DOM.FindElementsByTagName("xml")}var objXmlDataIslandIDListForEmpty=[];var objXmlDataIslandIDListWithData=[];var objTempHXXmlDoc;var strTemp,strXmlDataIslandId;for(var i=0;i<objXmlDataIslandList.length;i++){strXmlDataIslandId=objXmlDataIslandList[i].id;if(document.getElementById(strXmlDataIslandId)==null){objTempHXXmlDoc=null}else{objTempHXXmlDoc=HXWebJS.Xml.GetHXXmlDocumentViaXmlDataIsland(strXmlDataIslandId)}strTemp=(objTempHXXmlDoc==null?null:objTempHXXmlDoc.GetXml());if(strTemp==null||strTemp==""||strTemp.indexOf("<RS_ROW")==-1){objXmlDataIslandIDListForEmpty.push(strXmlDataIslandId)}else{objXmlDataIslandIDListWithData.push(strXmlDataIslandId)}}var objTempTables=HXWebJS.DOM.FindElementsByTagName("table");var objTempTables_WidthBindingDataSrc=[];if(objTempTables!=null){var strTempAttributeValue;for(var i=0;i<objTempTables.length;i++){strTempAttributeValue=HXWebJS.DOM.ElementAttributeGetValue(objTempTables[i],"datasrc");if(strTempAttributeValue!=null&&strTempAttributeValue!=""&&strTempAttributeValue.substring(0,1)=="#"){objTempTables_WidthBindingDataSrc.push(objTempTables[i])}}}for(var i=0;i<objXmlDataIslandIDListForEmpty.length;i++){var objBindingTablesList=HXWebJS.DOM.FindElementsByAttribute("datasrc","#"+objXmlDataIslandIDListForEmpty[i],"table",objTempTables_WidthBindingDataSrc);for(j=0;j<objBindingTablesList.length;j++){var objTempTable=objBindingTablesList[j];if(objTempTable.tBodies.length>0){objTempTable.tBodies[0].style.display="none"}}}var strTemp;for(var i=0;i<objXmlDataIslandIDListWithData.length;i++){var objBindingTablesList=HXWebJS.DOM.FindElementsByAttribute("datasrc","#"+objXmlDataIslandIDListWithData[i],"table",objTempTables_WidthBindingDataSrc);for(j=0;j<objBindingTablesList.length;j++){var objTempTable=objBindingTablesList[j];strTemp=HXWebJS.DOM.ElementAttributeGetValue(objTempTable,"datafld");if(strTemp==null||strTemp==""){if(blnRebindingTable){objTempTable.dataSrc="";objTempTable.dataSrc="#"+objXmlDataIslandIDListWithData[i];objTempTable.refresh()}HXWebJS.Xml._XmlDataIsland._check_table_binding_finish_and_run_callback_func(objTempTable,HXWebJS.Xml.GetHXXmlDocumentViaXmlDataIsland(objXmlDataIslandIDListWithData[i]))}}}};HXWebJS.Xml._XmlDataIsland._set_bind_value=function(element,strElementTagName,strXmlNodeValue){if(strElementTagName=="input"){var strInputType=element.type;if(strInputType==null){strInputType="text"}strInputType=strInputType.toLowerCase();if(strInputType=="checkbox"){element.checked=(strXmlNodeValue==null||strXmlNodeValue==""||strXmlNodeValue=="0"?false:true)}else{if(strInputType=="radio"){if(element.value==strXmlNodeValue){element.checked=true}else{element.checked=false}}else{element.value=strXmlNodeValue}}return}if(strElementTagName=="select"){element.value=strXmlNodeValue;return}if(strElementTagName=="textarea"){element.value=strXmlNodeValue;return}if(strElementTagName=="span"||strElementTagName=="div"||strElementTagName=="button"||strElementTagName=="label"||strElementTagName=="legend"||strElementTagName=="marquee"){HXWebJS.DOM.ElementSetInnerText(element,strXmlNodeValue);return}if(strElementTagName=="a"){element.href=strXmlNodeValue;return}if(strElementTagName=="frame"||strElementTagName=="iframe"||strElementTagName=="img"){element.src=strXmlNodeValue;return}};HXWebJS.Xml._XmlDataIsland._check_table_binding_finish_and_run_callback_func=function(objtable,objHXXmlDoc){var objHXXmlNodeList=objHXXmlDoc.SelectNodes("//RS_ROW");if(objtable.tBodies.length==objHXXmlNodeList.length){HXWebJS.Xml._XmlDataIsland._call__webdatalist__after_data_row_rebinding_func(objtable,objHXXmlNodeList)}else{var fn=HXWebJS.Core.CreateDelegateFunction(this,HXWebJS.Xml._XmlDataIsland._check_table_binding_finish_and_run_callback_func,objtable,objHXXmlDoc);window.setTimeout(fn,200)}};HXWebJS.Xml._XmlDataIsland._call__webdatalist__after_data_row_rebinding_func=function(objtable,objHXXmlNodeList){var strFuncNameForDataRowRebinding=HXWebJS.DOM.ElementAttributeGetValue(objtable,"hx_customized_row_rebinding_func");if(strFuncNameForDataRowRebinding==null||strFuncNameForDataRowRebinding==""){strFuncNameForDataRowRebinding="hxfn_callback_webdatalist__after_data_row_rebinding"}else{if(strFuncNameForDataRowRebinding.toLowerCase()=="none"){return}}var blnIsCallbackExist_AfterRowRebinding=HXWebJS.Core._InternalFunctions.IsJavascriptFunctionDefined(strFuncNameForDataRowRebinding);var fnCallbackDataRowRebinding=(blnIsCallbackExist_AfterRowRebinding?eval(strFuncNameForDataRowRebinding):null);for(var i=0;i<objtable.tBodies.length;i++){objtable.tBodies[i].style.display="";if(typeof(HXWebEditPageHelper)!="undefined"&&HXWebEditPageHelper._InternalFunctions!=null){if(HXWebEditPageHelper._InternalFunctions._registered_metadata_info!=null&&HXWebEditPageHelper._InternalFunctions._registered_metadata_info.ignore_predefined_display_format_process!=true){HXWebEditPageHelper._InternalFunctions._child_object_table__single_row__display_format_process(objtable,i,objtable.tBodies[i],objHXXmlNodeList[i])}}if(blnIsCallbackExist_AfterRowRebinding&&objtable.id!="hxwebdatacontrol_global_datalist_table"){try{fnCallbackDataRowRebinding(objtable.id,i,objtable.tBodies[i],objHXXmlNodeList[i])}catch(ex){alert(strFuncNameForDataRowRebinding+"()函数调用失败。网络速度慢时可能引发该错误。请稍候重新刷新页面后再试。参考信息： "+(ex.description!=null?ex.description:ex))}}}var blnIsCallbackExist_AfterTableBindingFinished=HXWebJS.Core._InternalFunctions.IsJavascriptFunctionDefined("hxfn_callback_webdatalist__after_table_binding_finished");if(blnIsCallbackExist_AfterTableBindingFinished){try{hxfn_callback_webdatalist__after_table_binding_finished(objtable.id)}catch(ex){alert("hxfn_callback_webdatalist__after_table_binding_finished()函数调用失败。错误详情： "+(ex.description!=null?ex.description:ex))}}};HXWebJS.Xml._XmlDataIsland._call__webdatalist__after_data_row_rebinding_func_one_line=function(objTBody,lineNo,objHXXmlNode){if(objTBody==null){return}var objtable=objTBody.parentNode;objTBody.style.display="";if(typeof(HXWebEditPageHelper)!="undefined"){HXWebEditPageHelper._InternalFunctions._child_object_table__single_row__display_format_process(objtable,lineNo,objTBody,objHXXmlNode)}var fnCallbackDataRowRebinding;var strFuncNameForDataRowRebinding=HXWebJS.DOM.ElementAttributeGetValue(objtable,"hx_customized_row_rebinding_func");if(strFuncNameForDataRowRebinding==null||strFuncNameForDataRowRebinding==""){strFuncNameForDataRowRebinding="hxfn_callback_webdatalist__after_data_row_rebinding"}else{if(strFuncNameForDataRowRebinding.toLowerCase()=="none"){return}}if(!HXWebJS.Core._InternalFunctions.IsJavascriptFunctionDefined(strFuncNameForDataRowRebinding)){return}var fnCallbackDataRowRebinding=eval(strFuncNameForDataRowRebinding);if(objtable.id=="hxwebdatacontrol_global_datalist_table"){return}try{fnCallbackDataRowRebinding(objtable.id,lineNo,objTBody,objHXXmlNode)}catch(ex){alert(strFuncNameForDataRowRebinding+"()函数调用失败。网络速度慢时可能引发该错误。请稍候重新刷新页面后再试。参考信息："+(ex.description!=null?ex.description:ex))}};HXWebJS.Xml._XmlDataIsland._binding_element_onchanged_process=function(objEventData){if(objEventData.type=="click"){var strTempTagName=objEventData.target.tagName.toUpperCase();if(strTempTagName!="INPUT"){return}var strTempInputType=objEventData.target.type.toLowerCase();if(strTempInputType!="checkbox"&&strTempInputType!="radio"){return}if(objEventData.target.disabled==true){return}}var objBindingProcessInfo=HXWebJS.Xml._XmlDataIsland._binding_element_onchanged_xmldataisland_update(objEventData.target,objEventData.type);HXWebJS.EventManager.FireEvent(objEventData.target,"afterupdate");if(objBindingProcessInfo!=null){var arrFuncList=HXWebJS.EventManager.GetRegistedCallbackFuncList("hxxmldataisland_onbindingvaluechanged");if(arrFuncList!=null&&arrFuncList.length>0){for(var i=0;i<arrFuncList.length;i++){arrFuncList[i](objBindingProcessInfo)}}}};HXWebJS.Xml._XmlDataIsland._binding_element_onchanged_xmldataisland_update=function(objElement,strEventType){var arrBindingElementData=HXWebJS.Xml._XmlDataIsland._get_input_element_binding_value(objElement,strEventType);if(arrBindingElementData==null){return}var strBindingDataSrcName=arrBindingElementData[0];if(strBindingDataSrcName!=null&&strBindingDataSrcName!=""&&strBindingDataSrcName.substr(0,1)=="#"){strBindingDataSrcName=strBindingDataSrcName.substr(1)}var strAttributeName=arrBindingElementData[1].toUpperCase();var strInputElementValue=arrBindingElementData[2];var intBindingLevel=parseInt(arrBindingElementData[3]);var strRecordNumber=arrBindingElementData[4];var strBindingListDataFldName=arrBindingElementData[5];var strUpLevelRecordNumber=arrBindingElementData[6];var objHXXmlDoc=null;if(document.getElementById(strBindingDataSrcName)!=null){objHXXmlDoc=HXWebJS.Xml.GetHXXmlDocumentViaXmlDataIsland(strBindingDataSrcName)}if(objHXXmlDoc==null){return}var blnIsIE10orLess=HXWebJS.Core.Browser.IsIE;var blnIsIE11=HXWebJS.Core.Browser.IsIE11;var strXPathText;if(intBindingLevel==0){strXPathText="//RS_ROW"}else{if(intBindingLevel==1){strXPathText="//RS_ROW["+(parseInt(strRecordNumber)-(blnIsIE10orLess||blnIsIE11?1:0))+"]"}else{if(intBindingLevel==2){strXPathText="//RS_ROW["+(parseInt(strUpLevelRecordNumber)-(blnIsIE10orLess||blnIsIE11?1:0))+"]/"+strBindingListDataFldName.toUpperCase()+"["+(parseInt(strRecordNumber)-(blnIsIE10orLess||blnIsIE11?1:0))+"]"}else{return}}}var objHXXmlNode=objHXXmlDoc.SelectSingleNode(strXPathText);if(objHXXmlNode==null){return}var strBindingFieldOldValue=objHXXmlNode.GetText();objHXXmlNode._SetAttributeValueOnly(strAttributeName,strInputElementValue);var arrBindingAttributeRefData=[intBindingLevel,strRecordNumber,strBindingListDataFldName,strUpLevelRecordNumber];HXWebJS.Xml._XmlDataIsland._update_binding_elements_value(objHXXmlNode,strAttributeName,strInputElementValue,objElement,arrBindingAttributeRefData);HXWebJS.Xml._XmlDataIsland._gblnDataHasChanged=true;var intBindingLineNo=(strRecordNumber==null?0:parseInt(strRecordNumber)-1);var objBindingProcessInfo={dataisland_id:strBindingDataSrcName.substr(1),binding_line_no:intBindingLineNo,field_code:strAttributeName,field_value:strInputElementValue,old_field_value:strBindingFieldOldValue,trigger_mode:"interactive_input",trigger_element:objElement};return objBindingProcessInfo};HXWebJS.Xml._XmlDataIsland._mark_binding_element_data_has_changed_process=function(objEventData){HXWebJS.Xml._XmlDataIsland._gblnDataHasChanged=true};HXWebJS.Xml._XmlDataIsland._MarkDataHasChanged=function(blnDataHasChanged){if(blnDataHasChanged==null){blnDataHasChanged=true}HXWebJS.Xml._XmlDataIsland._gblnDataHasChanged=blnDataHasChanged};HXWebJS.Xml._XmlDataIsland._HasAnyXmlDataChanged=function(){return HXWebJS.Xml._XmlDataIsland._gblnDataHasChanged};HXWebJS.Xml._XmlDataIsland._GetElementBindingLineTBody=function(element){var objTemp=element;var strTemp;while(objTemp!=null){if(objTemp.tagName!=null&&objTemp.tagName.toLowerCase()=="tbody"){strTemp=objTemp.getAttribute("hx_binding_line_no");if(strTemp!=null&&strTemp!=""){return objTemp}}objTemp=objTemp.parentNode}return null};HXWebJS.Xml._XmlDataIsland._get_input_element_binding_value=function(element,eventType){if(element==null){return}var strDataSrcName,strDataFldName;var intBindingLevel;var intRecordNumber;var strBindingListDataFldName;var intRecordNumberOfUpLevel;var strInputElementValue;strDataFldName=HXWebJS.DOM.ElementAttributeGetValue(element,"datafld");if(strDataFldName==null||strDataFldName==""){return null}strDataSrcName=HXWebJS.DOM.ElementAttributeGetValue(element,"datasrc");if(strDataSrcName!=null&&strDataSrcName!=""){var objTempTBody=HXWebJS.Xml._XmlDataIsland._GetElementBindingLineTBody(element);if(objTempTBody==null){intBindingLevel=0}else{var strTemp=objTempTBody.parentNode.getAttribute("datasrc");if(strDataSrcName!=strTemp){intBindingLevel=0}else{intBindingLevel=1;intRecordNumber=parseInt(objTempTBody.getAttribute("hx_binding_line_no"))+1}}}else{var objTempTBody=HXWebJS.Xml._XmlDataIsland._GetElementBindingLineTBody(element);if(objTempTBody==null){return null}intRecordNumber=parseInt(objTempTBody.getAttribute("hx_binding_line_no"))+1;strDataSrcName=objTempTBody.parentNode.getAttribute("datasrc");if(strDataSrcName!=null&&strDataSrcName!=""){var strTemp=HXWebJS.DOM.ElementAttributeGetValue(objTempTBody.parentNode,"hx_binding_level");if(strTemp==null||strTemp==""){return null}intBindingLevel=parseInt(strTemp);if(intBindingLevel>1){strBindingListDataFldName=HXWebJS.DOM.ElementAttributeGetValue(objTempTBody.parentNode,"datafld");intRecordNumberOfUpLevel=HXWebJS.DOM.ElementGetBindingRecordNumber(objTempTBody.parentNode)}}}var strElementTagName=element.tagName.toLowerCase();if(strElementTagName=="input"){var strInputType=element.type;if(strInputType==null){strInputType="text"}strInputType=strInputType.toLowerCase();if((strInputType=="text"||strInputType=="date"||strInputType=="month"||strInputType=="time"||strInputType=="datetime-local"||strInputType=="week"||strInputType=="email"||strInputType=="url"||strInputType=="number"||strInputType=="range"||strInputType=="tel")&&eventType=="change"){strInputElementValue=element.value}else{if(strInputType=="checkbox"&&eventType=="click"){strInputElementValue=(element.checked?"-1":"0")}else{if(strInputType=="radio"&&eventType=="click"){strInputElementValue=element.value}else{if(strInputType=="password"&&eventType=="change"){strInputElementValue=element.value}else{if(strInputType=="file"&&eventType=="change"){strInputElementValue=element.value}else{return null}}}}}}else{if(strElementTagName=="select"){if(eventType=="change"){strInputElementValue=element.value}else{return null}}else{if(strElementTagName=="textarea"){if(eventType=="change"){strInputElementValue=element.value}else{return null}}}}return[strDataSrcName,strDataFldName,strInputElementValue,intBindingLevel,intRecordNumber,strBindingListDataFldName,intRecordNumberOfUpLevel]};HXWebJS.Xml._XmlDataIsland._update_binding_elements_value=function(objHXXmlNode,strAttributeName,strAttributeValue,objTriggeredBindingElement,arrBindingAttributeRefData){if(objHXXmlNode==null){return}if(arrBindingAttributeRefData==null){arrBindingAttributeRefData=HXWebJS.Xml._XmlDataIsland._find_hxxmlnode_binding_reference_data(objHXXmlNode);if(arrBindingAttributeRefData==null){return}}var intBindingLevel=arrBindingAttributeRefData[0];var intRecordNumber=arrBindingAttributeRefData[1];var strBindingListDataFldName=arrBindingAttributeRefData[2];var intUpLevelRecordNumber=arrBindingAttributeRefData[3];var strDataSrcName="#"+objHXXmlNode._xml_data_island_id;var objTempElementsCollection1,objTempElementsCollection2,objTempElementsCollection3;var objTempElementsCollection4,objTempElementsCollection5,objTempElementsCollection6,objTempElementsCollection7;var tmpElementsCollection;var tmpElement;if(intBindingLevel==0){objTempElementsCollection1=HXWebJS.DOM.FindElementsByAttribute("datafld",strAttributeName,null,null);tmpElementsCollection=HXWebJS.DOM.FindElementsByAttribute("datasrc",strDataSrcName,null,objTempElementsCollection1,false)}else{if(intBindingLevel==1){objTempElementsCollection1=HXWebJS.DOM.FindElementsByAttribute("datasrc",strDataSrcName,"table");objTempElementsCollection2=HXWebJS.DOM.FindElementsByAttribute("hx_binding_level",intBindingLevel,null,objTempElementsCollection1,false);objTempElementsCollection3=HXWebJS.DOM.FindElementsByAttribute("hx_binding_line_no",intRecordNumber-1,"tbody",objTempElementsCollection2,true,1);tmpElementsCollection=HXWebJS.DOM.FindElementsByAttribute("datafld",strAttributeName,null,objTempElementsCollection3,true)}else{if(intBindingLevel==2){objTempElementsCollection1=HXWebJS.DOM.FindElementsByAttribute("datasrc",strDataSrcName,"table");objTempElementsCollection2=HXWebJS.DOM.FindElementsByAttribute("hx_binding_level",1,null,objTempElementsCollection1,false);objTempElementsCollection3=HXWebJS.DOM.FindElementsByAttribute("hx_binding_line_no",intUpLevelRecordNumber-1,"tbody",objTempElementsCollection2,true,1);objTempElementsCollection4=HXWebJS.DOM.FindElementsByAttribute("hx_binding_level",2,"table",objTempElementsCollection3,true);objTempElementsCollection5=HXWebJS.DOM.FindElementsByAttribute("datasrc",strDataSrcName,"table",objTempElementsCollection4,false);objTempElementsCollection6=HXWebJS.DOM.FindElementsByAttribute("datafld",strBindingListDataFldName,null,objTempElementsCollection5,false);objTempElementsCollection7=HXWebJS.DOM.FindElementsByAttribute("hx_binding_line_no",intRecordNumber-1,"tbody",objTempElementsCollection6,true,1);tmpElementsCollection=HXWebJS.DOM.FindElementsByAttribute("datafld",strAttributeName,null,objTempElementsCollection7,true)}else{return}}}if(tmpElementsCollection==null){return}for(var i=0;i<tmpElementsCollection.length;i++){tmpElement=tmpElementsCollection[i];if(objTriggeredBindingElement!=null&&tmpElement===objTriggeredBindingElement){continue}HXWebJS.Xml._XmlDataIsland._set_bind_value(tmpElement,tmpElement.tagName.toLowerCase(),strAttributeValue)}};HXWebJS.Xml._XmlDataIsland._find_hxxmlnode_binding_reference_data=function(objHXXmlNode){if(objHXXmlNode==null){return null}if(objHXXmlNode._xml_data_island_id==""){return null}var intBindingLevel=0;var intRecordNumber=-1;var intUpLevelRecordNumber=-1;var strBindingListDataFldName="";var objHXXmlDoc=HXWebJS.Xml.GetHXXmlDocumentViaXmlDataIsland(objHXXmlNode._xml_data_island_id);if(objHXXmlDoc==null){return null}var strXmlNodeTagName=objHXXmlNode._xmlnode.nodeName.toUpperCase();if(strXmlNodeTagName=="RS_ROW"){var objTempHXXmlNodeList=objHXXmlDoc.SelectNodes("//RS_ROW");if(objTempHXXmlNodeList.length<=1){var objTempCollection=HXWebJS.DOM.FindElementsByAttribute("datasrc","#"+objHXXmlNode._xml_data_island_id,"table");intBindingLevel=(objTempCollection==null||objTempCollection.length==0?0:1);intRecordNumber=(intBindingLevel==0?-1:1);return[intBindingLevel,intRecordNumber,strBindingListDataFldName,intUpLevelRecordNumber]}else{for(var i=0;i<objTempHXXmlNodeList.length;i++){if(objTempHXXmlNodeList[i]._xmlnode===objHXXmlNode._xmlnode){intBindingLevel=1;intRecordNumber=i+1;return[intBindingLevel,intRecordNumber,strBindingListDataFldName,intUpLevelRecordNumber]}}return null}}else{strBindingListDataFldName=strXmlNodeTagName;var objTempHXXmlNodeList=objHXXmlDoc.SelectNodes("//RS_ROW");for(var i=0;i<objTempHXXmlNodeList.length;i++){if(objTempHXXmlNodeList[i]._xmlnode===objHXXmlNode._xmlnode.parentNode){intUpLevelRecordNumber=i+1;var objTempHXXmlNodeListFor2ndLevelChildList=objTempHXXmlNodeList[i].SelectNodes(strBindingListDataFldName);for(var j=0;j<objTempHXXmlNodeListFor2ndLevelChildList.length;j++){if(objTempHXXmlNodeListFor2ndLevelChildList[j]._xmlnode===objHXXmlNode._xmlnode){intBindingLevel=2;intRecordNumber=j+1;return[intBindingLevel,intRecordNumber,strBindingListDataFldName,intUpLevelRecordNumber]}}return null}}return null}return null};HXWebJS.Xml._XmlDataIsland._reload_xml_and_rebinding_process=function(str_xml_data_island_id){if(str_xml_data_island_id==null||str_xml_data_island_id==""){return}HXWebJS.Xml._XmlDataIsland._onload_binding_process_for_normal_element(document.body,str_xml_data_island_id)};HXWebJS.Xml._XmlDataIsland._remove_binding_line=function(objHXXmlNodeToRemove){if(objHXXmlNodeToRemove==null){return}var arrBindingAttributeRefData=HXWebJS.Xml._XmlDataIsland._find_hxxmlnode_binding_reference_data(objHXXmlNodeToRemove);if(arrBindingAttributeRefData==null){return}var intBindingLevel=arrBindingAttributeRefData[0];var intRecordNumber=arrBindingAttributeRefData[1];var intUpLevelRecordNumber=arrBindingAttributeRefData[3];var matchedTBodyRowsCollection=HXWebJS.Xml._XmlDataIsland.__find_binding_line_tbody_element_collection(objHXXmlNodeToRemove,arrBindingAttributeRefData);if(matchedTBodyRowsCollection==null||matchedTBodyRowsCollection.length==0){return}var tmpTable,tmpTBody;for(var i=0;i<matchedTBodyRowsCollection.length;i++){tmpTBody=matchedTBodyRowsCollection[i];tmpTable=tmpTBody.parentNode;tmpTable.removeChild(tmpTBody);HXWebJS.Xml._XmlDataIsland._refresh_binding_line_no_of_binding_tbody_elements(tmpTable,intRecordNumber-1,-1)}};HXWebJS.Xml._XmlDataIsland._refresh_binding_line_no_of_binding_tbody_elements=function(objTable,intStartLineNo,intPlusOrMinusLineNo){var strBindingLineNo;for(var i=intStartLineNo;i<objTable.tBodies.length;i++){strBindingLineNo=objTable.tBodies[i].getAttribute("hx_binding_line_no");objTable.tBodies[i].setAttribute("hx_binding_line_no",parseInt(strBindingLineNo)+intPlusOrMinusLineNo)}};HXWebJS.Xml._XmlDataIsland._refresh_binding_line_content=function(objHXXmlNodeAfterReplaced){if(objHXXmlNodeAfterReplaced==null){return}var blnIsIE=HXWebJS.Core.Browser.IsIE&&parseFloat(HXWebJS.Core.Browser.Version)<10;var arrBindingAttributeRefData=HXWebJS.Xml._XmlDataIsland._find_hxxmlnode_binding_reference_data(objHXXmlNodeAfterReplaced);if(arrBindingAttributeRefData==null){return}var matchedTBodyRowsCollection=HXWebJS.Xml._XmlDataIsland.__find_binding_line_tbody_element_collection(objHXXmlNodeAfterReplaced,arrBindingAttributeRefData);if(matchedTBodyRowsCollection==null||matchedTBodyRowsCollection.length==0){return}var strDataSrcName="#"+objHXXmlNodeAfterReplaced._xml_data_island_id;var intBindingLevel=arrBindingAttributeRefData[0];var intRecordNumber=arrBindingAttributeRefData[1];var tmpTable,tmpTBody;for(var i=0;i<matchedTBodyRowsCollection.length;i++){tmpTBody=matchedTBodyRowsCollection[i];if(!blnIsIE){HXWebJS.Xml._XmlDataIsland._expand_single_table_row_process(strDataSrcName,objHXXmlNodeAfterReplaced,tmpTBody,intRecordNumber,intBindingLevel,objHXXmlNodeAfterReplaced._xml_data_island_id)}if(intBindingLevel<2){HXWebJS.Xml._XmlDataIsland._call__webdatalist__after_data_row_rebinding_func_one_line(tmpTBody,intRecordNumber-1,objHXXmlNodeAfterReplaced)}}};HXWebJS.Xml._XmlDataIsland._insert_new_binding_line_content=function(objHXXmlNodeToInsert,insertBefore){if(objHXXmlNodeToInsert==null){return}var arrBindingAttributeRefData=HXWebJS.Xml._XmlDataIsland._find_hxxmlnode_binding_reference_data(objHXXmlNodeToInsert);if(arrBindingAttributeRefData==null){return}var intBindingLevel=arrBindingAttributeRefData[0];var blnIsIE=HXWebJS.Core.Browser.IsIE&&parseFloat(HXWebJS.Core.Browser.Version)<10;if(blnIsIE){if(intBindingLevel<2){HXWebJS.Xml._XmlDataIsland.__ie_newly_binding_line_callback_call(objHXXmlNodeToInsert,insertBefore,arrBindingAttributeRefData)}return}var strDataSrcName="#"+objHXXmlNodeToInsert._xml_data_island_id;var intRecordNumber=arrBindingAttributeRefData[1];var strBindingListDataFldName=arrBindingAttributeRefData[2];var intUpLevelRecordNumber=arrBindingAttributeRefData[3];var arrBindingAttributeRefData_insertBefore=null;var matchedTBodyRowsCollection_insertBefore=null;if(insertBefore!=null){var arrBindingAttributeRefData_insertBefore=HXWebJS.Xml._XmlDataIsland._find_hxxmlnode_binding_reference_data(insertBefore);if(arrBindingAttributeRefData_insertBefore!=null){arrBindingAttributeRefData_insertBefore[1]--;matchedTBodyRowsCollection_insertBefore=HXWebJS.Xml._XmlDataIsland.__find_binding_line_tbody_element_collection(insertBefore,arrBindingAttributeRefData_insertBefore)}}var tmpTBody_insertBefore;var tmpTBody_New;if(matchedTBodyRowsCollection_insertBefore!=null&&matchedTBodyRowsCollection_insertBefore.length>0){for(var i=0;i<matchedTBodyRowsCollection_insertBefore.length;i++){tmpTBody_insertBefore=matchedTBodyRowsCollection_insertBefore[i];tmpTBody_New=HXWebJS.Xml._XmlDataIsland.__insert_new_tbody(tmpTBody_insertBefore);if(tmpTBody_New==null){continue}tmpTBody_New.setAttribute("hx_binding_line_no",tmpTBody_insertBefore.getAttribute("hx_binding_line_no"));HXWebJS.Xml._XmlDataIsland._refresh_binding_line_no_of_binding_tbody_elements(tmpTBody_insertBefore.parentNode,intRecordNumber,+1);HXWebJS.Xml._XmlDataIsland._expand_single_table_row_process(strDataSrcName,objHXXmlNodeToInsert,tmpTBody_New,intRecordNumber,intBindingLevel,objHXXmlNodeToInsert._xml_data_island_id);if(intBindingLevel<2){HXWebJS.Xml._XmlDataIsland._call__webdatalist__after_data_row_add_callbackfunc(tmpTBody_New,intRecordNumber-1,objHXXmlNodeToInsert);HXWebJS.Xml._XmlDataIsland._call__webdatalist__after_data_row_rebinding_func_one_line(tmpTBody_New,intRecordNumber-1,objHXXmlNodeToInsert)}}}else{var tmpBindingTable;var matchedTableCollection_AppendTo=HXWebJS.Xml._XmlDataIsland.__find_binding_tables_collection_for_append_child(objHXXmlNodeToInsert,arrBindingAttributeRefData);for(var i=0;i<matchedTableCollection_AppendTo.length;i++){tmpBindingTable=matchedTableCollection_AppendTo[i];tmpTBody_New=HXWebJS.Xml._XmlDataIsland.__append_new_tbody(tmpBindingTable);if(tmpTBody_New==null){continue}tmpTBody_New.setAttribute("hx_binding_line_no",tmpBindingTable.tBodies.length-1);HXWebJS.Xml._XmlDataIsland._expand_single_table_row_process(strDataSrcName,objHXXmlNodeToInsert,tmpTBody_New,intRecordNumber,intBindingLevel,objHXXmlNodeToInsert._xml_data_island_id);if(intBindingLevel<2){HXWebJS.Xml._XmlDataIsland._call__webdatalist__after_data_row_add_callbackfunc(tmpTBody_New,intRecordNumber-1,objHXXmlNodeToInsert);HXWebJS.Xml._XmlDataIsland._call__webdatalist__after_data_row_rebinding_func_one_line(tmpTBody_New,intRecordNumber-1,objHXXmlNodeToInsert)}}}};HXWebJS.Xml._XmlDataIsland.__insert_new_tbody=function(objTBody_insertBefore){var strTableElementId=objTBody_insertBefore.parentNode.id;if(strTableElementId==null||strTableElementId==""){alert("使用Xml绑定技术的Table元素对象必需指定id属性的值。");return null}var objTemplateElementForTBody=HXWebJS.Xml._XmlDataIsland._table_tbody_row_template_cache[strTableElementId];if(objTemplateElementForTBody==null){return null}var copy=objTemplateElementForTBody.cloneNode(true);return objTBody_insertBefore.parentNode.insertBefore(copy,objTBody_insertBefore)};HXWebJS.Xml._XmlDataIsland.__append_new_tbody=function(objBindingTable){var strTableElementId=objBindingTable.id;if(strTableElementId==null||strTableElementId==""){alert("使用Xml绑定技术的Table元素对象必需指定id属性的值。");return null}var objTemplateElementForTBody=HXWebJS.Xml._XmlDataIsland._table_tbody_row_template_cache[strTableElementId];if(objTemplateElementForTBody==null){return null}var copy=objTemplateElementForTBody.cloneNode(true);return objBindingTable.appendChild(copy)};HXWebJS.Xml._XmlDataIsland.__find_binding_tables_collection_for_append_child=function(objHXXmlNode,arrBindingAttributeRefData){var strDataSrcName="#"+objHXXmlNode._xml_data_island_id;var intBindingLevel=arrBindingAttributeRefData[0];var strBindingListDataFldName=arrBindingAttributeRefData[2].toLowerCase();var intUpLevelRecordNumber=arrBindingAttributeRefData[3];var targetTablesCollection=[];var strTemp,strTemp2;tmpTablesCollection=HXWebJS.DOM.FindElementsByAttribute("datasrc",strDataSrcName,"table",null);for(var i=0;i<tmpTablesCollection.length;i++){tmpTable=tmpTablesCollection[i];strTemp=HXWebJS.DOM.ElementAttributeGetValue(tmpTable,"datafld");if(intBindingLevel<2&&(strTemp==null||strTemp=="")){targetTablesCollection.push(tmpTable)}else{if(intBindingLevel==2&&(strTemp!=null&&strTemp.toLowerCase()==strBindingListDataFldName)){strTemp2=HXWebJS.DOM.ElementGetBindingRecordNumber(tmpTable);if(strTemp2!=null&&strTemp2!=""&&parseInt(strTemp2)==intUpLevelRecordNumber){targetTablesCollection.push(tmpTable)}}}}return targetTablesCollection};HXWebJS.Xml._XmlDataIsland.__find_binding_line_tbody_element_collection=function(objHXXmlNode,arrBindingAttributeRefData){if(arrBindingAttributeRefData==null){return null}var intBindingLevel=arrBindingAttributeRefData[0];var intRecordNumber=arrBindingAttributeRefData[1];var strBindingListDataFldName=arrBindingAttributeRefData[2];var intUpLevelRecordNumber=arrBindingAttributeRefData[3];if(intBindingLevel==0){return null}var strDataSrcName="#"+objHXXmlNode._xml_data_island_id;var RootTablesCollection=[];var tmpTablesCollection;var tmpTable;var strTemp;tmpTablesCollection=HXWebJS.DOM.FindElementsByAttribute("datasrc",strDataSrcName,"table",null);if(tmpTablesCollection.length==0){return null}var blnIsIE=HXWebJS.Core.Browser.IsIE&&parseFloat(HXWebJS.Core.Browser.Version)<10;if(blnIsIE){matchedTBodyRowsCollection=[];var tmpTBodyElement;for(var i=0;i<tmpTablesCollection.length;i++){tmpTBodyElement=tmpTablesCollection[0].tBodies[intRecordNumber-1];matchedTBodyRowsCollection.push(tmpTBodyElement)}return matchedTBodyRowsCollection}RootTablesCollection=HXWebJS.DOM.FindElementsByAttribute("hx_binding_level",1,null,tmpTablesCollection,false);if(RootTablesCollection.length==0){return null}var matchedTBodyRowsCollection=[];if(intBindingLevel==1){matchedTBodyRowsCollection=HXWebJS.DOM.FindElementsByAttribute("hx_binding_line_no",intRecordNumber-1,"tbody",RootTablesCollection,true,1);return matchedTBodyRowsCollection}if(intBindingLevel==2){var tmpCollection1=HXWebJS.DOM.FindElementsByAttribute("hx_binding_line_no",intUpLevelRecordNumber-1,"tbody",RootTablesCollection,true,1);var tmpCollection2=HXWebJS.DOM.FindElementsByAttribute("hx_binding_level",2,"table",tmpCollection1,true);var tmpCollection3=HXWebJS.DOM.FindElementsByAttribute("datasrc",strDataSrcName,null,tmpCollection2,false);var tmpCollection4=HXWebJS.DOM.FindElementsByAttribute("datafld",strBindingListDataFldName,null,tmpCollection3,false);matchedTBodyRowsCollection=HXWebJS.DOM.FindElementsByAttribute("hx_binding_line_no",intRecordNumber-1,"tbody",tmpCollection4,true,1);return matchedTBodyRowsCollection}return null};HXWebJS.Xml._XmlDataIsland.__ie_newly_binding_line_callback_call=function(objHXXmlNodeToInsert,insertBefore,arrBindingAttributeRefData){var strDataSrcName="#"+objHXXmlNodeToInsert._xml_data_island_id;var intBindingLevel=arrBindingAttributeRefData[0];var intRecordNumber=arrBindingAttributeRefData[1];var strBindingListDataFldName=arrBindingAttributeRefData[2];var intUpLevelRecordNumber=arrBindingAttributeRefData[3];var RootTablesCollection=[];var tmpTablesCollection;var tmpTable;var strTemp;tmpTablesCollection=HXWebJS.DOM.FindElementsByAttribute("datasrc",strDataSrcName,"table",null);for(var i=0;i<tmpTablesCollection.length;i++){tmpTable=tmpTablesCollection[i];strTemp=HXWebJS.DOM.ElementAttributeGetValue(tmpTable,"datafld");if(strTemp==null||strTemp==""){RootTablesCollection.push(tmpTable)}}if(RootTablesCollection.length==0){return null}var intTotalRowsCount=objHXXmlNodeToInsert._xmlnode.parentNode.childNodes.length;for(var i=0;i<RootTablesCollection.length;i++){tmpTable=RootTablesCollection[i];HXWebJS.Xml._XmlDataIsland.__ie_newly_binding_line_callback_call__one_table(intTotalRowsCount,tmpTable,objHXXmlNodeToInsert,intBindingLevel,intRecordNumber)}};HXWebJS.Xml._XmlDataIsland.__ie_newly_binding_line_callback_call__one_table=function(intTotalRowsCount,tmpTable,objHXXmlNodeToInsert,intBindingLevel,intRecordNumber){var tBodyCount=tmpTable.tBodies.length;if(tBodyCount<intTotalRowsCount){var fnDelegate=HXWebJS.Core.CreateDelegateFunction(this,HXWebJS.Xml._XmlDataIsland.__ie_newly_binding_line_callback_call__one_table,intTotalRowsCount,tmpTable,objHXXmlNodeToInsert,intBindingLevel,intRecordNumber);window.setTimeout(fnDelegate,200);return}var tmpTBody=null;if(intBindingLevel==0){tmpTBody=tmpTable.tBodies[0]}else{if(intBindingLevel==1){tmpTBody=tmpTable.tBodies[intRecordNumber-1]}}if(tmpTBody==null){return}HXWebJS.Xml._XmlDataIsland._call__webdatalist__after_data_row_add_callbackfunc(tmpTBody,intRecordNumber-1,objHXXmlNodeToInsert);HXWebJS.Xml._XmlDataIsland._call__webdatalist__after_data_row_rebinding_func_one_line(tmpTBody,intRecordNumber-1,objHXXmlNodeToInsert)};HXWebJS.Xml._XmlDataIsland._call__webdatalist__after_data_row_add_callbackfunc=function(objTBody,lineNo,objHXXmlNode){if(HXWebJS.Core._InternalFunctions.IsJavascriptFunctionDefined("hxfn_callback_webdatalist__after_data_row_add")){try{hxfn_callback_webdatalist__after_data_row_add(objTBody.parentNode.id,lineNo,objTBody,objHXXmlNode)}catch(ex){alert("hxfn_callback_webdatalist__after_data_row_add()函数调用失败。错误详情： "+(ex.description!=null?ex.description:ex))}}};HXWebJS.Xml._XmlDataIsland._registed_xmlbinding_linefeed_attributes={};HXWebJS.Xml._XmlDataIsland.register_xmlbinding_linefeed_attributes=function(id,arrAttributeListForLineFeedProcess){if(id==null||id==""){return}HXWebJS.Xml._XmlDataIsland._registed_xmlbinding_linefeed_attributes[id]=arrAttributeListForLineFeedProcess};HXWebJS.Utility={};HXWebJS.Utility._InternalFunctions={};HXWebJS.Utility.Trim=function(strText){if(strText==null){return null}if(typeof(strText)!="string"){strText=strText.toString()}return strText.replace(/(^\s*)|(\s*$)/g,"")};HXWebJS.Utility.StringFormat=function(strTemplate,arg0){if(strTemplate==null){return null}var re;var strResult=strTemplate;for(var i=1;i<arguments.length;i++){re=new RegExp("\\{"+(i-1).toString()+"\\}","g");strResult=strResult.replace(re,arguments[i])}return strResult};HXWebJS.Utility.GetStringPixelWidth=function(str,intPixelWidthPerEnglishChar,intPixelWidthPerWideChar){if(str==null||str==""){return 0}var intCountOfEnglishChars=0,intCountWideChars=0;for(var i=0;i<str.length;i++){if(str.charCodeAt(i)>=255){intCountWideChars++}else{intCountOfEnglishChars++}}if(intPixelWidthPerEnglishChar==null){intPixelWidthPerEnglishChar=8}if(intPixelWidthPerWideChar==null){intPixelWidthPerWideChar=12}return intCountOfEnglishChars*intPixelWidthPerEnglishChar+intCountWideChars*intPixelWidthPerWideChar};HXWebJS.Utility.IsStringHasInvalidChar=function(strInput,blnAllowSpaceChar){if(strInput==null||strInput==""){return false}if(blnAllowSpaceChar==null||blnAllowSpaceChar!=true){blnAllowSpaceChar=false}if(blnAllowSpaceChar==false){if(strInput.indexOf(" ")!=-1){return false}}var re=new RegExp("[,:'`*|?\\\\\"&%$!+[\\]=(){}\\f\\n\\r\\t\\v]");return(!re.test(strInput))};HXWebJS.Utility.StringInArray=function(arr,str,blnIgnoreCase){if(arr==null||arr.length==null||arr.length==0){return false}if(str==null||str==""){return false}if(blnIgnoreCase==null){blnIgnoreCase=false}var str_UpperCased=(blnIgnoreCase?str.toUpperCase():str);var s;for(var i=0;i<arr.length;i++){s=arr[i];if(s==null||s==""){continue}if(s==str){return true}if(blnIgnoreCase&&s.toUpperCase()==str_UpperCased){return true}}return false};HXWebJS.Utility.Round=function(val,scale,intNegativeNumberRoundingRule){if(intNegativeNumberRoundingRule==null){intNegativeNumberRoundingRule=0}if(val>=0||intNegativeNumberRoundingRule==1){if(scale==null||scale<=0){return Math.round(val)}return Math.round(val*Math.pow(10,scale))/Math.pow(10,scale)}else{return HXWebJS.Utility.Round(Math.abs(val),scale)*-1}};HXWebJS.Utility.ConvertToNumber=function(strValue){if(strValue==null||strValue==""){return null}strValue=HXWebJS.Utility.Trim(strValue);var strGroupingSeperator=(HXWebPageGlobalVariables.CurrencyDisplayFormatType==1?".":",");strValue=strValue.replace(new RegExp("\\"+strGroupingSeperator,"g"),"");if(HXWebPageGlobalVariables.CurrencyDisplayFormatType==1){strValue=strValue.replace(/,/g,".")}var blnUsePercentChar=false;if(strValue.substr(strValue.length-1,1)=="%"){strValue=strValue.substr(0,strValue.length-1);blnUsePercentChar=true}var re=/^[+-]?\d*[\.]?\d*$/g;if(re.test(strValue)==false){return null}var n=parseFloat(strValue);return(blnUsePercentChar?n/100:n)};HXWebJS.Utility.IsNumeric=function(val){var n=HXWebJS.Utility.ConvertToNumber(val);return(n!=null)};HXWebJS.Utility.FormatNumberWithGroupSeperator=function(value,strGroupingSeperator,strDecimalSeperator,scale,intNegativeNumberRoundingRule){if(value==null){return""}if(strGroupingSeperator==null){strGroupingSeperator=(HXWebPageGlobalVariables.CurrencyDisplayFormatType==1?".":",")}if(strDecimalSeperator==null||strDecimalSeperator==""){strDecimalSeperator=(HXWebPageGlobalVariables.CurrencyDisplayFormatType==1?",":".")}if(scale!=null){value=HXWebJS.Utility.Round(value,scale,intNegativeNumberRoundingRule)}var sb_NewValue=new HXWebStringBuilder();var strOriginalValue=value.toString();if(strOriginalValue.substring(0,1)=="-"){sb_NewValue.append("-");strOriginalValue=strOriginalValue.substring(1,strOriginalValue.length)}var strArray=strOriginalValue.split(".");var intLength=strArray[0].length;var strTemp;if(strGroupingSeperator!=""){var intCount=intLength<4?0:parseInt((intLength-1)/3);sb_NewValue.append(strArray[0].substring(0,intLength-intCount*3));for(var i=intCount;i>0;i--){strTemp=strArray[0].substring(intLength-i*3,intLength-(i-1)*3);sb_NewValue.append(strGroupingSeperator+strTemp)}}else{sb_NewValue.append(strArray[0])}if(scale!=null&&scale>0){if(strArray.length>1){sb_NewValue.append(strDecimalSeperator+strArray[1]);for(var i=strArray[1].length;i<scale;i++){sb_NewValue.append("0")}}else{sb_NewValue.append(strDecimalSeperator);for(var i=0;i<scale;i++){sb_NewValue.append("0")}}}else{if(strArray.length>1){sb_NewValue.append(strDecimalSeperator+strArray[1])}}return sb_NewValue.toString()};HXWebJS.Utility.FormatNumberWithScale=function(val,scale,strDecimalSeperator,intNegativeNumberRoundingRule){return HXWebJS.Utility.FormatNumberWithGroupSeperator(val,"",strDecimalSeperator,scale,intNegativeNumberRoundingRule)};HXWebJS.Utility.FormatNumberAsString=function(val){return HXWebJS.Utility.FormatNumberWithGroupSeperator(val,"",null,null)};HXWebJS.Utility.ConvertJSONToUrlParamString=function(objJSON){if(objJSON==null){return""}var sb=new HXWebStringBuilder();for(var name in objJSON){sb.append("&"+name+"="+escape(objJSON[name]))}return sb.toString()};HXWebJS.Utility.ConvertStringToJSON=function(strJSONContent){eval("var theJsonValue="+strJSONContent);return theJsonValue};HXWebJS.Utility.CovertToDate=function(strDate,strDateDisplayFormatString){if(strDate==null){return null}if(strDateDisplayFormatString==null){strDateDisplayFormatString=HXWebPageGlobalVariables.DateDisplayFormatString}var re=/^d{8}$/;if(re.test(strDate)){eval("var dt = new Date("+strDate.substr(0,4)+"-"+strDate.substr(4,2)+"-"+strDate.substr(6,2)+")");if(!dt instanceof Date){return null}return dt}strDatePartArray=strDate.split(/\D/);if(strDatePartArray[strDatePartArray.length-1]==""){strDatePartArray.splice(strDatePartArray.length-1,1)}if(strDatePartArray.length<3){return null}var strTemp;if(strDateDisplayFormatString.substr(0,2)=="MM"){strTemp=strDatePartArray[2];strDatePartArray[2]=strDatePartArray[1];strDatePartArray[1]=strDatePartArray[0];strDatePartArray[0]=strTemp}else{if(strDateDisplayFormatString.substr(0,2)=="DD"){strTemp=strDatePartArray[2];strDatePartArray[2]=strDatePartArray[0];strDatePartArray[0]=strTemp}}strDatePartArray[1]--;eval("var dt = new Date("+strDatePartArray.join(",")+")");if(!dt instanceof Date){return null}return dt};HXWebJS.Utility.FormatDateTime=function(dt,intFormatType,strDateDisplayFormatString){if(dt==null){return null}if(strDateDisplayFormatString==null){strDateDisplayFormatString=HXWebPageGlobalVariables.DateDisplayFormatString}if(typeof dt=="string"){dt=HXWebJS.Utility.CovertToDate(dt)}if(dt==null){return null}if(intFormatType==null||(intFormatType!=1&&intFormatType!=2&&intFormatType!=3&&intFormatType!=4)){intFormatType=2}var intDate=dt.getFullYear()*10000+(dt.getMonth()+1)*100+dt.getDate();if(intFormatType==1){return intDate}var strSeperator=(strDateDisplayFormatString.substr(0,4)=="YYYY"?strDateDisplayFormatString.substr(4,1):strDateDisplayFormatString.substr(2,1));var str=intDate.toString();var strSimpleDate=str.substr(0,4)+strSeperator+str.substr(4,2)+strSeperator+str.substr(6,2);if(strDateDisplayFormatString.substr(0,2)=="MM"){strSimpleDate=str.substr(4,2)+strSeperator+str.substr(6,2)+strSeperator+str.substr(0,4)}if(strDateDisplayFormatString.substr(0,2)=="DD"){strSimpleDate=str.substr(6,2)+strSeperator+str.substr(4,2)+strSeperator+str.substr(0,4)}if(intFormatType==2){return strSimpleDate}var strTimePart=dt.getHours().toString()+":"+dt.getMinutes().toString()+":"+dt.getSeconds().toString();if(intFormatType==3){return strSimpleDate+" "+strTimePart}if(intFormatType==4){return strSimpleDate+" "+strTimePart+"."+dt.getMilliseconds().toString()}};HXWebJS.Utility.IsPeriod=function(strValue){if(strValue==null){return false}if(typeof(strValue)!="string"&&typeof(strValue)!="number"){return false}if(typeof(strValue)=="number"){strValue=strValue.toString()}if(strValue.length!=6){return false}return/^(\d{4})([01]\d)$/.test(strValue)};HXWebJS.Utility.IsDate=function(strDate,strDateDisplayFormatString){if(strDate==null){return false}if(typeof(strDate)!="string"){return false}if(strDateDisplayFormatString==null){strDateDisplayFormatString=HXWebPageGlobalVariables.DateDisplayFormatString}var re=/^(\d{4})[^\d]{1}([01]?\d)[^\d]{1}([0123]?\d)[^\d]?$/;if(strDateDisplayFormatString.substr(0,2)=="MM"){re=/^([01]?\d)[^\d]{1}([0123]?\d)[^\d]{1}(\d{4})[^\d]?$/}else{if(strDateDisplayFormatString.substr(0,2)=="DD"){re=/^([0123]?\d)[^\d]{1}([01]?\d)[^\d]{1}(\d{4})[^\d]?$/}}if(!re.test(strDate)){return false}var strDatePartArray=strDate.split(/\D/);if(strDatePartArray[strDatePartArray.length-1]==""){strDatePartArray.splice(strDatePartArray.length-1,1)}var intYear,intMonth,intDay;if(strDateDisplayFormatString.substr(0,2)=="MM"){intYear=parseInt(strDatePartArray[2],10);intMonth=parseInt(strDatePartArray[0],10);intDay=parseInt(strDatePartArray[1],10)}else{if(strDateDisplayFormatString.substr(0,2)=="DD"){intYear=parseInt(strDatePartArray[2],10);intMonth=parseInt(strDatePartArray[1],10);intDay=parseInt(strDatePartArray[0],10)}else{intYear=parseInt(strDatePartArray[0],10);intMonth=parseInt(strDatePartArray[1],10);intDay=parseInt(strDatePartArray[2],10)}}if(intMonth<1||intMonth>12){return false}if(intDay>31){return false}if(intDay==31&&(intMonth==2||intMonth==4||intMonth==6||intMonth==9||intMonth==11)){return false}if(intMonth==2&&intDay>29){return false}if(intMonth==2&&intDay==29&&!HXWebJS.Utility.IsLeapYear(intYear)){return false}return true};HXWebJS.Utility.IsLeapYear=function(intYear){if(isNaN(intYear)){return false}if((intYear%4==0&&intYear%100!=0)||intYear%400==0){return true}return false};HXWebJS.Utility.IsTime=function(strTime){if(strTime==null){return false}if(typeof(strTime)!="string"){return false}var re=new RegExp("^\\d{1,2}:\\d{1,2}(:\\d{1,2})?(.\\d{1,4})?$");if(!re.test(strTime.toString())){return false}var ss=strTime.split(/[:]/);var intHour=parseInt(ss[0],10);var intMinute=parseInt(ss[1],10);var intSecond=0;if(ss.length==3){intSecond=parseInt(ss[2],10)}if(intHour>=24){return false}if(intMinute>=60||intSecond>=60){return false}return true};HXWebJS.Utility.IsDateTime=function(strDateTime,strDateDisplayFormatString){if(strDateTime==null){return false}if(typeof(strDateTime)!="string"){return false}var intIndexOfFirstSpaceChar=strDateTime.indexOf(" ");var strDatePart=(intIndexOfFirstSpaceChar==-1?strDateTime:strDateTime.substr(0,intIndexOfFirstSpaceChar));if(!HXWebJS.Utility.IsDate(strDatePart,strDateDisplayFormatString)){return false}if(intIndexOfFirstSpaceChar==-1){return true}var strTimePart=strDateTime.substring(intIndexOfFirstSpaceChar+1);if(!HXWebJS.Utility.IsTime(strTimePart)){return false}return true};HXWebJS.Utility.IsIntegerDate=function(val){if(val==null){return false}if(isNaN(val)){return false}var strTemp=val.toString();if(strTemp.toString().length!=8){return false}var strDate=strTemp.substr(0,4)+"-"+strTemp.substr(4,2)+"-"+strTemp.substr(6,2);return HXWebJS.Utility.IsDate(strDate,"YYYY-MM-DD")};HXWebJS.Utility.ConvertIntegerDate=function(int_date){return new Date(int_date/10000,(int_date%10000)/100-1,int_date%100)};HXWebJS.Utility.DateAdd=function(dtBase,strIntervalType,number){if(dtBase==null){return null}var dt=new Date(dtBase);number=parseFloat(number);var intFirstLevelNum=parseInt(number);var dblSecondLevelNum=number-intFirstLevelNum;dblSecondLevelNum=Math.round(dblSecondLevelNum*Math.pow(10,3))/Math.pow(10,3);switch(strIntervalType){case"y":dt.setFullYear(dt.getFullYear()+intFirstLevelNum,dt.getMonth()+dblSecondLevelNum*12);break;case"m":var dtTemp=new Date(dt.getFullYear(),dt.getMonth()+intFirstLevelNum+1,0);if(dtTemp.getDate()<dt.getDate()){dt=dtTemp}else{dt.setMonth(dt.getMonth()+intFirstLevelNum,dt.getDate()+dblSecondLevelNum*30)}break;case"w":dt.setDate(dt.getDate()+7*intFirstLevelNum);break;case"d":dt.setDate(dt.getDate()+intFirstLevelNum);break;case"h":dt.setHours(dt.getHours()+intFirstLevelNum,dt.getMinutes()+dblSecondLevelNum*60);break;case"n":dt.setMinutes(dt.getMinutes()+intFirstLevelNum,dt.getSeconds()+dblSecondLevelNum*60);break;case"s":dt.setSeconds(dt.getSeconds()+intFirstLevelNum,dt.getMilliseconds()+dblSecondLevelNum*1000);break;case"l":dt.setMilliseconds(dt.getMilliseconds()+intFirstLevelNum);break;default:return dt.setDate(dt.getDate()+intFirstLevelNum);break}return dt};HXWebJS.Utility.DateDiff=function(dateA,dateB,strIntervalType){if(typeof dateA=="string"){dateA=HXWebJS.Utility.CovertToDate(dateA)}if(typeof dateB=="string"){dateB=HXWebJS.Utility.CovertToDate(dateB)}if(dateA==null||dateB==null){return null}if(strIntervalType==null){strIntervalType="d"}if(strIntervalType=="y"){return dateA.getFullYear()-dateB.getFullYear()}if(strIntervalType=="m"){return(dateA.getFullYear()*12+dateA.getMonth())-(dateB.getFullYear()*12+dateB.getMonth())}var intMillisecondsCount=dateA-dateB;var intReturnValue;switch(strIntervalType){case"w":intReturnValue=Math.ceil(intMillisecondsCount/3600000/168);break;case"d":intReturnValue=Math.ceil(intMillisecondsCount/3600000/24);break;case"h":intReturnValue=Math.ceil(intMillisecondsCount/3600000);break;case"n":intReturnValue=Math.ceil(intMillisecondsCount/60000);break;case"s":intReturnValue=Math.ceil(intMillisecondsCount/1000);break;case"l":intReturnValue=intMillisecondsCount;break;default:intReturnValue=Math.ceil(intMillisecondsCount/3600000/24);break}return intReturnValue};HXWebJS.Utility.DebugMessageDisable=function(blnDisableDebugMsg){HXWebJS.Utility._InternalFunctions._debug_message_output_disabled=blnDisableDebugMsg};HXWebJS.Utility.DebugMessageClear=function(){var objTempDiv=document.getElementById("hxdiv_debug_log_message_display_area");if(objTempDiv!=null){objTempDiv.innerHTML=""}};HXWebJS.Utility.DebugMessageOutputOnPage=function(strDebugMessage){if(typeof HXWebJS.Utility._InternalFunctions._debug_message_output_disabled=="undefined"){HXWebJS.Utility._InternalFunctions._debug_message_output_disabled=false}if(HXWebJS.Utility._InternalFunctions._debug_message_output_disabled==true){return}if(document.getElementById("hxdiv_debug_log_message_display_area")==null){var strHtmlForDebugLogArea='<div id="hxdiv_debug_log_message_display_area" style="left:0px;width:100%;z-index:88888;min-height:24px;border:solid 1px red;background-color:yellow; position:absolute;"></div>';var objTempDiv=HXWebJS.DOM.CreateElement(strHtmlForDebugLogArea);objTempDiv.style.top=HXWebJS.Core.WindowGeometry.GetDocumentHeight();document.body.appendChild(objTempDiv)}var objTempDiv=document.getElementById("hxdiv_debug_log_message_display_area");var dtNow=new Date();var strHtmlForDebug="<div>"+HXWebJS.Utility.FormatDateTime(dtNow,3)+"   "+HXWebJS.Xml.MarkXMLSpecialChars(strDebugMessage)+"</div>";var objNewLogDiv=HXWebJS.DOM.CreateElement(strHtmlForDebug);objTempDiv.appendChild(objNewLogDiv)};HXWebJS.Utility.ThrowErrorAndLogToConsole=function(strErrorMessage){if(strErrorMessage==null||strErrorMessage==""){return}if(console!=null&&console.error!=null){console.error(strErrorMessage)}else{throw strErrorMessage}};HXWebJS.Utility.WeChatJSInterfaceInit=function(option){if(!wx){return}if(option==null){return}if(option.appId==null||option.timestamp==null||option.nonceStr==null||option.signature==null){return}var arrJSApiList=["chooseImage","previewImage","uploadImage","downloadImage","openLocation","getLocation","closeWindow","scanQRCode"];if(option.jsExtendApiList!=null){var arrTemp=option.jsExtendApiList.split(/[,|;]/);for(var index in arrTemp){if(HXWebJS.Utility.StringInArray(arrJSApiList,arrTemp[index],true)){continue}arrJSApiList.push(arrTemp[index])}}wx.config({debug:!!option.debug,appId:option.appId,timestamp:option.timestamp,nonceStr:option.nonceStr,signature:option.signature,jsApiList:arrJSApiList})};HXWebJS.Utility._InternalFunctions._WindowTopTipMessageTimerId=null;HXWebJS.Utility.ShowWindowTopTipMessage=function(strMessage,options){if(options==null){options={}}var strContainerDIVName="hxwebjs_window_top_tip_message_container_div";var divForTipMessage=document.getElementById(strContainerDIVName);if(divForTipMessage==null){var _div=document.createElement("div");_div.id=strContainerDIVName;_div.style.position="absolute";_div.style.zIndex=110000;_div.style.top="0px";_div.style.left="25%";_div.style.width="50%";_div.style.textAlign="center";_div.style.display="none";document.body.appendChild(_div);divForTipMessage=_div;divForTipMessage.innerHTML='<div id="hxwebjs_window_top_tip_message_content_div" style="display:inline-block;"></div>'}var intOpacity=(options.opacity==null?100:options.opacity);divForTipMessage.style.opacity=intOpacity/100;divForTipMessage.style.filter="Alpha(Opacity="+intOpacity+")";var spnMessageContent=HXWebJS.DOM.FindFirstElementById("hxwebjs_window_top_tip_message_content_div",divForTipMessage,"div");spnMessageContent.className=(options.message_type==null?"info":options.message_type);HXWebJS.DOM.ElementSetInnerText(spnMessageContent,strMessage);divForTipMessage.style.display="";if(HXWebJS.Utility._InternalFunctions._WindowTopTipMessageTimerId!=null){window.clearTimeout(HXWebJS.Utility._InternalFunctions._WindowTopTipMessageTimerId);HXWebJS.Utility._InternalFunctions._WindowTopTipMessageTimerId=null}var intAutoHideSeconds=(options.auto_hide_seconds==null?0:options.auto_hide_seconds);if(intAutoHideSeconds<=0){intAutoHideSeconds=0}if(intAutoHideSeconds>0){var intTimerId=window.setTimeout(HXWebJS.Utility._InternalFunctions._HideWindowTopTipMessageArea,intAutoHideSeconds*1000);HXWebJS.Utility._InternalFunctions._WindowTopTipMessageTimerId=intTimerId}};HXWebJS.Utility._InternalFunctions._HideWindowTopTipMessageArea=function(){var strContainerDIVName="hxwebjs_window_top_tip_message_container_div";var divForTipMessage=document.getElementById(strContainerDIVName);if(divForTipMessage!=null){divForTipMessage.style.display="none"}};HXWebJS.Utility.CheckInputValidation=function(objContainerElement,strValidGroupName){if(objContainerElement==null){objContainerElement=document}var strDateDisplayFormatString=HXWebPageGlobalVariables.DateDisplayFormatString;var intCurrencyDisplayFormatType=HXWebPageGlobalVariables.CurrencyDisplayFormatType;var blnIsCheckOK;var it=HXWebJS.DOM.FindElementsByTagName("input",objContainerElement);for(var i=0;i<it.length;i++){blnIsCheckOK=HXWebJS.Utility._InternalFunctions._CheckInputValidation_SingleElement(it[i],strValidGroupName,strDateDisplayFormatString,intCurrencyDisplayFormatType);if(!blnIsCheckOK){return false}}it=HXWebJS.DOM.FindElementsByTagName("select",objContainerElement);for(var i=0;i<it.length;i++){blnIsCheckOK=HXWebJS.Utility._InternalFunctions._CheckInputValidation_SingleElement(it[i],strValidGroupName);if(!blnIsCheckOK){return false}}it=HXWebJS.DOM.FindElementsByTagName("textarea",objContainerElement);for(var i=0;i<it.length;i++){blnIsCheckOK=HXWebJS.Utility._InternalFunctions._CheckInputValidation_SingleElement(it[i],strValidGroupName);if(!blnIsCheckOK){return false}}return true};HXWebJS.Utility._InternalFunctions._CheckInputValidation_SingleElement=function(objInputElement,strValidGroupName,strDateDisplayFormatString,intCurrencyDisplayFormatType){if(objInputElement==null){return true}if(objInputElement.offsetHeight<=0){return true}var strInputGroup=HXWebJS.DOM.ElementAttributeGetValue(objInputElement,"hx_input_group");if(strValidGroupName!=null){if(strInputGroup==null||strInputGroup.indexOf(strValidGroupName)==-1){return true}}var strInputElementTagName=objInputElement.tagName.toLowerCase();if(strInputElementTagName=="select"){return HXWebJS.Utility._InternalFunctions._CheckInputValidation_SingleElement_IsMustInputCheck(objInputElement)}if(strInputElementTagName=="textarea"){return HXWebJS.Utility._InternalFunctions._CheckInputValidation_SingleElement_IsMustInputCheck(objInputElement)}if(strInputElementTagName=="input"){var strInputElementType=objInputElement.type.toLowerCase();if(strInputElementType=="button"||strInputElementType=="reset"||strInputElementType=="submit"||strInputElementType=="image"||strInputElementType=="hidden"||strInputElementType=="checkbox"||strInputElementType=="search"||strInputElementType=="radio"){return true}var blnIsMustInputCheckOK=HXWebJS.Utility._InternalFunctions._CheckInputValidation_SingleElement_IsMustInputCheck(objInputElement);if(blnIsMustInputCheckOK==false){return false}if(strInputElementType!="text"){return true}return HXWebJS.Utility._InternalFunctions._CheckInputValidation_SingleElement_DataContentInputCheck(objInputElement,strDateDisplayFormatString,intCurrencyDisplayFormatType)}return true};HXWebJS.Utility._InternalFunctions._CheckInputValidation_GetCustomInvalidMsgText=function(objInputElement){var strInvalidMsgDataFld=HXWebJS.DOM.ElementAttributeGetValue(objInputElement,"hx_input_invalid_msg_datafld");if(strInvalidMsgDataFld==null||strInvalidMsgDataFld==""){return null}var strInvalidMsgDataSrc=HXWebJS.DOM.ElementAttributeGetValue(objInputElement,"hx_input_invalid_msg_datasrc");if(strInvalidMsgDataSrc==null||strInvalidMsgDataSrc==""){strInvalidMsgDataSrc="hxxml_ui_text"}var strMessageText=null;var objHXXmlDocForText,objHXXmlNodeForText;objHXXmlDocForText=HXWebJS.Xml.GetHXXmlDocumentViaXmlDataIsland(strInvalidMsgDataSrc);if(objHXXmlDocForText!=null){var objHXXmlNodeForText=objHXXmlDocForText.SelectSingleNode("//RS_ROW");if(objHXXmlNodeForText!=null){strMessageText=objHXXmlNodeForText.GetAttributeValue(strInvalidMsgDataFld.toUpperCase())}}return strMessageText};HXWebJS.Utility._InternalFunctions._CheckInputValidation_GetInputFieldFullName=function(objInputElement){var strInputFieldDataFld=HXWebJS.DOM.ElementAttributeGetValue(objInputElement,"datafld");if(strInputFieldDataFld==null||strInputFieldDataFld==""){return null}var strInputFieldObjectCode=HXWebJS.DOM.ElementAttributeGetValue(objInputElement,"hx_object_code");var strInputFieldObjectOrViewCode=HXWebJS.DOM.ElementAttributeGetValue(objInputElement,"hx_object_or_view_code");if((strInputFieldObjectCode==null||strInputFieldObjectCode=="")&&(strInputFieldObjectOrViewCode==null||strInputFieldObjectOrViewCode=="")){var objTempElement=objInputElement.parentNode;while(objTempElement!=null){strInputFieldObjectCode=HXWebJS.DOM.ElementAttributeGetValue(objTempElement,"hx_object_code");if(strInputFieldObjectCode!=null&&strInputFieldObjectCode!=""){break}strInputFieldObjectOrViewCode=HXWebJS.DOM.ElementAttributeGetValue(objTempElement,"hx_object_or_view_code");if(strInputFieldObjectOrViewCode!=null&&strInputFieldObjectOrViewCode!=""){break}objTempElement=objTempElement.parentNode}}var blnFieldHasObjectCode=(strInputFieldObjectCode!=null&&strInputFieldObjectCode!="");var blnFieldHasObjectOrViewCode=(strInputFieldObjectOrViewCode!=null&&strInputFieldObjectOrViewCode!="");if(!blnFieldHasObjectCode&&!blnFieldHasObjectOrViewCode){return strInputFieldDataFld}var strInputFieldFullName=strInputFieldDataFld;var objHXXmlDocForText,objHXXmlNodeForText;objHXXmlDocForText=HXWebJS.Xml.GetHXXmlDocumentViaXmlDataIsland("hxxml_ui_text__"+strInputFieldObjectCode);if(objHXXmlDocForText==null&&blnFieldHasObjectOrViewCode){objHXXmlDocForText=HXWebJS.Xml.GetHXXmlDocumentViaXmlDataIsland("hxxml_ui_text__"+strInputFieldObjectOrViewCode)}if(objHXXmlDocForText!=null){var objHXXmlNodeForText=objHXXmlDocForText.SelectSingleNode("//RS_ROW");if(objHXXmlNodeForText!=null){var strObjectName=objHXXmlNodeForText.GetAttributeValue("TITLE__HX_OBJECT_NAME");var strInputFieldName=objHXXmlNodeForText.GetAttributeValue("LBL__"+strInputFieldDataFld.toUpperCase());if(strObjectName!=null&&strObjectName!=""&&strObjectName!=strInputFieldObjectCode){strInputFieldFullName=strObjectName+"."+(strInputFieldName==null||strInputFieldName==""?strInputFieldDataFld:strInputFieldName)}else{strInputFieldFullName=(strInputFieldName==null||strInputFieldName==""?strInputFieldDataFld:strInputFieldName)}}}return strInputFieldFullName};HXWebJS.Utility._InternalFunctions._CheckInputValidation_SingleElement_IsMustInputCheck=function(objInputElement){var blnIsMustInputDefined=HXWebJS.DOM.ElementAttributeIsDefined(objInputElement,"hx_input_is_must");if(!blnIsMustInputDefined||objInputElement.value!=""){return true}var strMessageText;var strInputFieldFullName=HXWebJS.Utility._InternalFunctions._CheckInputValidation_GetInputFieldFullName(objInputElement);if(strInputFieldFullName==null||strInputFieldFullName==""){strMessageText=HXWebXmlService.GetUITextOnServer("WARNING_MSG__HXWWW_INPUT_VALIDATION__VALUE_CANNOT_EMPTY");alert(strMessageText)}else{strMessageText=HXWebXmlService.GetUITextOnServer("WARNING_MSG__HXWWW_INPUT_VALIDATION__VALUE_CANNOT_EMPTY__WITH_FIELD_NAME");alert(HXWebJS.Utility.StringFormat(strMessageText,strInputFieldFullName))}try{objInputElement.focus()}catch(ex){}return false};HXWebJS.Utility._InternalFunctions._CheckInputValidation_SingleElement_DataContentInputCheck=function(objInputElement,strDateDisplayFormatString,intCurrencyDisplayFormatType){var strInputDataType=HXWebJS.DOM.ElementAttributeGetValue(objInputElement,"hx_input_data_type");strInputDataType=(strInputDataType==null?"normal_str":strInputDataType.toLowerCase());var strInputDataValue=objInputElement.value;if(strInputDataValue==null||strInputDataValue==""){return true}var blnIsCheckOK=true;var strMessageUITextCode;var strInputDataCheckTypeWhenCheckFail="";if(strInputDataType=="word_str"){var re=new RegExp("^[\\w]+$");if(!re.test(strInputDataValue)){strMessageUITextCode="WARNING_MSG__HXWWW_INPUT_VALIDATION__WORDSTR_LIMITATION";blnIsCheckOK=false}}if(strInputDataType=="key_str"){if(!HXWebJS.Utility.IsStringHasInvalidChar(strInputDataValue)){strMessageUITextCode="WARNING_MSG__HXWWW_INPUT_VALIDATION__KEYSTR_LIMITATION";blnIsCheckOK=false}}if(strInputDataType=="date"){if(HXWebJS.Utility.IsDate(strInputDataValue,strDateDisplayFormatString)==false&&HXWebJS.Utility.IsIntegerDate(strInputDataValue)==false){strMessageUITextCode="WARNING_MSG__HXWWW_INPUT_VALIDATION__INVALID_DATE";blnIsCheckOK=false;strInputDataCheckTypeWhenCheckFail="date"}}if(strInputDataType=="time"){if(HXWebJS.Utility.IsTime(strInputDataValue)==false){strMessageUITextCode="WARNING_MSG__HXWWW_INPUT_VALIDATION__INVALID_TIME";blnIsCheckOK=false}}if(strInputDataType=="datetime"){if(HXWebJS.Utility.IsDateTime(strInputDataValue,strDateDisplayFormatString)==false){strMessageUITextCode="WARNING_MSG__HXWWW_INPUT_VALIDATION__INVALID_DATETIME";blnIsCheckOK=false;strInputDataCheckTypeWhenCheckFail="datetime"}}if(strInputDataType=="intdate"){if(HXWebJS.Utility.IsIntegerDate(strInputDataValue)==false){strMessageUITextCode="WARNING_MSG__HXWWW_INPUT_VALIDATION__INVALID_INTDATE";blnIsCheckOK=false}}if(strInputDataType=="period"){if(HXWebJS.Utility.IsPeriod(strInputDataValue)==false){strMessageUITextCode="WARNING_MSG__HXWWW_INPUT_VALIDATION__INVALID_PERIOD";blnIsCheckOK=false}}var strInputCustomRule="";if(strInputDataType=="custom"){strInputCustomRule=HXWebJS.DOM.ElementAttributeGetValue(objInputElement,"hx_input_custom_rule");if(strInputCustomRule!=null&&strInputCustomRule!=""){var re=new RegExp(strInputCustomRule,"g");if(re.test(strInputDataValue)==false){strMessageUITextCode="WARNING_MSG__HXWWW_INPUT_VALIDATION__CUSTOM_RULE_CHECK_FAILED";blnIsCheckOK=false;strInputDataCheckTypeWhenCheckFail="custom"}}}if(strInputDataType.indexOf("number")!=-1){var arrTemp=HXWebJS.Utility._InternalFunctions._BuildNumberCheckRegExpAndSampleString(strInputDataType,intCurrencyDisplayFormatType);var strRegExpContent=arrTemp[0];var strSampleString=arrTemp[1];var strNumberSign=arrTemp[2];var re=new RegExp(strRegExpContent);var dcmlTempValue=HXWebJS.Utility.ConvertToNumber(strInputDataValue);if(dcmlTempValue==null){strMessageUITextCode="WARNING_MSG__HXWWW_INPUT_VALIDATION__INVALID_NUMBER";blnIsCheckOK=false}else{if(strNumberSign=="+"&&dcmlTempValue<0){strMessageUITextCode="WARNING_MSG__HXWWW_INPUT_VALIDATION__NUMBER_MUST_BE_POSITIVE";blnIsCheckOK=false}else{if(strNumberSign=="-"&&dcmlTempValue>0){strMessageUITextCode="WARNING_MSG__HXWWW_INPUT_VALIDATION__NUMBER_MUST_BE_NEGATIVE";blnIsCheckOK=false}else{var strTemp=HXWebJS.Utility.FormatNumberAsString(dcmlTempValue);if(re.test(strTemp)==false){strMessageUITextCode="WARNING_MSG__HXWWW_INPUT_VALIDATION__NUMBER_PRECISION_INVALID";strInputDataCheckTypeWhenCheckFail="number__precision";blnIsCheckOK=false}}}}}if(blnIsCheckOK==false){var strInputFieldFullName=HXWebJS.Utility._InternalFunctions._CheckInputValidation_GetInputFieldFullName(objInputElement);var strMessageText;if(strInputFieldFullName==null||strInputFieldFullName==""){strMessageText=HXWebXmlService.GetUITextOnServer(strMessageUITextCode)}else{strMessageText=HXWebXmlService.GetUITextOnServer(strMessageUITextCode+"__WITH_FIELD_NAME");strMessageText=HXWebJS.Utility.StringFormat(strMessageText,strInputFieldFullName)}if(strInputDataCheckTypeWhenCheckFail=="number__precision"){strMessageText+=" "+strSampleString}else{if(strInputDataCheckTypeWhenCheckFail=="custom"){var strTemp=HXWebJS.Utility._InternalFunctions._CheckInputValidation_GetCustomInvalidMsgText(objInputElement);if(strTemp!=null&&strTemp!=""){strMessageText=strTemp}else{strMessageText+=" "+strInputCustomRule}}else{if(strInputDataCheckTypeWhenCheckFail=="date"||strInputDataCheckTypeWhenCheckFail=="datetime"){strTemp=strDateDisplayFormatString.replace("MM","08").replace("DD","28").replace("YYYY","2008");strMessageText=strMessageText.replace(/2008-08-28/g,strTemp)}}}alert(strMessageText);if(objInputElement.disabled==false){try{objInputElement.focus()}catch(ex){}}return false}return true};HXWebJS.Utility._InternalFunctions._BuildNumberCheckRegExpAndSampleString=function(strInputDataType,intCurrencyDisplayFormatType){var strNumberSign,strNumberPrecision,strNumberScale;var re1;var strDecimalSeperator=(intCurrencyDisplayFormatType==0?".":",");strNumberSign=(strInputDataType.substr(strInputDataType.length-1,1));if(strNumberSign!="+"&&strNumberSign!="-"){strNumberSign=""}if(strInputDataType.indexOf("(")==-1||strInputDataType.indexOf(")")==-1){strNumberPrecision="";strNumberScale=""}else{var strTemp=strInputDataType.substring(strInputDataType.indexOf("(")+1,strInputDataType.indexOf(")"));strTemp=strTemp.replace(/ /g,"");if(strTemp.indexOf(",")==-1){strNumberPrecision=strTemp;strNumberScale=""}else{strNumberPrecision=strTemp.substr(0,strTemp.indexOf(","));strNumberScale=strTemp.substr(strTemp.indexOf(",")+1)}re1=new RegExp("^\\d{1,2}$");if(re1.test(strNumberPrecision)==false){strNumberPrecision=""}if(re1.test(strNumberScale)==false){strNumberScale=""}if(strNumberPrecision!=""&&strNumberScale!=""){if(parseInt(strNumberScale)>=parseInt(strNumberPrecision)){strNumberScale=parseInt(strNumberPrecision)-1}}}var strRegExpContent;if(strNumberSign==""){strRegExpContent="^[+-]?"}else{if(strNumberSign=="+"){strRegExpContent="^[+]?"}else{strRegExpContent="^-"}}if(strNumberPrecision==""){strRegExpContent+="\\d*[\\"+strDecimalSeperator+"]?\\d*$"}else{if(strNumberScale==""){strRegExpContent+="\\d{1,"+strNumberPrecision+"}$"}else{strRegExpContent+="\\d{1,"+(parseInt(strNumberPrecision)-parseInt(strNumberScale))+"}([\\"+strDecimalSeperator+"]\\d{0,"+strNumberScale+"})?$"}}var strSampleString="";if(strNumberPrecision!=""){var intTemp1,intTemp2;if(strNumberScale==""){intTemp2=0}else{intTemp2=parseInt(strNumberScale)}intTemp1=parseInt(strNumberPrecision)-intTemp2;for(var ii=0;ii<intTemp1;ii++){strSampleString+="n"}if(intTemp2>0){strSampleString+=strDecimalSeperator;for(var ii=0;ii<intTemp2;ii++){strSampleString+="n"}}}var arr=[strRegExpContent,strSampleString,strNumberSign];return arr};HXWebJS.Utility.DisableInput=function(blnTrueOrFalse,objContainerElement,strValidGroupName){if(blnTrueOrFalse==null){blnTrueOrFalse=true}var strTempInputGroupName;var it=HXWebJS.DOM.FindElementsByTagName("input",objContainerElement);for(var i=0;i<it.length;i++){strTempInputGroupName=HXWebJS.DOM.ElementAttributeGetValue(it[i],"hx_input_group");if(strValidGroupName==null||(strTempInputGroupName!=null&&strTempInputGroupName.indexOf(strValidGroupName)!=-1)){it[i].disabled=blnTrueOrFalse}}it=HXWebJS.DOM.FindElementsByTagName("select",objContainerElement);for(var i=0;i<it.length;i++){strTempInputGroupName=HXWebJS.DOM.ElementAttributeGetValue(it[i],"hx_input_group");if(strValidGroupName==null||(strTempInputGroupName!=null&&strTempInputGroupName.indexOf(strValidGroupName)!=-1)){it[i].disabled=blnTrueOrFalse}}it=HXWebJS.DOM.FindElementsByTagName("textarea",objContainerElement);for(var i=0;i<it.length;i++){strTempInputGroupName=HXWebJS.DOM.ElementAttributeGetValue(it[i],"hx_input_group");if(strValidGroupName==null||(strTempInputGroupName!=null&&strTempInputGroupName.indexOf(strValidGroupName)!=-1)){it[i].disabled=blnTrueOrFalse}}};HXWebJS.Utility.HtmlContentEdit=function(strEditorTitle,strOriginalHtmlContent,width,height,fnCallback){var objParam=new Object();objParam.htmlcontent=strOriginalHtmlContent;objParam.title=strEditorTitle;HXWebJS.Navigation.OpenWebDialog(HXWebPageGlobalVariables.WebRootPath+"hxpublic/hx_html_editor_wrapper.htm",objParam,width,height,"no",fnCallback)};HXWebJS.AppUtility={};HXWebJS.AppUtility._InternalFunctions={};HXWebJS.AppUtility.RegisterReportParamValues=function(strParamValue1){var i,numArgs=arguments.length;if(numArgs==0){alert("调用HXWebJS.AppUtility.RegisterReportParamValues()函数至少需要传递一个参数！");return}var sb_xml=new HXWebStringBuilder();sb_xml.append("<RS_DATA><RS_ROW ");for(i=0;i<numArgs;i++){sb_xml.append(" PARAM_VALUE_");sb_xml.append((i+1).toString());sb_xml.append('="');sb_xml.append(HXWebJS.Xml.MarkXMLSpecialChars(arguments[i]));sb_xml.append('"')}sb_xml.append(" /></RS_DATA>");var strAssemblyName="TrustHX.HXWWW501";var strClassName="TrustHX.HXWWW501.Utility";var strRptParamUUID=HXWebXmlService.CallPageXmlService("HXPGXMLSVC_REGISTER_REPORT_PARAM_VALUES",sb_xml.toString(),strAssemblyName,strClassName);return strRptParamUUID};HXWebJS.AppUtility.RegisterReportLongParamValues=function(strRptParamUUID,strLongParamValue1){var i,numArgs=arguments.length;if(numArgs<2){alert("调用HXWebJS.AppUtility.RegisterReportLongParamValues()函数至少需要传递两个参数！");return}var sb_xml=new HXWebStringBuilder();sb_xml.append("<RS_DATA><RS_ROW ");sb_xml.append(' RPT_PARAM_UUID="');sb_xml.append(HXWebJS.Xml.MarkXMLSpecialChars(strRptParamUUID));sb_xml.append('"');for(i=1;i<numArgs;i++){sb_xml.append(" LONG_PARAM_VALUE_");sb_xml.append(i.toString());sb_xml.append('="');sb_xml.append(HXWebJS.Xml.MarkXMLSpecialChars(arguments[i]));sb_xml.append('"')}sb_xml.append(" /></RS_DATA>");var strAssemblyName="TrustHX.HXWWW501";var strClassName="TrustHX.HXWWW501.Utility";strRptParamUUID=HXWebXmlService.CallPageXmlService("HXPGXMLSVC_REGISTER_REPORT_LONG_PARAM_VALUES",sb_xml.toString(),strAssemblyName,strClassName);return strRptParamUUID};HXWebJS.AppUtility.OpenReportingSvcReport=function(strReportCode,strRptParamUUID,intShowStyle,strWindowName,intDialogWidth,intDialogHeight){if(intShowStyle==null||(intShowStyle!=1&&intShowStyle!=2&&intShowStyle!=3)){intShowStyle=0}if(strWindowName==null){strWindowName="_blank"}var strReportProcessUrl=gstrWebRootPath+"hxsm/reportingsvc_report_process.aspx?rpt_param_uuid="+strRptParamUUID+"&report_code="+strReportCode;if(intShowStyle==0){HXWebJS.Navigation.OpenWebPage(strReportProcessUrl,strWindowName);return}if(intShowStyle==1){HXWebJS.Navigation.OpenWebDialog(strReportProcessUrl,null,intDialogWidth,intDialogHeight);return}if(intShowStyle==2){var strFrameWinId=strWindowName;HXWebJS.Navigation.OpenWebPageInFrameWindow(strUrl,strFrameWinId)}if(intShowStyle==3){HXWebJS.Navigation.OpenWebPopupPage(strReportProcessUrl,intDialogWidth,intDialogHeight)}};HXWebJS.AppUtility.OpenCrystalReport=function(strReportCode,strRptParamUUID,intShowStyle,strWindowName,intDialogWidth,intDialogHeight){if(intShowStyle==null||(intShowStyle!=1&&intShowStyle!=2&&intShowStyle!=3)){intShowStyle=0}if(strRptParamUUID==null){strRptParamUUID=""}if(strWindowName==null){strWindowName="_blank"}var strReportProcessUrl=gstrWebRootPath+"hxsm/crystal_report_process_for_cr9.aspx?rpt_param_uuid="+strRptParamUUID+"&report_code="+strReportCode;if(intShowStyle==0){HXWebJS.Navigation.OpenWebPage(strReportProcessUrl,strWindowName);return}if(intShowStyle==1){HXWebJS.Navigation.OpenWebDialog(strReportProcessUrl,null,intDialogWidth,intDialogHeight);return}if(intShowStyle==2){var strFrameWinId=strWindowName;HXWebJS.Navigation.OpenWebPageInFrameWindow(strUrl,strFrameWinId)}if(intShowStyle==3){HXWebJS.Navigation.OpenWebPopupPage(strReportProcessUrl,intDialogWidth,intDialogHeight)}};HXWebJS.AppUtility.OpenExcelDataExportReport=function(strReportCode,strRptParamUUID,strTempCriteria,intShowStyle,strWindowName,intDialogWidth,intDialogHeight){if(intShowStyle==null||(intShowStyle!=1&&intShowStyle!=2&&intShowStyle!=3)){intShowStyle=0}if(strRptParamUUID==null){strRptParamUUID=""}if(strTempCriteria==null){strTempCriteria=""}if(strWindowName==null){strWindowName="_blank"}var strReportProcessUrl=gstrWebRootPath+"hxsm/excel_data_export_process.aspx?rpt_param_uuid="+strRptParamUUID+"&report_code="+strReportCode+"&temp_criteria="+strTempCriteria;if(intShowStyle==0){HXWebJS.Navigation.OpenWebPage(strReportProcessUrl,strWindowName);return}if(intShowStyle==1){HXWebJS.Navigation.OpenWebDialog(strReportProcessUrl,null,intDialogWidth,intDialogHeight);return}if(intShowStyle==2){var strFrameWinId=strWindowName;HXWebJS.Navigation.OpenWebPageInFrameWindow(strUrl,strFrameWinId)}if(intShowStyle==3){HXWebJS.Navigation.OpenWebPopupPage(strReportProcessUrl,intDialogWidth,intDialogHeight)}};HXWebJS.AppUtility.OpenReportingSvcReportV6=function(strReportCode,strRptParamUUID,windowSetting,strExportFormat,blnGetConfigInfoFromDB){if(strReportCode==null){strReportCode=""}if(strRptParamUUID==null){strRptParamUUID=""}if(strExportFormat==null){strExportFormat=""}if(blnGetConfigInfoFromDB==null){blnGetConfigInfoFromDB=false}var strReportProcessUrl=gstrWebRootPath+"hxpublic_v6/hxssrsrptprocess6.aspx?rpt_param_uuid="+strRptParamUUID+"&report_code="+strReportCode+"&export_format="+strExportFormat+"&cfg_info_via="+(blnGetConfigInfoFromDB?"db":"");HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strReportProcessUrl,windowSetting)};HXWebJS.AppUtility.Login=function(strUserCode,strPassword,strVerifyCode,strCultureName,strCustomizedData){if(strUserCode==null){strUserCode=""}if(strPassword==null){strPassword=""}if(strCultureName==null){strCultureName=""}if(strCustomizedData==null){strCustomizedData=""}if(strVerifyCode==null){strVerifyCode=""}var strXmlLoginData='<RS_DATA><RS_ROW CULTURE_NAME="" USER_CODE="" PASSWORD="" USER_ID="" ID_TYPE="2" CUSTOMIZED_DATA="" VERIFY_CODE="" /></RS_DATA>';var xmlLoginData=HXWebJS.Xml.GetHXXmlDocumentViaXmlString(strXmlLoginData);var objXmlNodeOfRSRow=xmlLoginData.SelectSingleNode("//RS_ROW");objXmlNodeOfRSRow.SetAttributeValue("USER_CODE",strUserCode);objXmlNodeOfRSRow.SetAttributeValue("PASSWORD",strPassword);objXmlNodeOfRSRow.SetAttributeValue("CULTURE_NAME",strCultureName);objXmlNodeOfRSRow.SetAttributeValue("CUSTOMIZED_DATA",strCustomizedData);objXmlNodeOfRSRow.SetAttributeValue("VERIFY_CODE",strVerifyCode);HXWebJS.Core._InternalFunctions.ShowHideProgressBar(true);var fnCallback=function(xmlresult){if(xmlresult!=null){if(typeof(xmlresult)=="object"&&(xmlresult.extra_data=="HXSM_LOGIN_FIRST_AND_NEED_RESET_PASSWORD"||xmlresult.extra_data=="WARNING_MSG__HXSM_LOGIN_PASSWORD_WILL_EXPIRED")){alert(xmlresult.message);if(HXWebJS.Core._InternalFunctions.IsJavascriptFunctionDefined("menu_hxsm_user_change_password")){HXWebJS.Core._InternalFunctions.ShowHideProgressBar(false);menu_hxsm_user_change_password(xmlresult.extra_data);return}}top.location.replace(gstrWebRootPath+"default.aspx")}else{HXWebJS.Core._InternalFunctions.ShowHideProgressBar(false)}};HXWebXmlService.SayToServerAsync("HXSM","HXSM_USER_LOGIN",xmlLoginData.GetXml(),fnCallback)};HXWebJS.AppUtility.LoginV13=function(strUserCode,strPassword,strVerifyCode,extendData,fnCallbackAfterLoginFail,useADAccountLogin,dftADDomainName){if(strUserCode==null){strUserCode=""}if(strPassword==null){strPassword=""}if(strVerifyCode==null){strVerifyCode=""}if(extendData==null){extendData={}}if(dftADDomainName==null){dftADDomainName=""}var sb_xml=new HXWebStringBuilder();sb_xml.append("<RS_DATA><RS_ROW");sb_xml.append(' USER_CODE="'+HXWebJS.Xml.MarkXMLSpecialChars(strUserCode)+'"');sb_xml.append(' PASSWORD="'+HXWebJS.Xml.MarkXMLSpecialChars(strPassword)+'"');sb_xml.append(' VERIFY_CODE="'+HXWebJS.Xml.MarkXMLSpecialChars(strVerifyCode)+'"');sb_xml.append(' REQUEST_CULTURE_NAME="'+HXWebJS.Xml.MarkXMLSpecialChars(extendData.culture_name==null?"":extendData.culture_name)+'"');sb_xml.append(' REQUEST_UI_THEME="'+HXWebJS.Xml.MarkXMLSpecialChars(extendData.ui_theme==null?"":extendData.ui_theme)+'"');sb_xml.append(' REQUEST_CUSTOMIZED_DATA="'+HXWebJS.Xml.MarkXMLSpecialChars(extendData.data==null?"":extendData.data)+'"');sb_xml.append(' LOGIN_BY_AD_AUTHENTICATION="'+(useADAccountLogin?"1":"0")+'"');sb_xml.append(' DEFAULT_AD_DOMAIN="'+HXWebJS.Xml.MarkXMLSpecialChars(dftADDomainName)+'"');sb_xml.append(" /></RS_DATA>");HXWebJS.Core._InternalFunctions.ShowHideProgressBar(true);var fnCallback=function(xmlresult){if(xmlresult!=null){var xmlDocLoginResultData=HXWebJS.Xml.GetHXXmlDocumentViaXmlString(xmlresult);var objTempXmlNode=xmlDocLoginResultData.SelectSingleNode("//@NEED_CHANGE_PWD");var strNeedChangePwd=(objTempXmlNode!=null?objTempXmlNode.GetText():"");if(strNeedChangePwd!=""&&strNeedChangePwd!="0"){if(HXWebJS.Core._InternalFunctions.IsJavascriptFunctionDefined("menu_hxsm_user_change_password")){var strHintText=xmlDocLoginResultData.SelectSingleNode("//@CHANGE_PWD_TEXT").GetText();alert(strHintText);HXWebJS.Core._InternalFunctions.ShowHideProgressBar(false);menu_hxsm_user_change_password();return}}top.location.replace(gstrWebRootPath+"default.aspx")}else{HXWebJS.Core._InternalFunctions.ShowHideProgressBar(false);if(fnCallbackAfterLoginFail!=null){fnCallbackAfterLoginFail()}}};HXWebXmlService.SayToServerAsync("HXSM","HXSM_USER_LOGIN",sb_xml.toString(),fnCallback)};HXWebJS.AppUtility.Logout=function(strLogoutWebPageName,blnDoNotShowHintMessage){if(blnDoNotShowHintMessage==null){blnDoNotShowHintMessage=false}if(!blnDoNotShowHintMessage){var strHintMessage=HXWebXmlService.GetUITextOnServer("WARNING_MSG__HXWWW_GENERAL__LOGOUT_CONFIRM");if(strHintMessage!=null){if(confirm(strHintMessage)==false){return}}}if(strLogoutWebPageName==null||strLogoutWebPageName==""){strLogoutWebPageName="common/logout.aspx"}var pgName=gstrWebRootPath+strLogoutWebPageName;top.location.replace(pgName)};HXWebJS.AppUtility.LogoutV2=function(blnDoNotShowHintMessage){if(blnDoNotShowHintMessage==null){blnDoNotShowHintMessage=false}if(!blnDoNotShowHintMessage){var strHintMessage=HXWebXmlService.GetUITextOnServer("WARNING_MSG__HXWWW_GENERAL__LOGOUT_CONFIRM");if(strHintMessage!=null){if(confirm(strHintMessage)==false){return}}}if(typeof(mstrHXPageServerEnginee)=="string"&&mstrHXPageServerEnginee=="V6"){top.location.replace(gstrWebRootPath+"hxpublic_v6/hxinterface6.aspx?_hxcategory=hx_logout")}else{top.location.replace(gstrWebRootPath+"hxpublic/hxlogout_process.aspx")}};HXWebJS.AppUtility.ADAutoLoginCheckAndProcess=function(){if(typeof ActiveXObject!="undefined"||HXWebJS.Core.Browser.IsIE11){httpOb=new ActiveXObject("Microsoft.XMLHTTP")}else{httpOb=new XMLHttpRequest()}var targetFile=gstrWebRootPath+"hx_win_auto_login_check/hx_windows_auto_login_check.ashx";httpOb.open("POST",targetFile,false);httpOb.send();if(httpOb.status==200&&httpOb.responseText=="ad_check_ok"){document.location.href=gstrWebRootPath+"hx_win_auto_login_check/hx_windows_auto_login.aspx"}};HXWebJS.AppUtility.ADAutoLoginCheckAndProcessV6=function(){if(typeof ActiveXObject!="undefined"||HXWebJS.Core.Browser.IsIE11){httpOb=new ActiveXObject("Microsoft.XMLHTTP")}else{httpOb=new XMLHttpRequest()}var targetFile=gstrWebRootPath+"hxwinautologin_v6/hxwinautologincheck6.aspx";httpOb.open("POST",targetFile,false);httpOb.send();if(httpOb.status==200&&httpOb.responseText=="ad_check_ok"){document.location.href=gstrWebRootPath+"hxwinautologin_v6/hxwinautologin6.aspx"}};HXWebJS.AppUtility.OpenWebFlashDocFile=function(strFileNameInTempFilesFolder,objWindowSetting){var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServer("_hx_temp_file_name",strFileNameInTempFilesFolder);var strUrl=gstrWebRootPath+"hxpublic/hx_flash_doc_reader_wrapper.aspx?hx_page_param_uuid="+strPageParamUUID;HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility.ImportDataViaTemplate=function(strDataImportTemplateCode,strCustomizedErrorReportPageBeforeShowResult){if(strDataImportTemplateCode==null){strDataImportTemplateCode=""}if(strCustomizedErrorReportPageBeforeShowResult==null){strCustomizedErrorReportPageBeforeShowResult=""}var strDataImportWorkProfileUUID=HXWebXmlService.CallPageXmlService("HXPAGEXMLSVC__CREATE_DATA_IMPORT_PROFILE_VIA_TEMPLATE",strDataImportTemplateCode,"hxeims501.www.hxsm","hxeims501.www.hxsm.hxsm_dataimport_wzd_hub");if(strDataImportWorkProfileUUID==null){return}var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServer("data_import_profile_uuid",strDataImportWorkProfileUUID,"customized_error_report_page",strCustomizedErrorReportPageBeforeShowResult);var strUrlForDataImportHub=HXWebPageGlobalVariables.WebRootPath+"hxsm/hxsm_dataimport_wzd_hub.aspx?hx_page_param_uuid="+strPageParamUUID;HXWebJS.Navigation.OpenWebPopupPage(strUrlForDataImportHub,1000,620,"no")};HXWebJS.AppUtility.ImportDataViaTemplateV2=function(strDataImportTemplateCode,strCustomizedErrorReportPageBeforeShowResult){if(strDataImportTemplateCode==null){strDataImportTemplateCode=""}if(strCustomizedErrorReportPageBeforeShowResult==null){strCustomizedErrorReportPageBeforeShowResult=""}var strDataImportWorkProfileUUID=HXWebJS.Xml.XmlService.CallPageXmlService("HXPAGEXMLSVC__CREATE_DATA_IMPORT_PROFILE_VIA_TEMPLATE",strDataImportTemplateCode,"hxsm_dataimport_wzd.hxpage.xhtml","hxsm_dataimport_wzd.hxpage.xhtml.hxsm_dataimport_wzd_hub");if(strDataImportWorkProfileUUID==null){return}var strScreenLayoutFileName="hxsm/hxsm_dataimport_wzd_hub.hxpage.xhtml";var objKeyFieldValues=null;var objWindowSetting={show_style:1,dialog_width:1000,dialog_height:620,dialog_sroll:"no",dialog_callback_func:null};var objExtrPageParamValues={data_import_profile_uuid:strDataImportWorkProfileUUID,customized_error_report_page:strCustomizedErrorReportPageBeforeShowResult};HXWebJS.AppUtility.OpenDynamicDataCommonPageViaFile(strScreenLayoutFileName,objWindowSetting,objExtrPageParamValues,"1.2")};HXWebJS.AppUtility.ImportDataV6=function(strDataETLRuleCode,extraParamValues,fnCallback){if(extraParamValues==null){extraParamValues={etl_rule_code:strDataETLRuleCode}}else{extraParamValues.etl_rule_code=strDataETLRuleCode}var strDialogPageUrl;if(extraParamValues.src_data_from_type=="via_db"){strDialogPageUrl="hxsm_v6/hxsm_data_etl_import__from_src_db.hxpage.xhtml"}else{strDialogPageUrl="hxsm_v6/hxsm_data_etl_import__upload_file.hxpage.xhtml"}var windowSetting={show_style:1,dialog_width:800,dialog_height:550,dialog_scroll:false,dialog_callback_func:fnCallback};HXWebJS.AppUtility.OpenDynamicDataCommonPageViaFile(strDialogPageUrl,windowSetting,extraParamValues,"1.3")};HXWebJS.AppUtility.StaticUDCSetting=function(strSubSysCode,strUDCGroup){var strParamUUID=HXWebXmlService.RegisterParameterValueToServer("subsys_code",strSubSysCode,"udc_group",strUDCGroup);var strPageUrl=gstrWebRootPath+"hxmd/hxmd_static_udc__list.aspx?hx_page_param_uuid="+strParamUUID;HXWebNavigation.OpenWebPage(strPageUrl,"_blank")};HXWebJS.AppUtility.StaticUDCSettingV2=function(strSubSysCode,strUDCGroup){HXWebJS.AppUtility.OpenCommonDataListPageViaScreenLayoutFile("hxmd/hxmd_static_udc__list.hxscreen.xml","_blank",{subsys_code:strSubSysCode,udc_group:strUDCGroup})};HXWebJS.AppUtility.StaticUDCSettingV3=function(strSubSysCode,strUDCGroup,objWindowSetting){HXWebJS.AppUtility.OpenDynamicDataListPageViaFile("hxmd/hxmd_static_udc__list_v3.hxpage.xhtml",objWindowSetting,null,{subsys_code:strSubSysCode,udc_group:strUDCGroup},"1.2")};HXWebJS.AppUtility.OpenCommonDataEditPageViaMetaData=function(strObjectOrViewCode,strRecordUUID,objKeyFieldValues,objWindowSetting,blnAllowEdit,blnAllowDelete,objExtrPageParamValues){if(strObjectOrViewCode==null){strObjectOrViewCode=""}if(blnAllowEdit==null){blnAllowEdit=true}if(blnAllowDelete==null){blnAllowDelete=true}if(strRecordUUID==null){strRecordUUID=""}var arrParamKeyValues=["_hx_object_view_code",strObjectOrViewCode];if(strRecordUUID!=""){arrParamKeyValues.push("_hx_uuid");arrParamKeyValues.push(strRecordUUID)}if(!blnAllowEdit){arrParamKeyValues.push("_hx_allow_edit");arrParamKeyValues.push(0)}if(!blnAllowDelete){arrParamKeyValues.push("_hx_allow_delete");arrParamKeyValues.push(0)}if(objKeyFieldValues!=null){arrParamKeyValues.push("_hx_get_data_via");arrParamKeyValues.push("key_field_values");for(var name in objKeyFieldValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objKeyFieldValues[name])}}if(objExtrPageParamValues!=null){for(var name in objExtrPageParamValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objExtrPageParamValues[name])}}var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);var strUrl=gstrWebRootPath+"hxmd/hxdynamicpage__edit.aspx?hx_page_param_uuid="+strPageParamUUID;HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility.OpenCommonDataEditPageViaScreenLayoutFile=function(strScreenLayoutFileName,strRecordUUID,objKeyFieldValues,objWindowSetting,blnAllowEdit,blnAllowDelete,objExtrPageParamValues,blnShowAsPrintPreviewPage){HXWebJS.AppUtility._InternalFunctions._OpenCommonDataEditPage_V1(strScreenLayoutFileName,strRecordUUID,objKeyFieldValues,objWindowSetting,blnAllowEdit,blnAllowDelete,objExtrPageParamValues,blnShowAsPrintPreviewPage,"via_file")};HXWebJS.AppUtility.OpenCommonDataEditPageViaScreenLayoutCode=function(strScreenLayoutCode,strRecordUUID,objKeyFieldValues,objWindowSetting,blnAllowEdit,blnAllowDelete,objExtrPageParamValues,blnShowAsPrintPreviewPage){HXWebJS.AppUtility._InternalFunctions._OpenCommonDataEditPage_V1(strScreenLayoutCode,strRecordUUID,objKeyFieldValues,objWindowSetting,blnAllowEdit,blnAllowDelete,objExtrPageParamValues,blnShowAsPrintPreviewPage,"via_db")};HXWebJS.AppUtility._InternalFunctions._OpenCommonDataEditPage_V1=function(strScreenLayoutFileNameOrCode,strRecordUUID,objKeyFieldValues,objWindowSetting,blnAllowEdit,blnAllowDelete,objExtrPageParamValues,blnShowAsPrintPreviewPage,strViaType){if(strScreenLayoutFileNameOrCode==null){strScreenLayoutFileNameOrCode=""}if(strRecordUUID==null){strRecordUUID=""}if(blnAllowEdit==null){blnAllowEdit=true}if(blnAllowDelete==null){blnAllowDelete=true}if(blnShowAsPrintPreviewPage==null){blnShowAsPrintPreviewPage=false}var arrParamKeyValues;if(strViaType=="via_file"){arrParamKeyValues=["_hx_via_type","via_screen_layout_file","_hx_screen_layout_file",strScreenLayoutFileNameOrCode]}else{arrParamKeyValues=["_hx_via_type","via_screen_layout_code","_hx_screen_layout_code",strScreenLayoutFileNameOrCode]}if(strRecordUUID!=""){arrParamKeyValues.push("_hx_uuid");arrParamKeyValues.push(strRecordUUID)}if(!blnAllowEdit){arrParamKeyValues.push("_hx_allow_edit");arrParamKeyValues.push(0)}if(!blnAllowDelete){arrParamKeyValues.push("_hx_allow_delete");arrParamKeyValues.push(0)}if(blnShowAsPrintPreviewPage){arrParamKeyValues.push("_hx_show_as_print_preview_page");arrParamKeyValues.push(1)}if(objKeyFieldValues!=null){arrParamKeyValues.push("_hx_get_data_via");arrParamKeyValues.push("key_field_values");for(var name in objKeyFieldValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objKeyFieldValues[name])}}if(objExtrPageParamValues!=null){for(var name in objExtrPageParamValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objExtrPageParamValues[name])}}var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);var strUrl=gstrWebRootPath+"hxmd/hxdynamicpage__edit.aspx?hx_page_param_uuid="+strPageParamUUID;HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility.OpenCommonDataListPageViaMetaData=function(strObjectOrViewCode,strInquiryViewCode,objWindowSetting,blnAllowCreate,blnAllowDelete){if(strInquiryViewCode==null){strInquiryViewCode=""}if(strObjectOrViewCode==null){strObjectOrViewCode=""}if(blnAllowCreate==null){blnAllowCreate=true}if(blnAllowDelete==null){blnAllowDelete=true}var arrParamKeyValues=["inquiry_view_code",strInquiryViewCode,"object_view_code",strObjectOrViewCode];arrParamKeyValues.push("display_create_button");arrParamKeyValues.push((blnAllowCreate?1:0));arrParamKeyValues.push("display_delete_button");arrParamKeyValues.push((blnAllowDelete?1:0));var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);var strUrl=gstrWebRootPath+"hxmd/common_object_data__list.aspx?hx_page_param_uuid="+strPageParamUUID;HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility.OpenCommonDataListPageViaScreenLayoutFile=function(strScreenLayoutFileName,objWindowSetting,objExtrPageParamValues){if(strScreenLayoutFileName==null){strScreenLayoutFileName=""}var arrParamKeyValues=["_hx_via_type","via_screen_layout_file","_hx_screen_layout_file",strScreenLayoutFileName];if(objExtrPageParamValues!=null){for(var name in objExtrPageParamValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objExtrPageParamValues[name])}}var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);var strUrl=gstrWebRootPath+"hxmd/hxdynamicpage__list.aspx?hx_page_param_uuid="+strPageParamUUID;HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility.OpenCommonDataListPageViaScreenLayoutCode=function(strScreenLayoutCode,objWindowSetting,objExtrPageParamValues){HXWebJS.AppUtility._InternalFunctions._OpenDynamicDataListPage("via_db",strScreenLayoutCode,"1.0",objWindowSetting,null,objExtrPageParamValues)};HXWebJS.AppUtility.OpenDynamicDataCommonPageViaFile=function(strScreenLayoutFileName,objWindowSetting,objExtrPageParamValues,strDynamicPageVersion){var strUrl=HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataCommonPageUrl("via_file",strScreenLayoutFileName,strDynamicPageVersion,objExtrPageParamValues);if(strUrl==null){return}HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility.OpenDynamicDataCommonPageViaDB=function(strScreenLayoutCode,objWindowSetting,objExtrPageParamValues,strDynamicPageVersion){var strUrl=HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataCommonPageUrl("via_db",strScreenLayoutFileName,strDynamicPageVersion,objExtrPageParamValues);if(strUrl==null){return}HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataCommonPageUrl=function(strViaType,strScreenLayoutFileNameOrCode,strDynamicPageVersion,objExtrPageParamValues){if(strScreenLayoutFileNameOrCode==null){strScreenLayoutFileNameOrCode=""}if(strDynamicPageVersion==null){strDynamicPageVersion="1.2"}if(strDynamicPageVersion=="1.3"){var arrParamKeyValues=["_hxpage",strScreenLayoutFileNameOrCode];if(objExtrPageParamValues!=null){for(var name in objExtrPageParamValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objExtrPageParamValues[name])}}var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);if(strPageParamUUID==null||strPageParamUUID==""){return}return gstrWebRootPath+"hxpublic_v6/hxdynamicpage6.aspx?hx_page_param_uuid="+strPageParamUUID}var arrParamKeyValues=["_hx_via_type",strViaType,"_hx_screen_layout_file_or_code",strScreenLayoutFileNameOrCode,"_hx_dynamic_page_type","common_page"];if(objExtrPageParamValues!=null){for(var name in objExtrPageParamValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objExtrPageParamValues[name])}}var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);var strUrl=gstrWebRootPath+"hxmd/hxdynamicpage_v12.aspx?hx_page_param_uuid="+strPageParamUUID;return strUrl};HXWebJS.AppUtility.OpenDynamicDataEditPageViaFile=function(strScreenLayoutFileName,strRecordUUID,objKeyFieldValues,objWindowSetting,objExtrPageParamValues,strDynamicPageVersion,blnIsPrintPreview){if(strDynamicPageVersion==null){strDynamicPageVersion="1.1"}var strUrl=HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataEditPageUrl("via_file",strScreenLayoutFileName,strDynamicPageVersion,strRecordUUID,objKeyFieldValues,objExtrPageParamValues,blnIsPrintPreview);if(strUrl==null){return}HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility.OpenDynamicDataEditPageViaDB=function(strScreenLayoutCode,strRecordUUID,objKeyFieldValues,objWindowSetting,objExtrPageParamValues,strDynamicPageVersion,blnIsPrintPreview){if(strDynamicPageVersion==null){strDynamicPageVersion="1.1"}var strUrl=HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataEditPageUrl("via_db",strScreenLayoutCode,strDynamicPageVersion,strRecordUUID,objKeyFieldValues,objExtrPageParamValues,blnIsPrintPreview);if(strUrl==null){return}HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataEditPageUrl=function(strViaType,strScreenLayoutFileNameOrCode,strDynamicPageVersion,strRecordUUID,objKeyFieldValues,objExtrPageParamValues,blnIsPrintPreview){if(strScreenLayoutFileNameOrCode==null){strScreenLayoutFileNameOrCode=""}if(strDynamicPageVersion==null){strDynamicPageVersion="1.1"}if(strRecordUUID==null){strRecordUUID=""}if(blnIsPrintPreview==null){blnIsPrintPreview=false}if(strDynamicPageVersion=="1.3"){var arrParamKeyValues=["_hxpage",strScreenLayoutFileNameOrCode,"_hxuuid",strRecordUUID,"_hxkeys",(objKeyFieldValues==null?"":JSON.stringify(objKeyFieldValues))];if(blnIsPrintPreview){arrParamKeyValues.push("_hx_print_preview_mode");arrParamKeyValues.push("1")}if(objExtrPageParamValues!=null){for(var name in objExtrPageParamValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objExtrPageParamValues[name])}}var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);if(strPageParamUUID==null||strPageParamUUID==""){return}return gstrWebRootPath+"hxpublic_v6/hxdynamicpage6.aspx?hx_page_param_uuid="+strPageParamUUID}var arrParamKeyValues=["_hx_via_type",strViaType,"_hx_screen_layout_file_or_code",strScreenLayoutFileNameOrCode,"_hx_uuid",strRecordUUID,"_hx_dynamic_page_type","edit_page","_hx_is_print_mode_page",(blnIsPrintPreview?"1":"0")];if(objKeyFieldValues!=null){var sb_temp=new HXWebStringBuilder();sb_temp.append("<RS_DATA>");for(var name in objKeyFieldValues){sb_temp.append("<RS_ROW ");sb_temp.append(name.toUpperCase()+'="'+HXWebJS.Xml.MarkXMLSpecialChars(objKeyFieldValues[name])+'" />')}sb_temp.append("</RS_DATA>");arrParamKeyValues.push("_hx_key_field_values");arrParamKeyValues.push(sb_temp.toString())}if(objExtrPageParamValues!=null){for(var name in objExtrPageParamValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objExtrPageParamValues[name])}}var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);if(strPageParamUUID==null||strPageParamUUID==""){return}var strUrl;if(strDynamicPageVersion=="1.2"){strUrl=gstrWebRootPath+"hxmd/hxdynamicpage_v12.aspx?hx_page_param_uuid="+strPageParamUUID}else{strUrl=gstrWebRootPath+"hxmd/hxdynamicpage__edit_v1_1.aspx?hx_page_param_uuid="+strPageParamUUID}return strUrl};HXWebJS.AppUtility.OpenDynamicDataListPageViaFile=function(strScreenLayoutFileName,objWindowSetting,objSearchFieldDefaultValues,objExtrPageParamValues,strDynamicPageVersion){if(strDynamicPageVersion==null){strDynamicPageVersion="1.1"}HXWebJS.AppUtility._InternalFunctions._OpenDynamicDataListPage("via_file",strScreenLayoutFileName,strDynamicPageVersion,objWindowSetting,objSearchFieldDefaultValues,objExtrPageParamValues)};HXWebJS.AppUtility.OpenDynamicDataListPageViaDB=function(strScreenLayoutCode,objWindowSetting,objSearchFieldDefaultValues,objExtrPageParamValues,strDynamicPageVersion){if(strDynamicPageVersion==null){strDynamicPageVersion="1.1"}HXWebJS.AppUtility._InternalFunctions._OpenDynamicDataListPage("via_db",strScreenLayoutCode,strDynamicPageVersion,objWindowSetting,objSearchFieldDefaultValues,objExtrPageParamValues)};HXWebJS.AppUtility._InternalFunctions._OpenDynamicDataListPage=function(strViaType,strScreenLayoutFileNameOrCode,strScreenLayoutVersion,objWindowSetting,objSearchFieldDefaultValues,objExtrPageParamValues){var strUrl=HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataListPageUrl(strViaType,strScreenLayoutFileNameOrCode,strScreenLayoutVersion,objSearchFieldDefaultValues,objExtrPageParamValues);if(strUrl==null){return}HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataListPageUrl=function(strViaType,strScreenLayoutFileNameOrCode,strScreenLayoutVersion,objSearchFieldDefaultValues,objExtrPageParamValues){if(strScreenLayoutFileNameOrCode==null){strScreenLayoutFileNameOrCode=""}if(strScreenLayoutVersion=="1.3"){var arrParamKeyValues=["_hxpage",strScreenLayoutFileNameOrCode,"_hxsearchfieldvalues",(objSearchFieldDefaultValues==null?"":JSON.stringify(objSearchFieldDefaultValues))];if(objExtrPageParamValues!=null){for(var name in objExtrPageParamValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objExtrPageParamValues[name])}}var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);if(strPageParamUUID==null||strPageParamUUID==""){return}return gstrWebRootPath+"hxpublic_v6/hxdynamicpage6.aspx?hx_page_param_uuid="+strPageParamUUID}var arrParamKeyValues=["_hx_via_type",strViaType,(strScreenLayoutVersion=="1.0"?"_hx_screen_layout_file":"_hx_screen_layout_file_or_code"),strScreenLayoutFileNameOrCode,"_hx_dynamic_page_type","list_page","_hx_is_first_time_onload","1"];if(objSearchFieldDefaultValues!=null){var sb_temp=new HXWebStringBuilder();sb_temp.append("<RS_DATA>");for(var name in objSearchFieldDefaultValues){sb_temp.append("<RS_ROW ");sb_temp.append(name.toUpperCase()+'="'+HXWebJS.Xml.MarkXMLSpecialChars(objSearchFieldDefaultValues[name])+'" />')}sb_temp.append("</RS_DATA>");arrParamKeyValues.push(strScreenLayoutVersion=="1.2"?"_hx_search_field_default_values":"_hx_search_field_values");arrParamKeyValues.push(sb_temp.toString())}if(objExtrPageParamValues!=null){for(var name in objExtrPageParamValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objExtrPageParamValues[name])}}var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);if(strPageParamUUID==null||strPageParamUUID==""){return}var strUrl;if(strScreenLayoutVersion=="1.0"){strUrl=gstrWebRootPath+"hxmd/hxdynamicpage__list.aspx?hx_page_param_uuid="+strPageParamUUID}else{if(strScreenLayoutVersion=="1.1"){strUrl=gstrWebRootPath+"hxmd/hxdynamicpage__list_v1_1.aspx?hx_page_param_uuid="+strPageParamUUID}else{strUrl=gstrWebRootPath+"hxmd/hxdynamicpage_v12.aspx?hx_page_param_uuid="+strPageParamUUID}}return strUrl};HXWebJS.AppUtility.OpenDynamicDataReportPageViaFile=function(strScreenLayoutFileName,objWindowSetting,objSearchFieldDefaultValues,objExtrPageParamValues,strDynamicPageVersion){HXWebJS.AppUtility._InternalFunctions._OpenDynamicDataReportPage("via_file",strScreenLayoutFileName,objWindowSetting,objSearchFieldDefaultValues,objExtrPageParamValues,strDynamicPageVersion)};HXWebJS.AppUtility.OpenDynamicDataReportPageViaDB=function(strScreenLayoutCode,objWindowSetting,objSearchFieldDefaultValues,objExtrPageParamValues,strDynamicPageVersion){HXWebJS.AppUtility._InternalFunctions._OpenDynamicDataReportPage("via_db",strScreenLayoutCode,objWindowSetting,objSearchFieldDefaultValues,objExtrPageParamValues,strDynamicPageVersion)};HXWebJS.AppUtility._InternalFunctions._OpenDynamicDataReportPage=function(strViaType,strScreenLayoutFileNameOrCode,objWindowSetting,objSearchFieldDefaultValues,objExtrPageParamValues,strDynamicPageVersion){var strUrl=HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataReportPageUrl(strViaType,strScreenLayoutFileNameOrCode,objSearchFieldDefaultValues,objExtrPageParamValues,strDynamicPageVersion);if(strUrl==null){return}HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataReportPageUrl=function(strViaType,strScreenLayoutFileNameOrCode,objSearchFieldDefaultValues,objExtrPageParamValues,strDynamicPageVersion){if(strScreenLayoutFileNameOrCode==null){strScreenLayoutFileNameOrCode=""}if(strDynamicPageVersion==null){strDynamicPageVersion="1.1"}var arrParamKeyValues=["_hx_via_type",strViaType,"_hx_screen_layout_file_or_code",strScreenLayoutFileNameOrCode,"_hx_dynamic_page_type","report_page","_hx_is_first_time_onload","1"];if(objSearchFieldDefaultValues!=null){var sb_temp=new HXWebStringBuilder();sb_temp.append("<RS_DATA>");for(var name in objSearchFieldDefaultValues){sb_temp.append("<RS_ROW ");sb_temp.append(name.toUpperCase()+'="'+HXWebJS.Xml.MarkXMLSpecialChars(objSearchFieldDefaultValues[name])+'" />')}sb_temp.append("</RS_DATA>");arrParamKeyValues.push("_hx_search_field_default_values");arrParamKeyValues.push(sb_temp.toString())}if(objExtrPageParamValues!=null){for(var name in objExtrPageParamValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objExtrPageParamValues[name])}}var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);if(strPageParamUUID==null||strPageParamUUID==""){return null}var strUrl;if(strDynamicPageVersion=="1.2"){strUrl=gstrWebRootPath+"hxmd/hxdynamicpage_v12.aspx?hx_page_param_uuid="+strPageParamUUID}else{strUrl=gstrWebRootPath+"hxmd/hxdynamicpage__report.aspx?hx_page_param_uuid="+strPageParamUUID}return strUrl};HXWebJS.AppUtility.OpenDynamicDataStatisticPage=function(strScreenLayoutFileName,objWindowSetting,objSearchFieldDefaultValues,objExtrPageParamValues){var arrParamKeyValues=["_hxpage",strScreenLayoutFileName,"_hxsearchfieldvalues",(objSearchFieldDefaultValues==null?"":JSON.stringify(objSearchFieldDefaultValues))];if(objExtrPageParamValues!=null){for(var name in objExtrPageParamValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objExtrPageParamValues[name])}}var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);if(strPageParamUUID==null||strPageParamUUID==""){return}var strUrl=gstrWebRootPath+"hxpublic_v6/hxdynamicpage6.aspx?hx_page_param_uuid="+strPageParamUUID;HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility.ShowWorkflowDefinitionEditor=function(strWorkflowCode,objWindowSetting,options){HXWebJS.AppUtility._InternalFunctions._ShowWorkflowEditor("hxsm_workflow",strWorkflowCode,objWindowSetting,options)};HXWebJS.AppUtility.ShowWorkflowInstanceEditor=function(strWorkflowInstanceCode,objWindowSetting,options){HXWebJS.AppUtility._InternalFunctions._ShowWorkflowEditor("hxsm_workflow_instance",strWorkflowInstanceCode,objWindowSetting,options)};HXWebJS.AppUtility.ShowWorkflowInstanceEditorViaDocCode=function(strDocType,strDocUniqueCode,objWindowSetting,options){HXWebJS.AppUtility._InternalFunctions._ShowWorkflowEditor("hxsm_workflow_instance","",objWindowSetting,options,strDocType,strDocUniqueCode)};HXWebJS.AppUtility._InternalFunctions._ShowWorkflowEditor=function(strWorkflowXmlSrcType,strWorkflowOrInstanceCode,objWindowSetting,options,strDocType,strDocUniqueCode){if(options==null){options={}}var strEditorCode=(options.editor_code!=null?options.editor_code:"");var blnEditMode=(options.edit_mode==true);var blnShowEditModeButton=(options.show_edit_mode_btn==true);var blnShowXmlDefinitionButton=(options.show_xml_def_btn==true);if(strWorkflowOrInstanceCode==null){strWorkflowOrInstanceCode=""}if(strDocType==null){strDocType=""}if(strDocUniqueCode==null){strDocUniqueCode=""}var arrParamKeyValues=["_hx_workflow_xml_src_type",strWorkflowXmlSrcType,"_hx_workflow_or_instance_code",strWorkflowOrInstanceCode,"_hx_doc_type",strDocType,"_hx_doc_unique_code",strDocUniqueCode,"_hx_workflow_editor_code",strEditorCode,"_hx_edit_mode",(blnEditMode?"1":"0"),"_hx_show_edit_mode_btn",(blnShowEditModeButton?"1":"0"),"_hx_show_xml_def_btn",(blnShowXmlDefinitionButton?"1":"0")];var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);if(strPageParamUUID==null||strPageParamUUID==""){return}var strUrl=gstrWebRootPath+"hxsm/hxsm_workflow_editor_v6.aspx?hx_page_param_uuid="+strPageParamUUID;HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility.ShowApprovalWorkflowEditor=function(strDocTypeCode,strDocUniqueCode,objWindowSetting,options){if(strDocUniqueCode==null){strDocUniqueCode=""}if(options==null){options={}}var arrParamKeyValues=["_hx_workflow_enginee_type","hxapprovalworkflow6","_hx_workflow_definition_code",strDocTypeCode,"_hx_workflow_instance_code",strDocUniqueCode,"_hx_workflow_instance_code_2",(options.workflow_instance_code==null?"":options.workflow_instance_code),"_hx_edit_mode",(options.edit_mode?"1":"0"),"_hx_show_edit_mode_btn",(options.show_edit_mode_btn==null||options.show_edit_mode_btn?"1":"0"),"_hx_show_xml_cnt_btn",(options.show_xml_cnt_btn==null||options.show_xml_cnt_btn?"1":"0"),"_hx_show_title_bar",(options.show_title_bar==null||options.show_title_bar?"1":"0")];var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);if(strPageParamUUID==null||strPageParamUUID==""){return}var strUrl=gstrWebRootPath+"hxpublic_v6/hxworkfloweditor6.aspx?hx_page_param_uuid="+strPageParamUUID;HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility.ShowETLJobWorkflowEditor=function(strETLJobCode,strETLJobLogCode,objWindowSetting,options){if(strETLJobCode==null){strETLJobCode=""}if(options==null){options={}}var arrParamKeyValues=["_hx_workflow_enginee_type","hxetljobworkflow6","_hx_workflow_definition_code",strETLJobCode,"_hx_workflow_instance_code",strETLJobLogCode,"_hx_edit_mode",(options.edit_mode?"1":"0"),"_hx_show_edit_mode_btn",(options.show_edit_mode_btn==null||options.show_edit_mode_btn?"1":"0"),"_hx_show_xml_cnt_btn",(options.show_xml_cnt_btn==null||options.show_xml_cnt_btn?"1":"0"),"_hx_show_title_bar",(options.show_title_bar==null||options.show_title_bar?"1":"0")];var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);if(strPageParamUUID==null||strPageParamUUID==""){return}var strUrl=gstrWebRootPath+"hxpublic_v6/hxworkfloweditor6.aspx?hx_page_param_uuid="+strPageParamUUID;HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.AppUtility.RunInquiryReport=function(strInquiryReportCode,strReportCenterItemCode,windowSetting,strPageEngineeVersion){if(strInquiryReportCode==null){strInquiryReportCode=""}if(strReportCenterItemCode==null){strReportCenterItemCode=""}if(strPageEngineeVersion=="2.0"){var strPageName="hxsm_v6/hxsm_inquiry_report__result_v2.hxpage.xhtml";var objExtraParamValues={inquiry_report_code:strInquiryReportCode,report_center_item_code:strReportCenterItemCode};HXWebJS.AppUtility.OpenDynamicDataPage(strPageName,windowSetting,{extra_param_values:objExtraParamValues})}else{HXWebJS.AppUtility.OpenDynamicDataStatisticPage("hxsm_v6/hxsm_inquiry_report__result.hxpage.xhtml",windowSetting,null,{inquiry_report_code:strInquiryReportCode,report_center_item_code:strReportCenterItemCode})}};HXWebJS.AppUtility.OpenReportCenter=function(strReportCenterCode,windowSetting){var objSearchFieldDefaultValues={report_center_code:strReportCenterCode};var objExtrPageParamValues={report_center_code:strReportCenterCode};HXWebJS.AppUtility.OpenDynamicDataListPageViaFile("hxsm_v6/hxsm_report_center__content_setting.hxpage.xhtml",windowSetting,objSearchFieldDefaultValues,objExtrPageParamValues,"1.3")};HXWebJS.AppUtility.OpenDynamicDataPage=function(strDynamicDataPageName,windowSetting,options){if(options==null){options={}}var arrParamKeyValues=["_hxpage",strDynamicDataPageName];if(options.record_uuid!=null){arrParamKeyValues.push("_hxuuid");arrParamKeyValues.push(options.record_uuid)}if(options.key_field_values!=null){arrParamKeyValues.push("_hxkeys");arrParamKeyValues.push(JSON.stringify(options.key_field_values))}if(options.search_key_word!=null){arrParamKeyValues.push("_hxsearchkeyword");arrParamKeyValues.push(options.search_key_word)}if(options.search_field_default_values!=null){arrParamKeyValues.push("_hxsearchfieldvalues");arrParamKeyValues.push(JSON.stringify(options.search_field_default_values))}if(options.is_print_preview==true){arrParamKeyValues.push("_hx_print_preview_mode");arrParamKeyValues.push("1")}if(options.extra_param_values!=null){for(var name in options.extra_param_values){arrParamKeyValues.push(name);arrParamKeyValues.push(options.extra_param_values[name])}}var strPageParamUUID=HXWebXmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);if(strPageParamUUID==null||strPageParamUUID==""){return}var strUrl=HXWebPageGlobalVariables.WebRootPath+"hxpublic_v6/hxdynamicpage6.aspx?hx_page_param_uuid="+strPageParamUUID;HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,windowSetting)};HXWebJS.Utility._InternalFunctions._HXWebXmlList_QuickSort=function(objXmlRootNode,strFieldName,blnAscOrDesc,begin,end){if(objXmlRootNode==null){return}var swap=function(objXmlRootNode,indexA,indexB){if(indexA==indexB){return}var objXmlNode1=objXmlRootNode.childNodes[indexA];var objXmlNode2=objXmlRootNode.childNodes[indexB];var objXmlNodeTemp=objXmlNode1.cloneNode(true);objXmlRootNode.replaceChild(objXmlNode2.cloneNode(true),objXmlNode1);objXmlRootNode.replaceChild(objXmlNodeTemp,objXmlNode2)};var compare=function(v1,v2,strCompareMethod){var charDigitSeperator=",";if(typeof(mstrCurrentCurrencyDisplayFormatSetting)!="undefined"&&mstrCurrentCurrencyDisplayFormatSetting=="1"){charDigitSeperator="."}v1=v1.replace(new RegExp(",","g"),"");v2=v2.replace(new RegExp(",","g"),"");if(HXWebJS.Utility.IsNumeric(v1)&&HXWebJS.Utility.IsNumeric(v2)){if(strCompareMethod==">"){return(parseFloat(v1)>parseFloat(v2)?true:false)}else{return(parseFloat(v1)<parseFloat(v2)?true:false)}}else{if(HXWebJS.Utility.IsDate(v1)&&HXWebJS.Utility.IsDate(v2)){if(strCompareMethod==">"){return(HXWebJS.Utility.CovertToDate(v1)>HXWebJS.Utility.CovertToDate(v2)?true:false)}else{return(HXWebJS.Utility.CovertToDate(v1)<HXWebJS.Utility.CovertToDate(v2)?true:false)}}else{if(v1==null||v1==""){return(v2==null||v2==""?false:true)}else{if(strCompareMethod==">"){if(v2==null||v2==""){return true}return(v1.toString().localeCompare(v2)==1)}else{if(v2==null||v2==""){return false}return(v1.toString().localeCompare(v2)==-1)}}}}};var getkey=function(objXmlRootNode,strFieldName,index){var objTempXmlNode=objXmlRootNode.childNodes[index];if(document.createExpression){var _xmldoc=(objTempXmlNode.ownerDocument==null?objTempXmlNode:objTempXmlNode.ownerDocument);var xpathExpr=_xmldoc.createExpression(strFieldName,null);var result=xpathExpr.evaluate(objTempXmlNode,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return result.singleNodeValue.textContent}else{return objTempXmlNode.selectSingleNode(strFieldName).text}};var partition=function(objXmlRootNode,strFieldName,begin,end,pivot,strCompareMethod){var piv=getkey(objXmlRootNode,strFieldName,pivot);swap(objXmlRootNode,pivot,end-1);var store=begin;var ix;for(ix=begin;ix<end-1;++ix){var v1=getkey(objXmlRootNode,strFieldName,ix);if(compare(v1,piv,strCompareMethod)){swap(objXmlRootNode,store,ix);++store}}swap(objXmlRootNode,end-1,store);return store};var qsort=function(objXmlRootNode,strFieldName,begin,end,strCompareMethod){if(end-1>begin){if(end-begin<9){insertsort(objXmlRootNode,strFieldName,strCompareMethod,begin,end-begin);return}var pivot=begin+Math.floor(Math.random()*(end-begin));pivot=partition(objXmlRootNode,strFieldName,begin,end,pivot,strCompareMethod);qsort(objXmlRootNode,strFieldName,begin,pivot,strCompareMethod);qsort(objXmlRootNode,strFieldName,pivot+1,end,strCompareMethod)}};var insertsort=function(objXmlRootNode,strFieldName,strCompareMethod,intBegin,intListSize){var j,v1,v2;for(var i=1;i<intListSize;i++){j=i;while(j>0){v1=getkey(objXmlRootNode,strFieldName,intBegin+j);v2=getkey(objXmlRootNode,strFieldName,intBegin+j-1);if(compare(v1,v2,strCompareMethod)==false){break}else{swap(objXmlRootNode,intBegin+j,intBegin+j-1);j--}}}};if(begin==null){begin=0}if(end==null){end=objXmlRootNode.childNodes.length}if(blnAscOrDesc==null){blnAscOrDesc=true}var strCompareMethod=(blnAscOrDesc?"<":">");qsort(objXmlRootNode,strFieldName,begin,end,strCompareMethod)};HXWebJS.Utility._InternalFunctions._MD5=function(sMessage){function RotateLeft(lValue,iShiftBits){return(lValue<<iShiftBits)|(lValue>>>(32-iShiftBits))}function AddUnsigned(lX,lY){var lX4,lY4,lX8,lY8,lResult;lX8=(lX&2147483648);lY8=(lY&2147483648);lX4=(lX&1073741824);lY4=(lY&1073741824);lResult=(lX&1073741823)+(lY&1073741823);if(lX4&lY4){return(lResult^2147483648^lX8^lY8)}if(lX4|lY4){if(lResult&1073741824){return(lResult^3221225472^lX8^lY8)}else{return(lResult^1073741824^lX8^lY8)}}else{return(lResult^lX8^lY8)}}function F(x,y,z){return(x&y)|((~x)&z)}function G(x,y,z){return(x&z)|(y&(~z))}function H(x,y,z){return(x^y^z)}function I(x,y,z){return(y^(x|(~z)))}function FF(a,b,c,d,x,s,ac){a=AddUnsigned(a,AddUnsigned(AddUnsigned(F(b,c,d),x),ac));return AddUnsigned(RotateLeft(a,s),b)}function GG(a,b,c,d,x,s,ac){a=AddUnsigned(a,AddUnsigned(AddUnsigned(G(b,c,d),x),ac));return AddUnsigned(RotateLeft(a,s),b)}function HH(a,b,c,d,x,s,ac){a=AddUnsigned(a,AddUnsigned(AddUnsigned(H(b,c,d),x),ac));return AddUnsigned(RotateLeft(a,s),b)}function II(a,b,c,d,x,s,ac){a=AddUnsigned(a,AddUnsigned(AddUnsigned(I(b,c,d),x),ac));return AddUnsigned(RotateLeft(a,s),b)}function ConvertToWordArray(sMessage){var lWordCount;var lMessageLength=sMessage.length;var lNumberOfWords_temp1=lMessageLength+8;var lNumberOfWords_temp2=(lNumberOfWords_temp1-(lNumberOfWords_temp1%64))/64;var lNumberOfWords=(lNumberOfWords_temp2+1)*16;var lWordArray=Array(lNumberOfWords-1);var lBytePosition=0;var lByteCount=0;while(lByteCount<lMessageLength){lWordCount=(lByteCount-(lByteCount%4))/4;lBytePosition=(lByteCount%4)*8;lWordArray[lWordCount]=(lWordArray[lWordCount]|(sMessage.charCodeAt(lByteCount)<<lBytePosition));lByteCount++}lWordCount=(lByteCount-(lByteCount%4))/4;lBytePosition=(lByteCount%4)*8;lWordArray[lWordCount]=lWordArray[lWordCount]|(128<<lBytePosition);lWordArray[lNumberOfWords-2]=lMessageLength<<3;lWordArray[lNumberOfWords-1]=lMessageLength>>>29;return lWordArray}function WordToHex(lValue){var WordToHexValue="",WordToHexValue_temp="",lByte,lCount;for(lCount=0;lCount<=3;lCount++){lByte=(lValue>>>(lCount*8))&255;WordToHexValue_temp="0"+lByte.toString(16);WordToHexValue=WordToHexValue+WordToHexValue_temp.substr(WordToHexValue_temp.length-2,2)}return WordToHexValue}var x=Array();var k,AA,BB,CC,DD,a,b,c,d;var S11=7,S12=12,S13=17,S14=22;var S21=5,S22=9,S23=14,S24=20;var S31=4,S32=11,S33=16,S34=23;var S41=6,S42=10,S43=15,S44=21;x=ConvertToWordArray(sMessage);a=1732584193;b=4023233417;c=2562383102;d=271733878;for(k=0;k<x.length;k+=16){AA=a;BB=b;CC=c;DD=d;a=FF(a,b,c,d,x[k+0],S11,3614090360);d=FF(d,a,b,c,x[k+1],S12,3905402710);c=FF(c,d,a,b,x[k+2],S13,606105819);b=FF(b,c,d,a,x[k+3],S14,3250441966);a=FF(a,b,c,d,x[k+4],S11,4118548399);d=FF(d,a,b,c,x[k+5],S12,1200080426);c=FF(c,d,a,b,x[k+6],S13,2821735955);b=FF(b,c,d,a,x[k+7],S14,4249261313);a=FF(a,b,c,d,x[k+8],S11,1770035416);d=FF(d,a,b,c,x[k+9],S12,2336552879);c=FF(c,d,a,b,x[k+10],S13,4294925233);b=FF(b,c,d,a,x[k+11],S14,2304563134);a=FF(a,b,c,d,x[k+12],S11,1804603682);d=FF(d,a,b,c,x[k+13],S12,4254626195);c=FF(c,d,a,b,x[k+14],S13,2792965006);b=FF(b,c,d,a,x[k+15],S14,1236535329);a=GG(a,b,c,d,x[k+1],S21,4129170786);d=GG(d,a,b,c,x[k+6],S22,3225465664);c=GG(c,d,a,b,x[k+11],S23,643717713);b=GG(b,c,d,a,x[k+0],S24,3921069994);a=GG(a,b,c,d,x[k+5],S21,3593408605);d=GG(d,a,b,c,x[k+10],S22,38016083);c=GG(c,d,a,b,x[k+15],S23,3634488961);b=GG(b,c,d,a,x[k+4],S24,3889429448);a=GG(a,b,c,d,x[k+9],S21,568446438);d=GG(d,a,b,c,x[k+14],S22,3275163606);c=GG(c,d,a,b,x[k+3],S23,4107603335);b=GG(b,c,d,a,x[k+8],S24,1163531501);a=GG(a,b,c,d,x[k+13],S21,2850285829);d=GG(d,a,b,c,x[k+2],S22,4243563512);c=GG(c,d,a,b,x[k+7],S23,1735328473);b=GG(b,c,d,a,x[k+12],S24,2368359562);a=HH(a,b,c,d,x[k+5],S31,4294588738);d=HH(d,a,b,c,x[k+8],S32,2272392833);c=HH(c,d,a,b,x[k+11],S33,1839030562);b=HH(b,c,d,a,x[k+14],S34,4259657740);a=HH(a,b,c,d,x[k+1],S31,2763975236);d=HH(d,a,b,c,x[k+4],S32,1272893353);c=HH(c,d,a,b,x[k+7],S33,4139469664);b=HH(b,c,d,a,x[k+10],S34,3200236656);a=HH(a,b,c,d,x[k+13],S31,681279174);d=HH(d,a,b,c,x[k+0],S32,3936430074);c=HH(c,d,a,b,x[k+3],S33,3572445317);b=HH(b,c,d,a,x[k+6],S34,76029189);a=HH(a,b,c,d,x[k+9],S31,3654602809);d=HH(d,a,b,c,x[k+12],S32,3873151461);c=HH(c,d,a,b,x[k+15],S33,530742520);b=HH(b,c,d,a,x[k+2],S34,3299628645);a=II(a,b,c,d,x[k+0],S41,4096336452);d=II(d,a,b,c,x[k+7],S42,1126891415);c=II(c,d,a,b,x[k+14],S43,2878612391);b=II(b,c,d,a,x[k+5],S44,4237533241);a=II(a,b,c,d,x[k+12],S41,1700485571);d=II(d,a,b,c,x[k+3],S42,2399980690);c=II(c,d,a,b,x[k+10],S43,4293915773);b=II(b,c,d,a,x[k+1],S44,2240044497);a=II(a,b,c,d,x[k+8],S41,1873313359);d=II(d,a,b,c,x[k+15],S42,4264355552);c=II(c,d,a,b,x[k+6],S43,2734768916);b=II(b,c,d,a,x[k+13],S44,1309151649);a=II(a,b,c,d,x[k+4],S41,4149444226);d=II(d,a,b,c,x[k+11],S42,3174756917);c=II(c,d,a,b,x[k+2],S43,718787259);b=II(b,c,d,a,x[k+9],S44,3951481745);a=AddUnsigned(a,AA);b=AddUnsigned(b,BB);c=AddUnsigned(c,CC);d=AddUnsigned(d,DD)}var temp=WordToHex(a)+WordToHex(b)+WordToHex(c)+WordToHex(d);return temp.toLowerCase()};HXWebJS.Utility.GetSumValueOfXmlDataIslandFieldValue=function(strXmlDataIslandCode,strFieldCode,intDecimalScale,blnFormatWithGroupSeperator,blnReFillFieldValueWithFormat){var objHXXmlDoc=HXWebJS.Xml.GetHXXmlDocumentViaXmlDataIsland(strXmlDataIslandCode);var objHXNodeList=objHXXmlDoc.SelectNodes("//RS_ROW");strFieldCode=strFieldCode.toUpperCase();if(blnFormatWithGroupSeperator==null){blnFormatWithGroupSeperator=false}if(blnReFillFieldValueWithFormat==null){blnReFillFieldValueWithFormat=false}var dblTotalValue=0;var dblTempValue;var objTempHXXmlNode;for(var i=0;i<(objHXNodeList==null?0:objHXNodeList.length);i++){objTempHXXmlNode=objHXNodeList[i].SelectSingleNode("@"+strFieldCode);if(objTempHXXmlNode==null){continue}var strLineValue=objTempHXXmlNode.GetText();if(strLineValue==""){continue}dblTempValue=HXWebJS.Utility.ConvertToNumber(strLineValue);if(dblTempValue==null){if(blnReFillFieldValueWithFormat){objTempHXXmlNode.SetText("")}continue}dblTotalValue=dblTotalValue+dblTempValue;if(blnFormatWithGroupSeperator&&blnReFillFieldValueWithFormat){strLineValue=HXWebJS.Utility.FormatNumberWithGroupSeperator(dblTempValue,null,null,intDecimalScale);objTempHXXmlNode.SetText(strLineValue)}}if(blnFormatWithGroupSeperator){return HXWebJS.Utility.FormatNumberWithGroupSeperator(dblTotalValue,null,null,intDecimalScale)}else{if(intDecimalScale!=null&&intDecimalScale>-1){return HXWebJS.Utility.FormatNumberWithScale(dblTotalValue,intDecimalScale)}else{return HXWebJS.Utility.FormatNumberAsString(dblTotalValue)}}};HXWebJS.Utility.get_sum_of_xml_dataisland_field_value=function(strXmlDataIslandCode,strFieldCode,blnFormatWithSeperator,strGroupingSeperator,strDecimalSeperator,intDecimalScale){var objHXXmlDoc=HXWebJS.Xml.GetHXXmlDocumentViaXmlDataIsland(strXmlDataIslandCode);var objHXNodeList=objHXXmlDoc.SelectNodes("//RS_ROW");strFieldCode=strFieldCode.toUpperCase();if(blnFormatWithSeperator==null){blnFormatWithSeperator=false}if(strGroupingSeperator==null){strGroupingSeperator=","}if(strDecimalSeperator==null){strDecimalSeperator="."}var dblTotalValue=0;var objTempHXXmlNode;for(var i=0;i<objHXNodeList.length;i++){objTempHXXmlNode=objHXNodeList[i].SelectSingleNode("@"+strFieldCode);var strLineValue=objTempHXXmlNode.GetText();strLineValue=strLineValue.replace(new RegExp(strGroupingSeperator,"g"),"");if(HXWebJS.Utility.IsNumeric(strLineValue)==false||strLineValue==""){objTempHXXmlNode.SetText("");strLineValue="";continue}dblTotalValue=dblTotalValue+parseFloat(strLineValue);if(blnFormatWithSeperator){strLineValue=HXWebJS.Utility.FormatNumberWithGroupSeperator(HXWebJS.Utility.Round(parseFloat(strLineValue),intDecimalScale),strGroupingSeperator,strDecimalSeperator);objTempHXXmlNode.SetText(strLineValue)}}if(blnFormatWithSeperator){return HXWebJS.Utility.FormatNumberWithGroupSeperator(HXWebJS.Utility.Round(dblTotalValue,intDecimalScale),strGroupingSeperator,strDecimalSeperator)}else{if(intDecimalScale>-1){return HXWebJS.Utility.FormatNumberWithScale(dblTotalValue,intDecimalScale)}else{return HXWebJS.Utility.FormatNumberAsString(dblTotalValue)}}};HXWebJS.KeyboardHelper={};HXWebJS.KeyboardHelper._InternalFunctions={};HXWebJS.KeyboardHelper.enable_keyboard_support=function(blnEnableCtrlS,blnEnableArrowKeyNavigation,blnEnableDataLineHighlight){HXWebJS.EventManager.AddListener(document.body,"keydown",HXWebJS.KeyboardHelper._InternalFunctions._global_body_onkeydown_process);HXWebJS.KeyboardHelper._InternalFunctions.enable_ctrl_s=(blnEnableCtrlS==null?true:blnEnableCtrlS);HXWebJS.KeyboardHelper._InternalFunctions.enable_arrow_key_navigation=(blnEnableArrowKeyNavigation==null?true:blnEnableArrowKeyNavigation);HXWebJS.KeyboardHelper._InternalFunctions.enable_dataline_highlight=(blnEnableDataLineHighlight==null?true:blnEnableDataLineHighlight);if(HXWebJS.KeyboardHelper._InternalFunctions.enable_dataline_highlight&&HXWebCommonPageHelper!=null){HXWebCommonPageHelper._InternalFunctions.enable_dataline_highlight=true}};HXWebJS.KeyboardHelper._KEYCODE={HOME:36,END:35,UP_ARROW:38,DOWN_ARROW:40,LEFT_ARROW:37,RIGHT_ARROW:39};HXWebJS.KeyboardHelper._InternalFunctions._global_body_onkeydown_process=function(e){var objHXEventData=HXWebJS.EventManager.GetCurrentEventData(e);if(objHXEventData.ctrlKey&&(objHXEventData.keyCode==83||objHXEventData.keyCode==16)){if(!HXWebJS.KeyboardHelper._InternalFunctions.enable_ctrl_s){return}HXWebJS.KeyboardHelper._InternalFunctions._ctrl_s__process(objHXEventData);return}if(objHXEventData.keyCode==HXWebJS.KeyboardHelper._KEYCODE.LEFT_ARROW||objHXEventData.keyCode==HXWebJS.KeyboardHelper._KEYCODE.RIGHT_ARROW){if(!HXWebJS.KeyboardHelper._InternalFunctions.enable_arrow_key_navigation){return}HXWebJS.KeyboardHelper._InternalFunctions._left_or_right_arrow__process(objHXEventData);return}if(objHXEventData.keyCode==HXWebJS.KeyboardHelper._KEYCODE.HOME||objHXEventData.keyCode==HXWebJS.KeyboardHelper._KEYCODE.END){if(!HXWebJS.KeyboardHelper._InternalFunctions.enable_arrow_key_navigation){return}HXWebJS.KeyboardHelper._InternalFunctions._home_or_end_key__process(objHXEventData);return}if(objHXEventData.keyCode==HXWebJS.KeyboardHelper._KEYCODE.UP_ARROW||objHXEventData.keyCode==HXWebJS.KeyboardHelper._KEYCODE.DOWN_ARROW){if(!HXWebJS.KeyboardHelper._InternalFunctions.enable_arrow_key_navigation){return}HXWebJS.KeyboardHelper._InternalFunctions._up_or_down_arrow__process(objHXEventData);return}};HXWebJS.KeyboardHelper.OnCtrlS=function(){if(HXWebDynamicEditPageJSExt!=null){HXWebDynamicEditPageJSExt.SaveDataProcess()}};HXWebJS.KeyboardHelper._InternalFunctions._ctrl_s__process=function(objHXEventData){objHXEventData.preventDefault();objHXEventData.stopPropagation();var objEventSrcElement=objHXEventData.target;var strTagName=objEventSrcElement.tagName.toLowerCase();if(strTagName=="input"&&objEventSrcElement.type=="text"&&!objEventSrcElement.disabled){objEventSrcElement.blur()}if(HXWebJS.KeyboardHelper.OnCtrlS!=null){HXWebJS.KeyboardHelper.OnCtrlS()}};HXWebJS.KeyboardHelper._InternalFunctions._left_or_right_arrow__process=function(objHXEventData){var objEventSrcElement=objHXEventData.target;var strTagName=objEventSrcElement.tagName.toLowerCase();if(strTagName!="input"&&strTagName!="select"){return}if(objHXEventData.keyCode==HXWebJS.KeyboardHelper._KEYCODE.LEFT_ARROW){if(strTagName=="input"&&(objEventSrcElement.type=="text"||objEventSrcElement.type=="password")){if(HXWebJS.Core.Browser.IsIE){var objRange=objEventSrcElement.createTextRange();if(objRange!=null){var objNewRange=document.selection.createRange();var iResult=objNewRange.compareEndPoints("StartToStart",objRange);if(iResult!=0){return}}}else{if(HXWebJS.Core.Browser.IsSafari||HXWebJS.Core.Browser.IsChrome){if(objEventSrcElement.selectionStart!=0){return}}else{return}}}var objTempInputElment=HXWebJS.DOM.FindPreviousInputElement(objEventSrcElement,true);if(objTempInputElment!=null&&!objTempInputElment.disabled){try{objTempInputElment.focus()}catch(ex){}}return}if(objHXEventData.keyCode==HXWebJS.KeyboardHelper._KEYCODE.RIGHT_ARROW){if(strTagName=="input"&&(objEventSrcElement.type=="text"||objEventSrcElement.type=="password")){if(HXWebJS.Core.Browser.IsIE){var objRange=objEventSrcElement.createTextRange();if(objRange!=null){var objNewRange=document.selection.createRange();var iResult=objNewRange.compareEndPoints("EndToEnd",objRange);if(iResult!=0){return}}}else{if(HXWebJS.Core.Browser.IsSafari||HXWebJS.Core.Browser.IsChrome){if(objEventSrcElement.selectionEnd!=objEventSrcElement.value.length){return}}else{return}}}var objTempInputElment=HXWebJS.DOM.FindNextInputElement(objEventSrcElement,true);if(objTempInputElment!=null&&!objTempInputElment.disabled){try{objTempInputElment.focus()}catch(ex){}}return}};HXWebJS.KeyboardHelper._InternalFunctions._home_or_end_key__process=function(objHXEventData){var objEventSrcElement=objHXEventData.target;var intBindingRecordNumber=HXWebJS.DOM.ElementGetBindingRecordNumber(objEventSrcElement);if(intBindingRecordNumber==null){return}var objContainerTR=objEventSrcElement;while(objContainerTR!=null&&objContainerTR.tagName.toLowerCase()!="tr"){objContainerTR=objContainerTR.parentNode;if(objContainerTR.nodeType!=1){objContainerTR=null}}if(objContainerTR==null){return}objHXEventData.preventDefault();objHXEventData.stopPropagation();var objTempInputElment=HXWebJS.DOM._InternalFunctions._GetSiblingInputElement(objContainerTR,true,(HXWebJS.KeyboardHelper._KEYCODE.HOME?1:-1));if(objTempInputElment==null){return}objTempInputElment.focus()};HXWebJS.KeyboardHelper._InternalFunctions._up_or_down_arrow__process=function(objHXEventData){var objEventSrcElement=objHXEventData.target;var intBindingRecordNumber=HXWebJS.DOM.ElementGetBindingRecordNumber(objEventSrcElement);if(intBindingRecordNumber==null){return}var objContainerTR=objEventSrcElement;while(objContainerTR!=null&&objContainerTR.tagName.toLowerCase()!="tr"){objContainerTR=objContainerTR.parentNode;if(objContainerTR.nodeType!=1){objContainerTR=null}}if(objContainerTR==null){return}if(objHXEventData.keyCode==HXWebJS.KeyboardHelper._KEYCODE.DOWN_ARROW){if(HXWebComboBoxControl!=null&&HXWebComboBoxControl.is_combobox_popuparea_display(objEventSrcElement.id)){objHXEventData.preventDefault();objHXEventData.stopPropagation();HXWebComboBoxControl.set_combobox_popuparea_active_for_keyboard(objEventSrcElement.id);return}}var objContainerTable=objContainerTR.parentNode.parentNode;var intRowsCount=objContainerTable.tBodies.length;if(intRowsCount==0){return}var intCurrentRowNo=intBindingRecordNumber-1;if(objHXEventData.keyCode==HXWebJS.KeyboardHelper._KEYCODE.UP_ARROW&&intCurrentRowNo==0){return}if(objHXEventData.keyCode==HXWebJS.KeyboardHelper._KEYCODE.DOWN_ARROW&&intCurrentRowNo==intRowsCount-1){return}var intNewRowNo=(objHXEventData.keyCode==HXWebJS.KeyboardHelper._KEYCODE.UP_ARROW?intCurrentRowNo-1:intCurrentRowNo+1);var objTempInputElment=HXWebJS.DOM.FindFirstElementById(objEventSrcElement.id,objContainerTable.tBodies[intNewRowNo]);if(objTempInputElment!=null&&!objTempInputElment.disabled){try{objTempInputElment.focus()}catch(ex){}}if(!HXWebJS.KeyboardHelper._InternalFunctions.enable_dataline_highlight){return}HXWebJS.DOM._InternalFunctions._hightlight_data_row(objContainerTable,intCurrentRowNo,intNewRowNo)};HXWebJS.Navigation={};var HXWebNavigation=HXWebJS.Navigation;HXWebJS.Navigation.PostDataToWebPage=function(strTagertWebPageName,strWindowName,strParamName1,strData1){var sb_HtmlFrmQuery=new HXWebStringBuilder();sb_HtmlFrmQuery.append('<Form method="get" name="frmHXPostQuery" id="frmHXPostQuery">');var i,numArgs=arguments.length;if(numArgs<4){alert("调用HXWebJS.Navigation.PostDataToWebPage()时参数数量不足！");return}for(i=2;i<numArgs;i+=2){sb_HtmlFrmQuery.append('<INPUT name="');sb_HtmlFrmQuery.append(HXWebJS.Xml.MarkXMLSpecialChars(arguments[i]));sb_HtmlFrmQuery.append('" Type=hidden value="');sb_HtmlFrmQuery.append(HXWebJS.Xml.MarkXMLSpecialChars(arguments[i+1]));sb_HtmlFrmQuery.append('">')}sb_HtmlFrmQuery.append("</Form>");var frmQuery=document.getElementById("frmHXPostQuery");if(frmQuery==null){frmQuery=HXWebJS.DOM.CreateElement(sb_HtmlFrmQuery.toString())}document.body.appendChild(frmQuery);frmQuery.action=strTagertWebPageName;frmQuery.method="POST";if(strWindowName!=null){frmQuery.target=strWindowName}frmQuery.submit();document.body.removeChild(frmQuery)};HXWebJS.Navigation.OpenWebPage=function(href,strWindowName){if(strWindowName==null){strWindowName=(window.parent==null||window.parent==window?null:"_blank")}if(strWindowName==null){window.location.href=href;return window}else{var objWin=window.open(href,strWindowName,"height="+(screen.availHeight-28*5-6)+",left=0,top=0,width="+(screen.availWidth-12)+",location=yes,menubar=yes,toolbar=yes, status=yes,scrollbars=yes, resizable=yes",true);try{objWin.focus()}catch(ex){}}return objWin};HXWebJS.Navigation.OpenWebPageInFrameWindow=function(href,strFrameHtmlElementId,strShowInWhenFrameNotExist){HXWebJS.Core.SetFrameWindowHref(strFrameHtmlElementId,href,strShowInWhenFrameNotExist)};HXWebJS.Navigation.OpenWebPopupPage=function(href,width,height,Scroll,blnFocusOnWin){if(height==null||isNaN(height)){height=screen.availHeight/2}if(width==null||isNaN(width)){width=screen.availWidth/2}if(Scroll==null){Scroll="yes"}var intTop=((screen.availHeight-28-6)-height)/2;var intLeft=((screen.availWidth-12)-width)/2;var objWin=window.open(href,"_blank","height="+height+",left="+intLeft+",top="+intTop+",width="+width+",location=no,menubar=no,toolbar=no, status=yes,scrollbars="+Scroll+", resizable=yes");if(blnFocusOnWin==null){blnFocusOnWin=true}if(blnblnFocusOnWin){try{objWin.focus()}catch(ex){}}return objWin};HXWebJS.Navigation.OpenFileDownloadOnlyPage=function(strDownloadFileName,blnDownloadFileAsStream,strFileNameToDisplay){if(blnDownloadFileAsStream==null){blnDownloadFileAsStream=true}if(strFileNameToDisplay==null){strFileNameToDisplay=""}if(typeof(mstrHXPageServerEnginee)=="string"&&mstrHXPageServerEnginee=="V6"){var strUrl=HXWebPageGlobalVariables.WebRootPath+"hxpublic_v6/hxinterface6.aspx?_hxcategory=hx_directly_file_download&file_name_to_download="+escape(strDownloadFileName).replace(/\+/,"%2B")+"&file_name_to_display="+escape(strFileNameToDisplay).replace(/\+/,"%2B")+"&download_file_as_stream="+(blnDownloadFileAsStream?"1":"0");HXWebJS.Navigation.OpenWebPage(strUrl);return}var strUrl=gstrWebRootPath+"hxpublic/hx_file_download_only_process.aspx?file_name_to_download="+escape(strDownloadFileName).replace(/\+/,"%2B")+"&file_name_to_display="+escape(strFileNameToDisplay).replace(/\+/,"%2B")+"&download_file_as_stream="+(blnDownloadFileAsStream?"1":"0");HXWebJS.Navigation.OpenWebPage(strUrl)};HXWebJS.Navigation.OpenWebDialog_IE=function(href,Argument,width,height,Scroll,fnCallback){if(!HXWebJS.Core.Browser.IsIE){alert("OpenWebDialog_IE()函数仅在IE10及以下版本的IE浏览器（或者IE11浏览器的兼容性视图模式）下使用！请更改IE的兼容性设置后或者使用IE10及以下浏览器然后再试！");return}if(Scroll==null){Scroll="yes"}if(height==null||isNaN(height)){height=screen.availHeight/2}if(width==null||isNaN(width)){width=screen.availWidth/2}if(parseInt(HXWebJS.Core.Browser.Version)==6){height+=25;width+=6}var objDialogResult=showModalDialog(href,Argument,"dialogWidth:"+width+"px;dialogHeight:"+height+"px;help:no;status:no;edge:raised;resizable=yes;scroll:"+Scroll);if(fnCallback!=null){fnCallback(objDialogResult)}else{return objDialogResult}};HXWebJS.Navigation.OpenWebModelessDialog_IE=function(href,Argument,width,height,Scroll){if(!HXWebJS.Core.Browser.IsIE){alert("OpenWebDialog_IE()函数仅在IE浏览器下使用！请使用IE浏览器然后再试！");return}if(Scroll==null){Scroll="yes"}if(height==null||isNaN(height)){height=screen.availHeight/2}if(width==null||isNaN(width)){width=screen.availWidth/2}if(parseInt(HXWebJS.Core.Browser.Version)==6){height+=25;width+=6}return showModelessDialog(href,Argument,"dialogWidth:"+width+"px;dialogHeight:"+height+"px;help:no;status:no;edge:raised;resizable=yes;scroll:"+Scroll)};HXWebJS.Navigation.IsPopupBlockerOpened=function(){var objWin=window.open("","_blank","width=1,height=1,left=0,top=0,scrollbars=no");if(objWin==null){return true}else{objWin.close();return false}};HXWebJS.Navigation.GoHomePage=function(strHomePageName){if(strHomePageName==null){strHomePageName=""}document.location.href=gstrWebRootPath+strHomePageName};HXWebJS.Navigation.GoLoginPage=function(){document.location.href=gstrWebRootPath+"hxpublic/hxlogin_process.aspx"};HXWebJS.Navigation.GoSystemSettingPage=function(strWindowName){if(strWindowName==null){strWindowName="blank"}var windowSetting={show_style:0,window_name:strWindowName};HXWebJS.AppUtility.OpenDynamicDataCommonPageViaFile("common/system_setting_homepage.hxpage.xhtml",windowSetting)};HXWebJS.Navigation.GetContentZoneWindow=function(){if(top.hxmainpage_get_content_zone_window!=null){return top.hxmainpage_get_content_zone_window()}};HXWebJS.Navigation.ShowPageInContentZone=function(strContentFileName,strMasterMenuItemCode){if(strContentFileName==null){strContentFileName=""}if(strMasterMenuItemCode==null){strMasterMenuItemCode=""}if(top.hxmainpage_navigate_to_page!=null){top.hxmainpage_navigate_to_page(strContentFileName,"content_zone",strMasterMenuItemCode)}else{alert("当前主页未实现hxmainpage_navigate_to_page()接口！如果当前使用的是动态菜单主页，建议将菜单条目显示位置设置为content_zone的方式代替调用该函数。")}};HXWebJS.Navigation.ShowPageInNewMainPageContentZone=function(strContentFileName,strMasterMenuItemCode){if(strContentFileName==null){strContentFileName=""}if(strMasterMenuItemCode==null){strMasterMenuItemCode=""}if(top.hxmainpage_navigate_to_page!=null){top.hxmainpage_navigate_to_page(strContentFileName,"new_homepage",strMasterMenuItemCode)}else{alert("当前主页未实现hxmainpage_navigate_to_page()接口！如果当前使用的是动态菜单主页，建议将菜单条目显示位置设置为content_zone的方式代替调用该函数。")}};HXWebJS.Navigation.OpenWebDialog=function(href,Argument,width,height,Scroll,fnCallback,blnShowCloseButton,blnShowTitleBar){var objTopLevelWin=window.top;if(Scroll==null){Scroll="yes"}if(blnShowCloseButton==null){blnShowCloseButton=true}if(blnShowTitleBar==null){blnShowTitleBar=true}if(objTopLevelWin._hx_web_dialog_divs_stacks==null){objTopLevelWin._hx_web_dialog_divs_stacks=[]}var intExistDialogsCount=objTopLevelWin._hx_web_dialog_divs_stacks.length;var objHXWebDialogData=HXWebJS.Navigation._InternalFunctions._create_new_dialog_element(objTopLevelWin,intExistDialogsCount+1,href,width,height,fnCallback,Scroll,blnShowCloseButton,blnShowTitleBar,Argument);if(intExistDialogsCount==0){HXWebJS.Core._InternalFunctions.DisableDialogMouseInput(true,objTopLevelWin)}else{objTopLevelWin._hx_web_dialog_divs_stacks[intExistDialogsCount-1]._hx_dialog_div_object.style.display="none"}objTopLevelWin._hx_web_dialog_divs_stacks.push(objHXWebDialogData);objHXWebDialogData._hx_dialog_div_object.style.display="";objHXWebDialogData._hx_dialog_div_object.focus()};HXWebJS.Navigation.CloseWebDialog=function(returnValue,objContainerDiv){if(typeof(returnValue)=="undefined"){returnValue=null}var objTopLevelWin=window.top;if(objTopLevelWin._hx_web_dialog_divs_stacks==null||objTopLevelWin._hx_web_dialog_divs_stacks.length==0){window.returnValue=returnValue;window.close();return}try{var objHXWebDialogData=objTopLevelWin._hx_web_dialog_divs_stacks.pop()}catch(ex){HXWebJS.Navigation._InternalFunctions._close_dialog_after_exception(objContainerDiv);return}objHXWebDialogData._hx_dialog_div_object.style.display="none";var intDialogsCount=objTopLevelWin._hx_web_dialog_divs_stacks.length;if(intDialogsCount==0){HXWebJS.Core._InternalFunctions.DisableDialogMouseInput(false,objTopLevelWin);objTopLevelWin._hx_web_dialog_divs_stacks=null}else{objTopLevelWin._hx_web_dialog_divs_stacks[intDialogsCount-1]._hx_dialog_div_object.style.display=""}var fnCallback=objHXWebDialogData._hx_dialog_callback_func;if(fnCallback!=null){var objParentWin=objHXWebDialogData._hx_dialog_opened_from_window;if(objParentWin==null){return}fnCallback.call(objParentWin,returnValue)}if(objHXWebDialogData._hx_dialog_iframe_element!=null){objHXWebDialogData._hx_dialog_div_object.removeChild(objHXWebDialogData._hx_dialog_iframe_element)}objHXWebDialogData._hx_dialog_iframe_element=null;objHXWebDialogData._hx_dialog_div_object.parentNode.removeChild(objHXWebDialogData._hx_dialog_div_object);objHXWebDialogData._hx_dialog_div_object=null;if(HXWebJS!=null&&HXWebJS.Core!=null&&HXWebJS.Core.Browser.IsIE&&parseInt(HXWebJS.Core.Browser.Version)<11){CollectGarbage();var objParentWin=objHXWebDialogData._hx_dialog_opened_from_window;if(objParentWin==null){return}var arrTemp=objParentWin.document.getElementsByTagName("input");for(var i=0;i<arrTemp.length;i++){if(arrTemp[i].disabled==false&&arrTemp[i].style.display==""){arrTemp[i].focus();break}}}};HXWebJS.Navigation.GetWebDialogArgumentsData=function(){var objTopLevelWin=window.top;if(objTopLevelWin._hx_web_dialog_divs_stacks==null){return null}var intDialogsCount=objTopLevelWin._hx_web_dialog_divs_stacks.length;if(intDialogsCount==0){return null}var objHXWebDialogData=objTopLevelWin._hx_web_dialog_divs_stacks[intDialogsCount-1];return objHXWebDialogData._hx_dialog_argument};HXWebJS.Navigation.SetWebDialogTitle=function(strTitle){HXWebJS.Navigation._InternalFunctions._set_dialog_title_onload(strTitle)};HXWebJS.Navigation.IsWebPageOpenedInDialog=function(){if(window.dialogLeft!=null){return true}var objFrameElement=null;try{objFrameElement=window.frameElement}catch(e){}if(objFrameElement){if(objFrameElement.id.indexOf("hxwebjs_iframe_for_web_dialog_window_")!=-1){return true}}else{try{var objTopLevelWin=window.top;if(objTopLevelWin._hx_web_dialog_divs_stacks==null){return false}var intDialogsCount=objTopLevelWin._hx_web_dialog_divs_stacks.length;if(intDialogsCount==0){return false}var objHXWebDialogData=objTopLevelWin._hx_web_dialog_divs_stacks[intDialogsCount-1];var objWin_OpenCurrentDialog=objHXWebDialogData._hx_dialog_opened_from_window;if(window.parent===objWin_OpenCurrentDialog){return true}}catch(ex){return false}}return false};HXWebJS.Navigation.OpenWebPageViaWindowSetting=function(strUrl,objWindowSetting){HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.Navigation.OpenV11DynamicWebPageViaMenuCmdHref=function(strMenuCmdHref,objWindowSetting){var strUrl=HXWebJS.Navigation._InternalFunctions._BuildDynamicPageFullUrl(strMenuCmdHref);if(strUrl==null){return}HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting(strUrl,objWindowSetting)};HXWebJS.Navigation.BuildDynamicPageFullUrl=function(strMenuCmdHref,externalParamData){return HXWebJS.Navigation._InternalFunctions._BuildDynamicPageFullUrl(strMenuCmdHref,externalParamData)};HXWebJS.Navigation.demo_WindowSettingOfWebPageOpenning={show_style:1,window_name:"_blank",dialog_width:800,dialog_heigth:500,dialog_scroll:"no",dialog_callback_func:function(objDialogResult){},dialog_argument:{},dialog_show_close_button:true,dialog_show_title_bar:true};HXWebJS.Navigation._InternalFunctions={};HXWebJS.Navigation._InternalFunctions._BuildDynamicPageFullUrl=function(strMenuCmdHref,externalParamData){var re=new RegExp("(hxdynamic)(\\w)+(:)(\\w)+");if(re.test(strMenuCmdHref)==false){return""}var strDynamicPageType,strDynamicPageVersion,strViaType;var strScreenLayoutFileNameOrCodeWithParameter;if(strMenuCmdHref.indexOf("hxdynamiclistpage_v11")==0){strDynamicPageType="list";strDynamicPageVersion="1.1";if(strMenuCmdHref.indexOf("hxdynamiclistpage_v11_db:")==0){strViaType="via_db";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(25)}else{strViaType="via_file";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(22)}}else{if(strMenuCmdHref.indexOf("hxdynamiceditpage_v11")==0){strDynamicPageType="edit";strDynamicPageVersion="1.1";if(strMenuCmdHref.indexOf("hxdynamiceditpage_v11_db:")==0){strViaType="via_db";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(25)}else{strViaType="via_file";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(22)}}else{if(strMenuCmdHref.indexOf("hxdynamicreportpage_v11")==0){strDynamicPageType="report";strDynamicPageVersion="1.1";if(strMenuCmdHref.indexOf("hxdynamicreportpage_v11_db:")==0){strViaType="via_db";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(27)}else{strViaType="via_file";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(24)}}else{if(strMenuCmdHref.indexOf("hxdynamicpage_common_v12")==0){strDynamicPageType="common";strDynamicPageVersion="1.2";if(strMenuCmdHref.indexOf("hxdynamicpage_common_v12_db:")==0){strViaType="via_db";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(28)}else{strViaType="via_file";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(25)}}else{if(strMenuCmdHref.indexOf("hxdynamicpage_edit_v12")==0){strDynamicPageType="edit";strDynamicPageVersion="1.2";if(strMenuCmdHref.indexOf("hxdynamicpage_edit_v12_db:")==0){strViaType="via_db";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(26)}else{strViaType="via_file";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(23)}}else{if(strMenuCmdHref.indexOf("hxdynamicpage_list_v12")==0){strDynamicPageType="list";strDynamicPageVersion="1.2";if(strMenuCmdHref.indexOf("hxdynamicpage_list_v12_db:")==0){strViaType="via_db";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(26)}else{strViaType="via_file";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(23)}}else{if(strMenuCmdHref.indexOf("hxdynamicpage_report_v12")==0){strDynamicPageType="report";strDynamicPageVersion="1.2";if(strMenuCmdHref.indexOf("hxdynamicpage_report_v12_db:")==0){strViaType="via_db";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(28)}else{strViaType="via_file";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(25)}}else{if(strMenuCmdHref.indexOf("hxdynamicpage_common_v13")==0){strDynamicPageType="common";strDynamicPageVersion="1.3";strViaType="via_file";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(25)}else{if(strMenuCmdHref.indexOf("hxdynamicpage_edit_v13")==0){strDynamicPageType="edit";strDynamicPageVersion="1.3";strViaType="via_file";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(23)}else{if(strMenuCmdHref.indexOf("hxdynamicpage_list_v13")==0){strDynamicPageType="list";strDynamicPageVersion="1.3";strViaType="via_file";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(23)}else{if(strMenuCmdHref.indexOf("hxdynamicpage_statistic_v13")==0){strDynamicPageType="statistic";strDynamicPageVersion="1.3";strViaType="via_file";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(28)}else{if(strMenuCmdHref.indexOf("hxdynamicpage_v20:")==0){strDynamicPageVersion="2.0";strScreenLayoutFileNameOrCodeWithParameter=strMenuCmdHref.substr(18)}else{return""}}}}}}}}}}}}var strScreenLayoutFileNameOrCode,strParameterPartContent;var intIndexOfQuestionMark=strScreenLayoutFileNameOrCodeWithParameter.indexOf("?");if(intIndexOfQuestionMark==-1){strScreenLayoutFileNameOrCode=strScreenLayoutFileNameOrCodeWithParameter;strParameterPartContent=""}else{strScreenLayoutFileNameOrCode=strScreenLayoutFileNameOrCodeWithParameter.substring(0,intIndexOfQuestionMark);strParameterPartContent=strScreenLayoutFileNameOrCodeWithParameter.substr(intIndexOfQuestionMark+1)}var strTemp,intIndexTemp,strName,strValue;var objExtrPageParamValues={};var objSearchFieldDefaultValues=null,objKeyFieldValues=null;if(strParameterPartContent!=""){var arrParamValuePairs=strParameterPartContent.split("&");for(var i=0;i<arrParamValuePairs.length;i++){strTemp=arrParamValuePairs[i];intIndexTemp=strTemp.indexOf("=");if(intIndexTemp>0){strName=strTemp.substring(0,intIndexTemp);strValue=strTemp.substr(intIndexTemp+1);strValue=unescape(strValue);if(strName=="hx_search_field_default_values"){objSearchFieldDefaultValues=HXWebJS.Utility.ConvertStringToJSON(strValue);continue}else{if(strName=="hx_key_field_values"){objKeyFieldValues=HXWebJS.Utility.ConvertStringToJSON(strValue);continue}}objExtrPageParamValues[strName]=strValue}}}if(strDynamicPageVersion=="1.3"||strDynamicPageVersion=="2.0"){var arrParamKeyValues=["_hxpage",strScreenLayoutFileNameOrCode];if(objExtrPageParamValues!=null){for(var name in objExtrPageParamValues){arrParamKeyValues.push(name);arrParamKeyValues.push(objExtrPageParamValues[name])}}if(externalParamData!=null){for(var name in externalParamData){arrParamKeyValues.push(name);arrParamKeyValues.push(externalParamData[name])}}var strPageParamUUID=HXWebJS.Xml.XmlService.RegisterParameterValueToServerViaArray(arrParamKeyValues);if(strPageParamUUID==null||strPageParamUUID==""){return}return gstrWebRootPath+"hxpublic_v6/hxdynamicpage6.aspx?hx_page_param_uuid="+strPageParamUUID}if(strDynamicPageType=="report"){var strUrl=HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataReportPageUrl(strViaType,strScreenLayoutFileNameOrCode,objSearchFieldDefaultValues,objExtrPageParamValues,strDynamicPageVersion);return strUrl}if(strDynamicPageType=="list"){var strUrl=HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataListPageUrl(strViaType,strScreenLayoutFileNameOrCode,strDynamicPageVersion,objSearchFieldDefaultValues,objExtrPageParamValues);return strUrl}if(strDynamicPageType=="edit"){var strUrl=HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataEditPageUrl(strViaType,strScreenLayoutFileNameOrCode,strDynamicPageVersion,"",objKeyFieldValues,objExtrPageParamValues);return strUrl}if(strDynamicPageType=="common"){var strUrl=HXWebJS.AppUtility._InternalFunctions._BuildDynamicDataCommonPageUrl(strViaType,strScreenLayoutFileNameOrCode,strDynamicPageVersion,objExtrPageParamValues);return strUrl}return""};HXWebJS.Navigation._InternalFunctions._create_new_dialog_element=function(objTopLevelWin,intDialogDeepLevel,href,width,height,fnCallback,Scroll,blnShowCloseButton,blnShowTitleBar,Argument){var intViewportWidth=HXWebJS.Core.WindowGeometry.GetViewportWidth(objTopLevelWin);var intViewportHeight=HXWebJS.Core.WindowGeometry.GetViewportHeight(objTopLevelWin);if(width==null||isNaN(width)){width=intViewportWidth/2}if(height==null||isNaN(height)){height=intViewportHeight/2}var intLeft=HXWebJS.Core.WindowGeometry.GetScrollLeft(objTopLevelWin)+(intViewportWidth-width)/2;var intTop=HXWebJS.Core.WindowGeometry.GetScrollTop(objTopLevelWin)+(intViewportHeight-height)/2;if(intLeft<0){intLeft=20}if(intTop<0){intTop=20}var str_div_container_name="hxwebjs_div_for_web_dialog_container";var objDivForWebDialog=objTopLevelWin.document.createElement("div");objDivForWebDialog.id=str_div_container_name;objDivForWebDialog.style.position="absolute";objDivForWebDialog.style.zIndex=100000+intDialogDeepLevel;objDivForWebDialog.style.border="1px solid #BBBBBB";objDivForWebDialog.style.backgroundColor="white";var blnIsIE7=(HXWebJS.Core.Browser.IsIE&&HXWebJS.Core.Browser.Version=="7.0"&&objTopLevelWin.document.documentMode>5);objDivForWebDialog.style.top=intTop+"px";objDivForWebDialog.style.left=intLeft+"px";objDivForWebDialog.style.width=(width+2)+"px";objDivForWebDialog.style.height=(height+2)+"px";objTopLevelWin.document.body.appendChild(objDivForWebDialog);var sb_html=new HXWebStringBuilder();sb_html.append("<span id='hxwebjs_span_for_web_dialog_title' style='position:absolute;left:0px;top:0px;width:100px;height:24px;line-height:24px;font-weight:bold;color:black;border-bottom:1px solid #BBBBBB;padding-left:18px;cursor:default;' draggable=false unselectable=on></span>");sb_html.append('<img id="hxwebjs_img_for_web_dialog_decoration" src="../hximages_v6/hxpub_clear.gif" draggable=false unselectable=on');sb_html.append(' class="hxicon_star hxwebjs_web_dialog_decoration_icon"');sb_html.append(' style="position:absolute;top:5px;left:4px;;z-index:'+(100000+intDialogDeepLevel+25)+(blnShowTitleBar?"":";display:none")+'"');sb_html.append(" />");sb_html.append("<img id='hxwebjs_img_for_web_dialog_close_button' src='../images/hxpub_clear.gif' draggable=false unselectable=on class='hxbtn_delete hxicon_delete' style='position:absolute;right:4px;top:6px;' onclick='HXWebJS.Navigation.CloseWebDialog(null,this.parentNode)' />");objDivForWebDialog.innerHTML=sb_html.toString();var objImgForCloseButton=HXWebJS.DOM.FindElementsById("hxwebjs_img_for_web_dialog_close_button",objDivForWebDialog)[0];objImgForCloseButton.style.zIndex=100000+intDialogDeepLevel+20;objImgForCloseButton.style.display=(blnShowCloseButton&&blnShowTitleBar?"":"none");var objSpanForDialogTitle=HXWebJS.DOM.FindElementsById("hxwebjs_span_for_web_dialog_title",objDivForWebDialog)[0];objSpanForDialogTitle.style.zIndex=100000+intDialogDeepLevel+10;objSpanForDialogTitle.style.width=(width-(blnIsIE7?18:0))+"px";objSpanForDialogTitle.style.height="24px";objSpanForDialogTitle.style.display=(blnShowTitleBar?"":"none");var objIframeForDialogWindow=objTopLevelWin.document.createElement("iframe");objIframeForDialogWindow.id="hxwebjs_iframe_for_web_dialog_window_"+intDialogDeepLevel;objIframeForDialogWindow.style.position="absolute";objIframeForDialogWindow.frameBorder=0;objIframeForDialogWindow.border=0;objIframeForDialogWindow.style.left="0px";objIframeForDialogWindow.style.top=(blnShowTitleBar?24:0)+"px";objIframeForDialogWindow.style.width=width+"px";objIframeForDialogWindow.style.height=(height-(blnShowTitleBar?24:0)).toString()+"px";objIframeForDialogWindow.style.zIndex=100000+intDialogDeepLevel+1;objIframeForDialogWindow.scrolling=(Scroll=="yes"||Scroll=="1"?"yes":"no");objIframeForDialogWindow.style.backgroundColor="white";objIframeForDialogWindow.src=href;objDivForWebDialog.appendChild(objIframeForDialogWindow);HXWebJS.EventManager.AddListener(objDivForWebDialog,"mousedown",HXWebJS.Navigation._InternalFunctions._dialog_ondragstart_process);HXWebJS.EventManager.AddListener(objDivForWebDialog,"mousemove",HXWebJS.Navigation._InternalFunctions._dialog_ondrag_process);HXWebJS.EventManager.AddListener(objDivForWebDialog,"mouseup",HXWebJS.Navigation._InternalFunctions._dialog_ondragend_process);var objHXWebDialogData=new Object();objHXWebDialogData._hx_dialog_div_object=objDivForWebDialog;objHXWebDialogData._hx_dialog_iframe_element=objIframeForDialogWindow;objHXWebDialogData._hx_dialog_opened_from_window=window;objHXWebDialogData._hx_dialog_deep_level=intDialogDeepLevel;objHXWebDialogData._hx_dialog_argument=Argument;objHXWebDialogData._hx_dialog_callback_func=fnCallback;return objHXWebDialogData};HXWebJS.Navigation._InternalFunctions._close_dialog_directly=function(objContainerDiv){HXWebJS.Navigation.CloseWebDialog(null,objContainerDiv)};HXWebJS.Navigation._InternalFunctions._close_dialog_after_exception=function(objContainerDiv){if(objContainerDiv==null){if(window.frameElement!=null){objContainerDiv=window.frameElement.parentNode}}if(objContainerDiv!=null){if(objContainerDiv.parentNode!=null){objContainerDiv.parentNode.removeChild(objContainerDiv)}else{objContainerDiv.style.display="none"}return}};HXWebJS.Navigation._InternalFunctions._set_dialog_title_onload=function(strTitle,objTopLevelWin){if(objTopLevelWin==null){objTopLevelWin=window.top}if(objTopLevelWin._hx_web_dialog_divs_stacks==null){return}var intDialogsCount=objTopLevelWin._hx_web_dialog_divs_stacks.length;if(intDialogsCount==0){return}var objHXWebDialogData=null;objHXWebDialogData=objTopLevelWin._hx_web_dialog_divs_stacks[intDialogsCount-1];var objSpanForDialogTitle=HXWebJS.DOM.FindFirstElementById("hxwebjs_span_for_web_dialog_title",objHXWebDialogData._hx_dialog_div_object);if(objSpanForDialogTitle==null){return}HXWebJS.DOM.ElementSetInnerText(objSpanForDialogTitle,(strTitle!=null&&strTitle!=""?strTitle:window.document.title))};HXWebJS.Navigation._InternalFunctions._dialog_ondragstart_process=function(eventObject){var objHXEventData=HXWebJS.EventManager.GetCurrentEventData(eventObject);if(objHXEventData.target.id!="hxwebjs_span_for_web_dialog_title"){return}var objContainerDiv=objHXEventData.target.parentNode;HXWebJS.DOM.ElementAttributeSetValue(objContainerDiv,"_hx_dialog_drag_begin_mouse_x",objHXEventData.screenX);HXWebJS.DOM.ElementAttributeSetValue(objContainerDiv,"_hx_dialog_drag_begin_mouse_y",objHXEventData.screenY)};HXWebJS.Navigation._InternalFunctions._dialog_ondrag_process=function(eventObject){var objHXEventData=HXWebJS.EventManager.GetCurrentEventData(eventObject);if(objHXEventData.button!=1&&objHXEventData.buttons!=1){return}if(objHXEventData.target.id!="hxwebjs_span_for_web_dialog_title"){return}var objContainerDiv=objHXEventData.target.parentNode;var beginX=HXWebJS.DOM.ElementAttributeGetValue(objContainerDiv,"_hx_dialog_drag_begin_mouse_x");var beginY=HXWebJS.DOM.ElementAttributeGetValue(objContainerDiv,"_hx_dialog_drag_begin_mouse_y");if(beginX==null||beginY==null){return}var offsetX=objHXEventData.screenX-parseInt(beginX);var offsetY=objHXEventData.screenY-parseInt(beginY);objContainerDiv.style.left=(objContainerDiv.offsetLeft+offsetX)+"px";objContainerDiv.style.top=(objContainerDiv.offsetTop+offsetY)+"px";HXWebJS.DOM.ElementAttributeSetValue(objContainerDiv,"_hx_dialog_drag_begin_mouse_x",objHXEventData.screenX);HXWebJS.DOM.ElementAttributeSetValue(objContainerDiv,"_hx_dialog_drag_begin_mouse_y",objHXEventData.screenY)};HXWebJS.Navigation._InternalFunctions._dialog_ondragend_process=function(eventObject){var objHXEventData=HXWebJS.EventManager.GetCurrentEventData(eventObject);if(objHXEventData.target.id!="hxwebjs_span_for_web_dialog_title"){return}var objContainerDiv=objHXEventData.target.parentNode;objContainerDiv.removeAttribute("_hx_dialog_drag_begin_mouse_x");objContainerDiv.removeAttribute("_hx_dialog_drag_begin_mouse_y")};HXWebJS.Navigation._InternalFunctions._open_web_page_via_setting=function(strUrl,objWindowSetting){var intShowStyle=0;var strWindowName="_blank";var intDialogWidth=null,intDialogHeight=null;var strDialogScroll=null;var fnDialogCallback=null;var blnShowCloseButton=null,blnShowTitleBar=null;var objDialogArguments=null;if(objWindowSetting!=null){intShowStyle=objWindowSetting.show_style;if(intShowStyle==null||(intShowStyle!=1&&intShowStyle!=2&&intShowStyle!=3&&intShowStyle!=10)){intShowStyle=0}strWindowName=objWindowSetting.window_name;intDialogWidth=objWindowSetting.dialog_width;intDialogHeight=objWindowSetting.dialog_height;strDialogScroll=objWindowSetting.dialog_scroll;fnDialogCallback=objWindowSetting.dialog_callback_func;blnShowCloseButton=objWindowSetting.dialog_show_close_button;blnShowTitleBar=objWindowSetting.dialog_show_title_bar;objDialogArguments=objWindowSetting.dialog_argument}if(intShowStyle==0){HXWebJS.Navigation.OpenWebPage(strUrl,strWindowName);return}if(intShowStyle==1){HXWebJS.Navigation.OpenWebDialog(strUrl,objDialogArguments,intDialogWidth,intDialogHeight,strDialogScroll,fnDialogCallback,blnShowCloseButton,blnShowTitleBar);return}if(intShowStyle==2){var strFrameWinId=strWindowName;HXWebJS.Navigation.OpenWebPageInFrameWindow(strUrl,strFrameWinId,"_blank");return}if(intShowStyle==3){var objResult=HXWebJS.Navigation.OpenWebDialog_IE(strUrl,objDialogArguments,intDialogWidth,intDialogHeight,strDialogScroll);if(fnDialogCallback!=null){fnDialogCallback(objResult)}return}if(intShowStyle==10){if(top.hxmainpage_navigate_to_page!=null){top.hxmainpage_navigate_to_page(strUrl,"content_zone",objWindowSetting.web_page_menu_cmd_code,objWindowSetting.web_page_tag_name)}else{var strFrameWinId=strWindowName;HXWebJS.Navigation.OpenWebPageInFrameWindow(strUrl,strFrameWinId,"_blank")}return}};var HXWebMessageBox={};HXWebMessageBox.Show=function(strTitle,strContent,options){if(options==null){options={}}var objMessageBoxContainerDiv=document.getElementById("hxwebmessageboxcontrol__container");if(objMessageBoxContainerDiv==null){var sb_html=new HXWebStringBuilder();sb_html.append('<div id="hxwebmessageboxcontrol__container" style="position:absolute;display:none;z-index:100100">');sb_html.append('<div id="hxwebmessageboxcontrol__title"></div>');sb_html.append('<textarea id="hxwebmessageboxcontrol__textarea" wrap="hard"></textarea>');sb_html.append('<button id="hxwebmessageboxcontrol__ok_btn" class="hxbtn default" onclick="HXWebMessageBox._hide_messagebox(true)"><span class="fa fa-check" style="color:blue;padding-right:3px;margin-left:-6px;"></span><span datasrc="#hxxml_ui_text" datafld="lbl_btn_scrn__hx_ok"></span></button>');sb_html.append('<button id="hxwebmessageboxcontrol__cancel_btn" class="hxbtn default" onclick="HXWebMessageBox._hide_messagebox()"><span class="fa fa-close" style="color: red;padding-right:3px;margin-left:-6px;"></span><span datasrc="#hxxml_ui_text" datafld="lbl_btn_scrn__hx_cancel"></span></button>');sb_html.append('<button id="hxwebmessageboxcontrol__closebtn" class="hxbtn default" onclick="HXWebMessageBox._hide_messagebox()"><span class="fa fa-close" style="color: red;padding-right:3px;margin-left:-6px;"></span><span datasrc="#hxxml_ui_text" datafld="lbl_btn_scrn__hx_closewin"></span></button>');sb_html.append("</div>");objMessageBoxContainerDiv=HXWebJS.DOM.CreateElement(sb_html.toString());document.body.appendChild(objMessageBoxContainerDiv);var blnIsIE=HXWebJS.Core.Browser.IsIE&&parseFloat(HXWebJS.Core.Browser.Version)<10;if(!blnIsIE){HXWebJS.Xml._XmlDataIsland._onload_binding_process_for_normal_element(objMessageBoxContainerDiv)}}HXWebJS.DOM.ElementSetInnerText(document.getElementById("hxwebmessageboxcontrol__title"),strTitle);document.getElementById("hxwebmessageboxcontrol__textarea").value=strContent;var strLeft,strTop,strWidth,strHeight;var intWindowWidth=HXWebJS.Core.WindowGeometry.GetViewportWidth();var intWindowHeight=HXWebJS.Core.WindowGeometry.GetViewportHeight();var intWidth=(options.width!=null?options.width:intWindowWidth/2);var intHeight=(options.height!=null?options.height:intWindowHeight/2);var intLeft=(intWindowWidth-intWidth)/2+HXWebJS.Core.WindowGeometry.GetScrollLeft();var intTop=(intWindowHeight-intHeight)/2+HXWebJS.Core.WindowGeometry.GetScrollTop();objMessageBoxContainerDiv.style.left=intLeft+"px";objMessageBoxContainerDiv.style.top=intTop+"px";objMessageBoxContainerDiv.style.width=intWidth+"px";objMessageBoxContainerDiv.style.height=intHeight+"px";document.getElementById("hxwebmessageboxcontrol__textarea").style.display=(options.show_textarea==false?"none":"");document.getElementById("hxwebmessageboxcontrol__textarea").style.borderWidth=(options.hide_textarea_border?"0px":"1px");document.getElementById("hxwebmessageboxcontrol__ok_btn").style.display=(options.show_okcancel_button==true?"":"none");document.getElementById("hxwebmessageboxcontrol__cancel_btn").style.display=(options.show_okcancel_button==true?"":"none");document.getElementById("hxwebmessageboxcontrol__closebtn").style.display=(options.show_okcancel_button==true?"none":"");HXWebMessageBox._callback_after_ok_button_clicked=options.callback_after_ok_button_clicked;HXWebJS.Core._InternalFunctions.DisableDialogMouseInput(true);objMessageBoxContainerDiv.style.display=""};HXWebMessageBox._hide_messagebox=function(blnRunCallbackAfterOKButtonClicked){HXWebJS.Core._InternalFunctions.DisableDialogMouseInput(false);var objMessageBoxContainerDiv=document.getElementById("hxwebmessageboxcontrol__container");objMessageBoxContainerDiv.style.display="none";if(blnRunCallbackAfterOKButtonClicked&&HXWebMessageBox._callback_after_ok_button_clicked!=null){var strContent=document.getElementById("hxwebmessageboxcontrol__textarea").value;HXWebMessageBox._callback_after_ok_button_clicked(strContent)}};if(typeof JSON!=="object"){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var cx,escapable,gap,indent,meta,rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());