HXWebLayoutDesigner={},HXWebLayoutDesigner.OnSubContainerDataGet=null,HXWebLayoutDesigner.OnSubContainerBeforeCreated=null,HXWebLayoutDesigner.OnSubContainerAfterCreated=null,HXWebLayoutDesigner.OnContainerBeforeInsert=null,HXWebLayoutDesigner.OnContainerAfterInsert=null,HXWebLayoutDesigner.OnContainerAfterRemoved=null,HXWebLayoutDesigner.OnContainerPositionAfterMoved=null,HXWebLayoutDesigner.OnContainerSizeChanged=null,HXWebLayoutDesigner.OnContainerSizeModeChanged=null,HXWebLayoutDesigner.OnWidgetBlockHtmlContentDrawing=null,HXWebLayoutDesigner.OnWidgetBeforeCreated=null,HXWebLayoutDesigner.OnWidgetAfterCreated=null,HXWebLayoutDesigner.OnWidgetPositionAfterMoved=null,HXWebLayoutDesigner.OnWidgetSizeChanged=null,HXWebLayoutDesigner.OnWidgetSizeModeChanged=null,HXWebLayoutDesigner.OnWidgetAfterRemoved=null,HXWebLayoutDesigner.OnWidgetConfigButtonClicked=null,HXWebLayoutDesigner._Container={},HXWebLayoutDesigner._WidgetBlock={},HXWebLayoutDesigner._Utility={},HXWebLayoutDesigner._WidgetToolboxItem={},HXWebLayoutDesigner._GlobalData={},HXWebLayoutDesigner._GlobalData._RootContainerElement=null,HXWebLayoutDesigner._GlobalData._RootLayoutDirection="horizontal",HXWebLayoutDesigner._GlobalData._RootLayoutFlexMode="flex",HXWebLayoutDesigner.Init=function(e,t,n){if(null!=e){null==n&&(n={}),HXWebJS.DOM.CSSClass.HasClass(e,"hxweblayoutdesigner_canvas")||HXWebJS.DOM.CSSClass.AddClass(e,"hxweblayoutdesigner_canvas"),HXWebLayoutDesigner._GlobalData._RootContainerElement=e,HXWebLayoutDesigner._options_check(n),HXWebLayoutDesigner._GlobalData._RootLayoutDirection=n.root_layout_direction,HXWebLayoutDesigner._GlobalData._RootLayoutFlexMode=n.root_layout_flex_mode,HXWebLayoutDesigner._GlobalData._LastUsedSectionMaxId=n.last_used_section_max_id,HXWebLayoutDesigner._GlobalData._LastUsedWidgetMaxId=n.last_used_widget_max_id;var o=HXWebLayoutDesigner._GlobalData._RootLayoutDirection+"_"+HXWebLayoutDesigner._GlobalData._RootLayoutFlexMode;HXWebJS.DOM.CSSClass.HasClass(e,o)||HXWebJS.DOM.CSSClass.AddClass(e,o);for(var a=0;a<t.length;a++)HXWebLayoutDesigner._Container._Init(HXWebLayoutDesigner._GlobalData._RootContainerElement,t[a],HXWebLayoutDesigner._GlobalData._RootLayoutDirection,!1);0!=n.show_container_add_button&&HXWebLayoutDesigner._CreateAndShowContainerAddButton(e)}},HXWebLayoutDesigner._options_check=function(e){null==e.root_layout_direction&&(e.root_layout_direction="horizontal"),null==e.root_layout_flex_mode&&(e.root_layout_flex_mode="flex"),null==e.last_used_section_max_id&&(e.last_used_section_max_id=0),null==e.last_used_widget_max_id&&(e.last_used_widget_max_id=0),e.root_layout_direction=HXWebJS.Core.Trim(e.root_layout_direction.toLowerCase()),"vertical"!=e.root_layout_direction&&(e.root_layout_direction="horizontal"),e.root_layout_flex_mode=HXWebJS.Core.Trim(e.root_layout_flex_mode.toLowerCase()),"inline_flex"!=e.root_layout_flex_mode&&(e.root_layout_flex_mode="flex"),(isNaN(e.last_used_section_max_id)||e.last_used_section_max_id<0)&&(e.last_used_section_max_id=0),(isNaN(e.last_used_widget_max_id)||e.last_used_widget_max_id<0)&&(e.last_used_widget_max_id=0)},HXWebLayoutDesigner._OnHXControlClickHandlerProcess=function(e,t){"add_container_btn_clicked"==e?HXWebLayoutDesigner._Container._ManualAddNewContainerProcess():"remove_container_btn_clicked"==e?HXWebLayoutDesigner._Container._RemoveContainerProcess(t.target.parentNode.parentNode):"container_change_size_mode_btn_clicked"==e?HXWebLayoutDesigner._Container._ChangeContainerSizeMode(t.target.parentNode.parentNode):"remove_block_btn_clicked"==e?HXWebLayoutDesigner._WidgetBlock._RemoveBlockProcess(t.target.parentNode.parentNode):"block_change_size_mode_btn_clicked"==e?HXWebLayoutDesigner._WidgetBlock._ChangeBlockSizeMode(t.target.parentNode.parentNode):"config_block_btn_clicked"==e&&HXWebLayoutDesigner._WidgetBlock._ConfigBlockContent(t.target.parentNode.parentNode)},HXWebLayoutDesigner._CreateAndShowContainerAddButton=function(e){var t=HXWebJS.DOM.CreateElement('<div class="hxweblayoutdesigner__container_add_btn_area"><span class="fa fa-plus hxweblayoutdesigner__container_add_btn" hxpage_click_handler="hxcontrol.HXWebLayoutDesigner.add_container_btn_clicked"></span></div>');e.appendChild(t)},HXWebLayoutDesigner._Utility._ParseWidthOrHeight=function(e){if("number"==typeof e)return{mode:"fixed",size:e};var t={mode:"auto",size:-1};if(HXWebJS.Core.IsStringNullOrEmpty(e))return t;if(0==e.indexOf("flex")){if(t.mode="flex",":"==e.substr(4,1)&&e.length>5){n=e.substr(5);!isNaN(n)&&parseInt(n)>0&&(t.size=parseFloat(n))}}else if(0==e.indexOf("auto")){if(t.mode="auto",":"==e.substr(4,1)&&e.length>5){var n=e.substr(5);!isNaN(n)&&parseInt(n)>0&&(t.size=parseFloat(n))}}else!isNaN(e)&&parseInt(e)>0&&(t.mode="fixed",t.size=parseFloat(e));return t},HXWebLayoutDesigner._GetContainerMoveTargetIndicatorElement=function(){var e=HXWebLayoutDesigner._GlobalData._RootContainerElement,t=$(".hxweblayoutdesigner_container__move_target_indicator_line",e);if(t.length>0)return t[0];var n=HXWebJS.DOM.CreateElement('<div class="hxweblayoutdesigner_container__move_target_indicator_line" style="display:none;"></div>');return e.appendChild(n),n},HXWebLayoutDesigner.WidgetToolboxItemsDraggableSetting=function(e){var t={opacity:.8,helper:HXWebLayoutDesigner._WidgetToolboxItem._OnDragHelperGet,start:HXWebLayoutDesigner._WidgetToolboxItem._OnDragStart,drag:HXWebLayoutDesigner._WidgetToolboxItem._OnDragging,stop:HXWebLayoutDesigner._WidgetToolboxItem._OnDragStopped};$(".hxwidget_tool_item",e).draggable(t)},HXWebLayoutDesigner._WidgetToolboxItem._OnDragHelperGet=function(e){var t=$(e.currentTarget).clone();return t.css({display:"",position:"absolute","z-index":1e4,visibility:"visible",left:HXWebJS.DOM.GetElementLeftPosition(e.currentTarget),top:HXWebJS.DOM.GetElementTopPosition(e.currentTarget)}),document.body.appendChild(t[0]),t},HXWebLayoutDesigner._WidgetToolboxItem._OnDragStart=function(e){if(e.target.disabled||$(e.target).hasClass("disabled"))return!1},HXWebLayoutDesigner._WidgetToolboxItem._OnDragging=function(e,t){HXWebLayoutDesigner._WidgetBlock._WidgetBlockDraggingOverProcess(t.helper)},HXWebLayoutDesigner._WidgetToolboxItem._OnDragStopped=function(e,t){var n=HXWebLayoutDesigner._WidgetBlock._GetBlockMoveTargetIndicatorElement();if(""==n.style.display){var o=t.helper.attr("hx_widget_type"),a=HXWebLayoutDesigner._WidgetToolboxItem._GetNewWidgetCode(),i={widget_type_code:o,page_widget_code:a,block_width_or_height:"flex",is_create_new:!0};if(null!=HXWebLayoutDesigner.OnWidgetBeforeCreated)try{HXWebLayoutDesigner.OnWidgetBeforeCreated(i)}catch(e){return void console.log("HXWebLayoutDesigner.OnWidgetBeforeCreated() call fail. "+e)}var r=$(n).prev(".hxweblayoutdesigner_block"),l=0==r.length?"":r.attr("hx_widget_code"),s=$(n.parentNode).hasClass("vertical")?"vertical":"horizontal",_=i.block_width_or_height,d=HXWebLayoutDesigner._WidgetBlock._Init(i,s,_);if($(d).insertBefore(n),null!=HXWebLayoutDesigner.OnWidgetAfterCreated){var g=$(d).parent().parent(),u=HXWebLayoutDesigner._Container._GetUpdatedContainerInfo(g),c="";"sub_section_area"==o&&(c=$(d).children(".hxweblayoutdesigner_container.sub_section").attr("hx_container_code"));try{HXWebLayoutDesigner.OnWidgetAfterCreated(o,a,l,c,u)}catch(e){console.log("HXWebLayoutDesigner.OnWidgetAfterCreated() call fail. "+e)}}}n.style.display="none"},HXWebLayoutDesigner._WidgetToolboxItem._GetNewWidgetCode=function(){return HXWebLayoutDesigner._GlobalData._LastUsedWidgetMaxId++,"hxweblayoutdesigner_widget__"+HXWebLayoutDesigner._GlobalData._LastUsedWidgetMaxId},HXWebLayoutDesigner._Container._Init=function(e,t,n,o,a){o||"vertical"!=n||"auto"!=t.size_mode||(t.size_mode="flex");var i=HXWebLayoutDesigner._Container._CreateContainerElement(t,n,o,a);if(e.insertBefore(i,$(".hxweblayoutdesigner__container_add_btn_area",e)[0]),HXWebLayoutDesigner._Container._DraggableSetting(i),$(i).hasClass("fixed")&&HXWebLayoutDesigner._Container._ResizableSetting(i),null!=t.block_count&&0!=t.block_count){null==t.block_width_or_height_list&&(t.block_width_or_height_list=""),t.block_width_or_height_list=t.block_width_or_height_list.replace(/;+$/,"");var r=t.block_width_or_height_list.split(";");if(r.length==t.block_count)if(null==t.widget_blocks&&(t.widget_blocks=[]),t.widget_blocks.length==t.block_count)for(var l=0;l<t.block_count;l++){var s=HXWebLayoutDesigner._WidgetBlock._Init(t.widget_blocks[l],n,r[l]);$(".hxweblayoutdesigner_container_content_box",i)[0].appendChild(s)}else HXWebJS.Core.LogErrorToConsole("容器("+t.container_code+")中的内容块数量("+t.block_count+")和组件块信息清单数量("+t.widget_blocks.length+")不匹配！");else HXWebJS.Core.LogErrorToConsole("容器("+t.container_code+")中的内容块数量("+t.block_count+")和宽度信息("+t.block_width_or_height_list+")不匹配！")}},HXWebLayoutDesigner._Container._CreateContainerElement=function(e,t,n,o){var a=new HXWebStringBuilder,i="hxweblayoutdesigner_container "+t;i+=n?" sub_section":" main_section";var r="";if(!n){var l=HXWebLayoutDesigner._Utility._ParseWidthOrHeight("vertical"==t?e.container_width:e.container_height);i+=" "+l.mode,e.size_mode=l.mode,-1!=l.size?"fixed"==l.mode?r+=("vertical"==t?"width:":"height:")+l.size+"px;":r+=("vertical"==t?"min-width:":"min-height:")+l.size+"px;":r+="vertical"==t?"min-width:100px;":"min-height:80px;","fixed"==l.mode}var s="hxweblayoutdesigner_container__"+e.container_code;return a.append('<div id="'+s+'" class="'+i+'"'),a.append(' hx_container_code="'+e.container_code+'"'),a.append(' style="'+r+'"'),null!=e.grid_size&&a.append(' hx_container_grid_size="'+e.grid_size+'"'),a.append(">"),a.append('<div class="hxweblayoutdesigner_container_control_box '+t+'">'),a.append(HXWebLayoutDesigner._Container._CreateContainerToolboxButtons(e,t,n,o)),a.append("</div>"),a.append('<div class="hxweblayoutdesigner_container_content_box '+t+'"></div>'),a.append('<div class="hxweblayoutdesigner_container_resize_bar '+t+'"></div>'),a.append("</div>"),HXWebJS.DOM.CreateElement(a.toString())},HXWebLayoutDesigner._Container._CreateContainerToolboxButtons=function(e,t,n,o){var a=new HXWebStringBuilder;return a.append('<span class="hxweblayoutdesigner_container__indicator_btn fa fa-bars"'),0==e.allow_moved&&a.append(' style="display:none;"'),a.append("></span>"),a.append('<span class="hxweblayoutdesigner_container__size_mode_btn fa '+("vertical"==t?"fa-arrows-h":"fa-arrows-v")+'"'),0==e.allow_size_mode_changed&&a.append(' style="display:none;"'),a.append(' hxpage_click_handler="hxcontrol.HXWebLayoutDesigner.container_change_size_mode_btn_clicked">'),n?a.append("fixed"==o?"f":"auto"==o?"a":"s"):a.append("fixed"==e.size_mode?"f":"auto"==e.size_mode?"a":"s"),a.append("</span>"),a.append('<span class="hxweblayoutdesigner_container__remove_btn fa fa-close"'),0==e.allow_deleted&&a.append(' style="display:none;"'),a.append(' hxpage_click_handler="hxcontrol.HXWebLayoutDesigner.remove_container_btn_clicked"></span>'),a.toString()},HXWebLayoutDesigner._Container._GetUpdatedContainerInfo=function(e){var t=e.attr("hx_container_code"),n=0,o="";e.children(".hxweblayoutdesigner_container_content_box").children(".hxweblayoutdesigner_block").each(function(e,t){n++;var a,i,r=$(t),l=r.hasClass("horizontal");r.hasClass("flex")?(i=parseInt(r.css(l?"min-width":"min-height")),a="flex"+(isNaN(i)?"":":"+i.toString())):r.hasClass("fixed")?a=(i=l?t.offsetWidth:t.offsetHeight).toString():(i=parseInt(r.css(l?"min-width":"min-height")),a="auto"+(isNaN(i)?"":":"+i.toString())),o+=(""!=o?";":"")+a});var a={};return a.container_code=t,a.blocks_count=n,a.blocks_size_list=o,a},HXWebLayoutDesigner._Container._ManualAddNewContainerProcess=function(){var e=HXWebLayoutDesigner._GlobalData._RootContainerElement,t=HXWebLayoutDesigner._GlobalData._RootLayoutDirection;HXWebLayoutDesigner._GlobalData._LastUsedSectionMaxId++;var n="hxweblayoutdesigner_container__"+HXWebLayoutDesigner._GlobalData._LastUsedSectionMaxId,o={container_code:n,block_count:0,allow_moved:!0,allow_deleted:!0};null!=HXWebLayoutDesigner.OnContainerBeforeInsert&&HXWebLayoutDesigner.OnContainerBeforeInsert(n,t,o),HXWebLayoutDesigner._Container._Init(e,o,t,!1),null!=HXWebLayoutDesigner.OnContainerAfterInsert&&HXWebLayoutDesigner.OnContainerAfterInsert(n,t,o)},HXWebLayoutDesigner._Container._RemoveContainerProcess=function(e){var t=e.getAttribute("hx_container_code"),n=e.parentNode;HXWebJS.DOM.CSSClass.HasClass(n,"sub_section_area")?HXWebLayoutDesigner._WidgetBlock._RemoveBlockProcess(n):(n.removeChild(e),null!=HXWebLayoutDesigner.OnContainerAfterRemoved&&HXWebLayoutDesigner.OnContainerAfterRemoved(t))},HXWebLayoutDesigner._Container._ChangeContainerSizeMode=function(e){var t=$(e);if(t.hasClass("sub_section"))HXWebLayoutDesigner._WidgetBlock._ChangeBlockSizeMode(e.parentNode);else{var n,o,a=t.hasClass("horizontal"),i=t.find(".hxweblayoutdesigner_container__size_mode_btn");if(t.hasClass("fixed")?(n="fixed",a?(o="auto",t.removeClass("fixed").addClass("auto"),i.text("a")):(o="flex",t.removeClass("fixed").addClass("flex"),i.text("s"))):t.hasClass("auto")?(n="auto",o="flex",t.removeClass("auto").addClass("flex"),i.text("s")):(n="flex",o="fixed",t.removeClass("flex").addClass("fixed"),i.text("f")),t.hasClass("fixed")?HXWebLayoutDesigner._Container._ResizableSetting(e):t.hasClass("ui-resizable")&&t.resizable("destroy"),$(e).find(".hxweblayoutdesigner_block").each(function(e,t){$(t).hasClass("fixed")?HXWebLayoutDesigner._WidgetBlock._ResizableSetting(t):$(t).hasClass("ui-resizable")&&$(t).resizable("destroy")}),null!=HXWebLayoutDesigner.OnContainerSizeModeChanged){var r=t.attr("hx_container_code");HXWebLayoutDesigner.OnContainerSizeModeChanged(r,n,o)}}},HXWebLayoutDesigner._Container._DraggableSetting=function(e){var t={opacity:.8,helper:HXWebLayoutDesigner._Container._OnDragHelperGet,start:HXWebLayoutDesigner._Container._OnDragStart,drag:HXWebLayoutDesigner._Container._OnDragging,stop:HXWebLayoutDesigner._Container._OnDragStopped};$(".hxweblayoutdesigner_container_control_box:has(.hxweblayoutdesigner_container__indicator_btn:visible)",e).draggable(t)},HXWebLayoutDesigner._Container._OnDragHelperGet=function(e){var t;t=$(e.target).hasClass("hxweblayoutdesigner_container_control_box")?e.target.parentNode:e.target.parentNode.parentNode;var n=$(t).clone().css("visibility","visible");return n.css("width",t.offsetWidth+"px"),n.css("height",t.offsetHeight+"px"),n.hasClass("main_section")&&(t.style.visibility="hidden"),n},HXWebLayoutDesigner._Container._OnDragStart=function(e,t){return"none"!=$(".hxweblayoutdesigner_container__indicator_btn",t.helper).css("display")&&(!t.helper.hasClass("sub_section")&&(!($(".hxweblayoutdesigner_container",HXWebLayoutDesigner._GlobalData._RootContainerElement).length<2)&&void 0))},HXWebLayoutDesigner._Container._OnDragging=function(e,t){for(var n,o,a=$(HXWebLayoutDesigner._GlobalData._RootContainerElement),i=(t.helper.attr("hx_container_code"),a.children(".hxweblayoutdesigner_container")),r=t.helper.hasClass("horizontal"),l=null,s=null,_=t.helper.offset().top,d=(t.helper.height(),t.helper.offset().left),g=(t.helper.width(),0);g<i.length;g++)if(n=i[g],r){if(o=HXWebJS.DOM.GetElementTopPosition(n),tempMoveOverContainerHeight=n.offsetHeight,_<=o){l=n;break}}else if(tempMoveOverContainerLeftPosition=HXWebJS.DOM.GetElementLeftPosition(n),n.offsetWidth,d<=tempMoveOverContainerLeftPosition){l=n;break}if(null==l&&null==s){s=a.children(".hxweblayoutdesigner_container").last()[0]}var u=HXWebLayoutDesigner._GetContainerMoveTargetIndicatorElement();u.style.display="none",null!=l?$(u).insertBefore(l).css("display",""):null!=s&&$(u).insertAfter(s).css("display","")},HXWebLayoutDesigner._Container._OnDragStopped=function(e,t){var n=HXWebLayoutDesigner._GetContainerMoveTargetIndicatorElement(),o=""==n.style.display;n.style.display="none";var a=t.helper.attr("hx_container_code"),i=$(".hxweblayoutdesigner_container[hx_container_code='"+a+"']",HXWebLayoutDesigner._GlobalData._RootContainerElement);if(o){var r=$(n).prev(".hxweblayoutdesigner_container").attr("hx_container_code");if(i.insertBefore(n),null!=HXWebLayoutDesigner.OnContainerPositionAfterMoved)try{HXWebLayoutDesigner.OnContainerPositionAfterMoved(a,r)}catch(e){console.log("HXWebLayoutDesigner.OnContainerPositionAfterMoved() call fail. "+e)}}i.css("visibility","inherit")},HXWebLayoutDesigner._Container._ResizableSetting=function(e){var t=$(e),n=t.hasClass("horizontal"),o=t.attr("hx_container_grid_size");null==o&&(o=1);var a={handles:n?"s":"e",grid:[n?1:o,n?o:1],stop:HXWebLayoutDesigner._Container._OnResizeStopped};t.resizable(a)},HXWebLayoutDesigner._Container._OnResizeStopped=function(e,t){if(null!=HXWebLayoutDesigner.OnContainerSizeChanged){var n=t.originalElement.attr("hx_container_code");HXWebLayoutDesigner.OnContainerSizeChanged(n,t.originalSize,t.size)}},HXWebLayoutDesigner._WidgetBlock._Init=function(e,t,n){var o=HXWebLayoutDesigner._WidgetBlock._CreateBlockElement(e,t,n),a="vertical"==t?"horizontal":"vertical";if("sub_section_area"==e.widget_type_code){if(e.is_create_new){HXWebLayoutDesigner._GlobalData._LastUsedSectionMaxId++;i={container_code:"hxweblayoutdesigner_sub_container__"+HXWebLayoutDesigner._GlobalData._LastUsedSectionMaxId,block_count:0,allow_moved:!0,allow_deleted:!0,block_width_or_height_list:""},null!=HXWebLayoutDesigner.OnSubContainerBeforeCreated&&HXWebLayoutDesigner.OnSubContainerBeforeCreated(e.page_widget_code,i,a)}else if(null!=HXWebLayoutDesigner.OnSubContainerDataGet)var i=HXWebLayoutDesigner.OnSubContainerDataGet(e.page_widget_code,a);else console.log("HXWebLayoutDesigner.OnSubContainerDataGet()函数未被实现，无法获取子容器信息，操作被取消。");if(null==i)return;HXWebLayoutDesigner._Container._Init(o,i,a,!0,e.size_mode),e.is_create_new&&null!=HXWebLayoutDesigner.OnSubContainerAfterCreated&&HXWebLayoutDesigner.OnSubContainerAfterCreated(e.page_widget_code,i,a)}else null==HXWebLayoutDesigner.OnWidgetBlockHtmlContentDrawing?console.log("HXWebLayoutDesigner.OnWidgetBlockHtmlContentDrawing()接口未定义！"):HXWebLayoutDesigner.OnWidgetBlockHtmlContentDrawing(o,e);return HXWebLayoutDesigner._WidgetBlock._DraggableSetting(o),$(o).hasClass("fixed")&&HXWebLayoutDesigner._WidgetBlock._ResizableSetting(o),o},HXWebLayoutDesigner._WidgetBlock._CreateBlockElement=function(e,t,n){var o=e.widget_type_code,a=e.page_widget_code,i="hxweblayoutdesigner_block "+o+" "+t,r="",l=HXWebLayoutDesigner._Utility._ParseWidthOrHeight(n);e.size_mode=l.mode,"horizontal"==t&&"auto"==l.mode&&(l.mode="flex"),i+=" "+l.mode,-1!=l.size&&("fixed"==l.mode?r+=("vertical"==t?"height:":"width:")+l.size+"px;":r+=("vertical"==t?"min-height:":"min-width:")+l.size+"px;");var s=new HXWebStringBuilder;return s.append('<div class="'+i+'" style="'+r+'"'),s.append(' hx_widget_type="'+o+'" hx_widget_code="'+a+'">'),"sub_section_area"!=e.widget_type_code&&(s.append('<div class="hxweblayoutdesigner_block__control_box">'),s.append('<span class="hxweblayoutdesigner_block__indicator_btn fa fa-bars"'),0==e.allow_moved&&s.append(' style="display:none;"'),s.append("></span>"),s.append('<span class="hxweblayoutdesigner_block__config_btn fa fa-gear"'),0==e.allow_config&&s.append(' style="display:none;"'),s.append(' hxpage_click_handler="hxcontrol.HXWebLayoutDesigner.config_block_btn_clicked"></span>'),s.append('<span class="hxweblayoutdesigner_block__size_mode_btn fa '+("vertical"==t?"fa-arrows-v":"fa-arrows-h")+'"'),0==e.allow_size_mode_changed&&s.append(' style="display:none;"'),s.append(' hxpage_click_handler="hxcontrol.HXWebLayoutDesigner.block_change_size_mode_btn_clicked">'),s.append("fixed"==l.mode?"f":"auto"==l.mode?"a":"s"),s.append("</span>"),s.append('<span class="hxweblayoutdesigner_block__remove_btn fa fa-close"'),0==e.allow_deleted&&s.append(' style="display:none;"'),s.append(' hxpage_click_handler="hxcontrol.HXWebLayoutDesigner.remove_block_btn_clicked"></span>'),s.append("</div>")),s.append('<div class="hxweblayoutdesigner_block_resize_bar '+t+'"></div>'),s.append("</div>"),HXWebJS.DOM.CreateElement(s.toString())},HXWebLayoutDesigner._WidgetBlock._RemoveBlockProcess=function(e){var t=e.getAttribute("hx_widget_type"),n=e.getAttribute("hx_widget_code"),o=e.parentNode.parentNode;o.getAttribute("hx_container_code");if(e.parentNode.removeChild(e),null!=HXWebLayoutDesigner.OnWidgetAfterRemoved){var a=HXWebLayoutDesigner._Container._GetUpdatedContainerInfo($(o));try{HXWebLayoutDesigner.OnWidgetAfterRemoved(t,n,a)}catch(e){console.log("HXWebLayoutDesigner.OnWidgetAfterRemoved() call fail. "+e)}}},HXWebLayoutDesigner._WidgetBlock._ChangeBlockSizeMode=function(e){var t,n=$(e),o=n.hasClass("sub_section_area"),a=n.hasClass("horizontal");t=o?n.find(".hxweblayoutdesigner_container__size_mode_btn"):n.find(".hxweblayoutdesigner_block__size_mode_btn");var i,r;if(n.hasClass("fixed")?(i="fixed",a?(r="flex",n.removeClass("fixed").addClass("flex"),t.text("s")):(r="auto",n.removeClass("fixed").addClass("auto"),t.text("a"))):n.hasClass("auto")?(i="auto",r="flex",n.removeClass("auto").addClass("flex"),t.text("s")):(i="flex",r="fixed",a?n.css("width",n[0].offsetWidth):n.css("height",n[0].offsetHeight),n.removeClass("flex").addClass("fixed"),t.text("f")),n.hasClass("fixed")?HXWebLayoutDesigner._WidgetBlock._ResizableSetting(e):n.hasClass("ui-resizable")&&n.resizable("destroy"),null!=HXWebLayoutDesigner.OnWidgetSizeModeChanged){var l=n.attr("hx_widget_type"),s=n.attr("hx_widget_code"),_=n.parent().parent(),d=HXWebLayoutDesigner._Container._GetUpdatedContainerInfo(_);HXWebLayoutDesigner.OnWidgetSizeModeChanged(l,s,i,r,d)}},HXWebLayoutDesigner._WidgetBlock._ConfigBlockContent=function(e){var t=e.getAttribute("hx_widget_type"),n=e.getAttribute("hx_widget_code");if(null!=HXWebLayoutDesigner.OnWidgetConfigButtonClicked)try{HXWebLayoutDesigner.OnWidgetConfigButtonClicked(t,n)}catch(e){console.log("HXWebLayoutDesigner.OnWidgetConfigButtonClicked() call fail. "+e)}},HXWebLayoutDesigner._WidgetBlock._DraggableSetting=function(e){var t={opacity:.8,helper:HXWebLayoutDesigner._WidgetBlock._OnDragHelperGet,start:HXWebLayoutDesigner._WidgetBlock._OnDragStart,drag:HXWebLayoutDesigner._WidgetBlock._OnDragging,stop:HXWebLayoutDesigner._WidgetBlock._OnDragStopped};$(".hxweblayoutdesigner_block__control_box, .hxweblayoutdesigner_container_control_box",e).draggable(t)},HXWebLayoutDesigner._WidgetBlock._OnDragHelperGet=function(e){var t,n=!1;$(e.currentTarget).hasClass("hxweblayoutdesigner_container_control_box")?(t=e.currentTarget.parentNode.parentNode,n=!0):t=e.currentTarget.parentNode;var o=$(t).clone();return o.css({display:"",position:"absolute","z-index":1e4,visibility:"visible",width:t.offsetWidth+"px",height:t.offsetHeight+"px",left:HXWebJS.DOM.GetElementLeftPosition(t),top:HXWebJS.DOM.GetElementTopPosition(t)}),n&&o.children().css("width","100%").css("height","100%"),o.addClass("cloned_dragging_block"),t.style.visibility="hidden",o},HXWebLayoutDesigner._WidgetBlock._OnDragStart=function(e,t){if("none"==$(".hxweblayoutdesigner_block__indicator_btn",t.helper).css("display"))return!1},HXWebLayoutDesigner._WidgetBlock._OnDragging=function(e,t){HXWebLayoutDesigner._WidgetBlock._WidgetBlockDraggingOverProcess(t.helper)},HXWebLayoutDesigner._WidgetBlock._OnDragStopped=function(e,t){var n;n=$(e.target).hasClass("hxweblayoutdesigner_container_control_box")?e.target.parentNode.parentNode:e.target.parentNode;var o=HXWebLayoutDesigner._WidgetBlock._GetBlockMoveTargetIndicatorElement();if(""==o.style.display){var a=$(n.parentNode.parentNode),i=$(o).prev(".hxweblayoutdesigner_block"),r=0==i.length?$(o).parent().parent():i.parent().parent(),l=$(n).attr("hx_widget_code"),s=i.attr("hx_widget_code");if($(n).insertBefore(o),null!=HXWebLayoutDesigner.OnWidgetPositionAfterMoved){var _,d=HXWebLayoutDesigner._Container._GetUpdatedContainerInfo(a);_=a.attr("hx_container_code")==r.attr("hx_container_code")?d:HXWebLayoutDesigner._Container._GetUpdatedContainerInfo(r);try{HXWebLayoutDesigner.OnWidgetPositionAfterMoved(l,s,d,_)}catch(e){console.log("HXWebLayoutDesigner.OnWidgetPositionAfterMoved() call fail. "+e)}}}n.style.visibility="inherit",o.style.display="none"},HXWebLayoutDesigner._WidgetBlock._WidgetBlockDraggingOverProcess=function(e){var t={x:e.offset().left,y:e.offset().top},n=HXWebLayoutDesigner._WidgetBlock._FindSuitableHoveringBlock(e,t);if(null!=n){a=HXWebLayoutDesigner._WidgetBlock._GetBlockMoveTargetIndicatorElement();return HXWebLayoutDesigner._WidgetBlock._CheckIsPointInFirstHalfOfBlock(n,t)?$(a).insertBefore(n):$(a).insertAfter(n),void(a.style.display="")}var o=HXWebLayoutDesigner._WidgetBlock._FindSuitableHoveringContainer(e,t),a=HXWebLayoutDesigner._WidgetBlock._GetBlockMoveTargetIndicatorElement();if(null!=o){var i=HXWebLayoutDesigner._WidgetBlock._FindSuitableInsertBeforeBlockInContainer(o,t);null!=i?$(a).insertBefore(i):$(".hxweblayoutdesigner_container_content_box",o)[0].appendChild(a),a.style.display=""}else a.style.display="none"},HXWebLayoutDesigner._WidgetBlock._FindSuitableHoveringBlock=function(e,t){for(var n,o=$(".hxweblayoutdesigner_block:not(.cloned_dragging_block)",HXWebLayoutDesigner._GlobalData._RootContainerElement),a=e.hasClass("sub_section_area")||"sub_section_area"==e.attr("hx_widget_type"),i=null,r=0;r<o.length;r++)if(n=o[r],HXWebJS.DOM.IsPointInElementArea(n,t)){if(a){if($(n).hasClass("sub_section_area"))break;if($(n).parents(".hxweblayoutdesigner_block.sub_section_area").length>0)break;i=n}else i=n;break}if(null!=i&&HXWebJS.DOM.CSSClass.HasClass(i,"sub_section_area")){o=$(i).find(".hxweblayoutdesigner_block");for(r=0;r<o.length;r++)if(n=o[r],HXWebJS.DOM.IsPointInElementArea(n,t))return n;return null}return i},HXWebLayoutDesigner._WidgetBlock._FindSuitableHoveringContainer=function(e,t){var n,o=e.hasClass("sub_section_area")||"sub_section_area"==e.attr("hx_widget_type");n=o?$(".hxweblayoutdesigner_container:not(sub_section)",HXWebLayoutDesigner._GlobalData._RootContainerElement):$(".hxweblayoutdesigner_container",HXWebLayoutDesigner._GlobalData._RootContainerElement),o&&(n=n.not(e.find(".hxweblayoutdesigner_container")));for(var a,i=null,r=0;r<n.length;r++)if(a=n[r],HXWebJS.DOM.IsPointInElementArea(a,t)){i=a;break}if(null!=i&&HXWebJS.DOM.CSSClass.HasClass(i,"main_section")&&!o){n=$(".hxweblayoutdesigner_container.sub_section",i);for(r=0;r<n.length;r++)if(a=n[r],HXWebJS.DOM.IsPointInElementArea(a,t))return a}return i},HXWebLayoutDesigner._WidgetBlock._FindSuitableInsertBeforeBlockInContainer=function(e,t){var n=$(e).find(".hxweblayoutdesigner_block");if(0==n.length)return null;for(var o,a=$(e).hasClass("horizontal"),i=0;i<n.length;i++)if(o=n[i],a){if(t.x<=$(o).offset().left)return o}else if(t.y<=$(o).offset().top)return o;return null},HXWebLayoutDesigner._WidgetBlock._CheckIsPointInFirstHalfOfBlock=function(e,t){var n=$(e);return n.parent().hasClass("horizontal")?t.x<n.offset().left+n[0].offsetWidth/2:t.y<n.offset().top+n[0].offsetHeight/2},HXWebLayoutDesigner._WidgetBlock._GetBlockMoveTargetIndicatorElement=function(){var e=$(".hxweblayoutdesigner_block__move_target_indicator_line",HXWebLayoutDesigner._GlobalData._RootContainerElement);if(e.length>0)return e[0];var t=HXWebJS.DOM.CreateElement('<div class="hxweblayoutdesigner_block__move_target_indicator_line" style="display:none;"></div>');return HXWebLayoutDesigner._GlobalData._RootContainerElement.appendChild(t),t},HXWebLayoutDesigner._WidgetBlock._ResizableSetting=function(e){var t=$(e),n=t.hasClass("horizontal"),o=t.attr("hx_block_grid_size");null==o&&(o=1);var a={handles:n?"e":"s",grid:[n?o:1,n?1:o],stop:HXWebLayoutDesigner._WidgetBlock._OnResizeStopped};t.resizable(a)},HXWebLayoutDesigner._WidgetBlock._OnResizeStopped=function(e,t){if(null!=HXWebLayoutDesigner.OnWidgetSizeChanged){var n=t.originalElement.attr("hx_widget_type"),o=t.originalElement.attr("hx_widget_code"),a=t.originalElement.parent().parent(),i=HXWebLayoutDesigner._Container._GetUpdatedContainerInfo(a);HXWebLayoutDesigner.OnWidgetSizeChanged(n,o,t.originalSize,t.size,i)}};